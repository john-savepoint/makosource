---
title: "FF7 LGP Archive Format"
module: "Format Spec"
created: "2025-11-29 00:00 JST"
modified: "2025-12-02 01:35 JST"
session_id: "80d5df18-dd85-42fe-afb2-e87bc69e0d7e"
author: "Generated by Claude Code Documentation Standardization Agent"
status: "Complete"

# LLM-specific metadata (CRITICAL for routing)
llm_summary: "Specifies the LGP archive format used by FF7 PC for bundling game assets, including header structure, TOC entries, CRC validation, and data section layout. LLMs should read this when parsing or creating LGP archives, debugging file loading issues, or implementing mod tools that manipulate FF7 data files."
llm_tags: ["lgp-archive", "pc-format", "file-structure", "archive-format", "modding-tools"]
llm_primary_topics: ["LGP file header", "Table of Contents structure", "CRC validation", "File data section", "Archive manipulation"]
llm_related_docs: ["FF7_Kernel_Low_level_libraries.md", "FF7_Field_Module.md", "FF7_LZSS_format.md"]

# Backlinks (leave empty - populated in pass 2)
referenced_by: ["FF7_Field_Module.md", "FF7_Kernel_Low_level_libraries.md", "FF7_LZSS_format.md", "FF7_Technical_Customising.md"]
---

<!--
STANDARDIZATION METADATA
Original: FF7_LGP_format.md
Source: merged_with_pdf_content/FF7_LGP_format.md
Standardized: 2025-12-02 01:35 JST
Session-ID: 80d5df18-dd85-42fe-afb2-e87bc69e0d7e
Agent: FF7 Documentation Cleanup Agent v2.0

Previous Merge Metadata:
MERGE METADATA
Created: 2025-11-29
Original: FF7_LGP_format.md (102 lines)
Major section: 05_FIELD_MODULE.md
Merge decision: NO EXTRACTION PERFORMED
Reason: Major section contains only brief LGP references, no format specifications
Analysis: comparisons/FF7_LGP_format_vs_05_FIELD_MODULE_analysis.md
Status: COMPLETE - Original file copied as source of truth

Standardization Changes Applied:
- Added YAML frontmatter with LLM routing metadata
- Fixed heading hierarchy: H3→H4 corrected to H2→H3 (inserted H2 "LGP Archive Specification")
- Converted 2 wiki-style links (User:Ficedula) to plain text author attribution
- Removed wiki-style TOC with anchor attributes at document start
- Preserved HTML table in Section 1 (complex styling requires HTML)
- Added language tag to implicit code examples (none present - document is prose)
- Standardized external URLs (preserved as-is, all valid)

Cleanup v2 Changes Applied:
- Converted HTML table to GitHub-flavored markdown
- Added GitHub alerts for important notes and warnings
- Improved table alignment and formatting
- Updated session ID and timestamps

LLM CONTEXT BLOCK (Read this first for routing decisions):
This document provides the complete specification for FF7's LGP (Large Game Package) archive format
used on PC. LGP files bundle multiple game assets (textures, models, scripts) into single archives.
Key technical details include: 12-byte right-aligned creator header, 27-byte TOC entries per file,
3602-byte CRC section, and per-file headers with length fields. Essential for modding tools that
need to extract, modify, or create LGP archives. Cross-reference with LZSS format for compressed
content within LGP files, and Field Module for field-specific LGP usage (flevel.lgp).
-->

# FF7 LGP Archive Format

## LGP Archive Specification

### LGP Archive Format for PC (by Ficedula)

This section explains how the LGP archives from FF7 PC are constructed. If you're looking for a tool that already manages LGP archives, try Ficedula's [LGP Editor](http://sylphds.net/f2k3/index.html).

Essentially the LGP file is split up into four sections:

1. File header/Table of contents
2. CRC code
3. Actual data
4. File terminator

### Section 1: File Header

This contains two parts: A header of fixed size, then the table of contents.

The first item is 12 bytes containing the file creator. This is a standard string, except it is "right-aligned". In other words the blank space comes before the actual text, not after. In FF7 it's always "SQUARESOFT" preceded by two nulls to make it 12 bytes. The only other thing you might see is the header "FICEDULA-LGP", which indicates a file is an LGP *patch* constructed by Ficedula's programs, not a complete archive.

Next is a four-byte integer saying how many files the archive contains.

Following this is the table of contents (TOC): One entry per file.

Each entry in the TOC has the following structure:

| Size | Description |
|:-----|:------------|
| 20 bytes | Null-terminated string giving filename |
| 4 bytes (integer) | Position in file where data starts for this file |
| 1 byte | Check code (possibly file attributes). Normally 14 but varies. |
| 2 bytes (short) | Duplicate filename handling. 0 if unique, otherwise assigned based on existing duplicates. |

> [!NOTE]
> Total TOC entry size: **27 bytes** per file.

### Section 2: CRC Code

This code is used to validate the LGP archive. The CRC is based on the number of files in the archive (and possibly filenames). It only validates the TOC.

> [!IMPORTANT]
> If you're replicating an archive from FF7 with the same number of files and filenames, you can copy the CRC section from an existing file.

The CRC section is normally **3602 bytes** long (one archive may differ, possibly MAGIC.LGP).

A safe way to calculate CRC size: find the end of the TOC and the beginning of the first file. Anything in between is CRC code.

> [!WARNING]
> This method works with official archives but editors like [LGP Editor](http://www.ficedula.com/) can alter the TOC structure, breaking this assumption.

### Section 3: Actual Data

The data from the files. However, the TOC doesn't list file lengths—that's stored here.

The offset in the TOC points to a file header with this format:

| Size | Description |
|:----:|:------------|
| 20 bytes | Null-terminated string giving filename |
| 4 bytes | File length |
| *varies* | The file data itself |

### Section 4: Terminator

After the last piece of data comes the file descriptor. This is a string terminated by end-of-file (not null-terminated).

| Archive Type | Terminator String |
|:-------------|:------------------|
| Standard archives | `FINAL FANTASY 7` |
| LGP patches | `LGP PATCH FILE` |

## Archive Flexibility Notes

The game is remarkably flexible about LGP archives. So long as the TOC and CRC data is intact, it accepts almost anything:

- **Example 1:** The filename in the TOC and in the actual file header don't have to match. Only the TOC is checked.
- **Example 2:** You can point two entries in the TOC at the same data and it works.
- **Example 3:** You can have ANY junk in the data section as long as all TOC entries point to valid file headers. Not every piece of data needs to be referenced by the TOC.

[LGP Editor](http://www.ficedula.com/) uses this to its advantage in the Advanced Editor. To replace a file:

1. Puts the new file at the end of the LGP
2. Writes a new file terminator
3. Updates the TOC to point at the new file

It also allows linking two TOC entries to the same data or having "inactive" files not referenced by any TOC entry.

> [!NOTE]
> The game doesn't check archive sizes as long as all expected filenames are present. You could replace a 95-file archive with a 98-file archive, provided 95 of those names match the original. However, the game won't use the extra 3 files.

> [!WARNING]
> There are reports on [Qhimm's board](http://forums.qhimm.com/) that once you've altered an archive and the game refuses to read it, it won't read it until you reinstall—even if you restore from backup. This behavior is not confirmed but has been observed.

### Data Gaps

Sometimes there are data "gaps" in the file not referenced by any TOC entry. If you're stepping through file headers manually (bypassing the TOC), this can cause problems.

When the LGP Editor updates a file with a smaller replacement, it leaves a gap after the file. To help tools navigate, it writes a 4-byte integer after the file end indicating how much space to skip to reach the next file header.

> [!NOTE]
> This gap-skip value only affects tools that bypass the TOC to construct their own file lists. FF7 itself never notices.

## Useful Downloads

Programs capable of editing LGP archives:

| Tool | Description |
|:-----|:------------|
| [LGP Tools](http://www.sylphds.net/f2k3/programs/lgptools/lgptools160.zip) | Advanced LGP Editor allowing thorough archive editing |
| [Emerald](http://elentor.com/Projetos/FF7-Tools/Extracting/Emerald.zip) | Mass extracting/repacking function |
| [Unmass](http://mirex.mypage.sk/index.php?selected=1#Unmass) | General file extractor with LGP archive support |
