---
title: "FF7 Battle Field Format"
module: "Battle"
created: "2025-11-28 00:00 JST"
modified: "2025-12-02 01:25 JST"
session_id: "991595f1-2dff-47d7-8cf8-f8507cdcc8fb"
author: "Generated by Claude Code Documentation Standardization Agent"
status: "Complete"

# LLM-specific metadata (CRITICAL for routing)
llm_summary: "Specifies the PSX battle field 3D model format including LZS archive structure, mesh types, vertex/triangle/quad data layouts, and TIM texture integration. LLMs should read this when implementing battle background rendering, analyzing STAGE1/STAGE2 archive contents, or debugging 3D mesh loading issues."
llm_tags: ["psx", "battle-field", "3d-mesh", "lzs-archive", "tim-texture", "vertex-data"]
llm_primary_topics: ["Battle field mesh types", "LZS archive structure", "Vertex and polygon data formats", "TIM texture palettes"]
llm_related_docs: ["FF7_Battle_Battle_Scenes.md", "FF7_Battle_Battle_Mechanics.md", "FF7_Playstation_Battle_Model_Format.md", "FF7_LZSS_format.md", "PSX_TIM_format.md"]

# Backlinks (leave empty - populated in pass 2)
referenced_by: []
---

<!--
STANDARDIZATION METADATA
Original: FF7_Battle_Battle_Field.md
Source: merged_with_pdf_content/FF7_Battle_Battle_Field.md
Standardized: 2025-12-02 01:25 JST
Session-ID: 991595f1-2dff-47d7-8cf8-f8507cdcc8fb
Agent: FF7 Documentation Cleanup Agent v2.0

Previous Merge Metadata:
MERGE METADATA
Created: 2025-11-28
Original File: FF7_Battle_Battle_Field.md (40 lines)
Major Section Source: 06_BATTLE_MODULE.md (lines 1458-1502)
Extracted Content: PSX 3D Battle Scenes by Micky (45 lines)
Images Adjusted: 0
Analysis Report: comparisons/FF7_Battle_Battle_Field_vs_06_BATTLE_MODULE_analysis.md

Standardization Changes Applied (v1.0):
- Added YAML frontmatter with LLM routing metadata
- Fixed heading hierarchy: H1→H3 corrected to H1→H2→H3; H2→H4 corrected to H2→H3
- Removed wiki-style anchor syntax from headings (e.g., {#anchor_name})
- Removed redundant Table of Contents section (document is short)
- Added language tag to code block (changed from unmarked to "text")
- Converted HTML table to Markdown table format
- Standardized heading format: removed bold from H3/H4

Cleanup Changes Applied (v2.0):
- Added GitHub alert for rendering compatibility note
- Enhanced code block with structured comments
- Minor formatting improvements

LLM CONTEXT BLOCK (Read this first for routing decisions):
This document describes the 3D battle field/background format used in FF7's PSX version.
Battle fields are stored as LZS-compressed archives in STAGE1/STAGE2 directories, containing
mesh data (vertices, triangles, quads) and TIM-format textures. Key technical details include
the 6 mesh types (static, scrolling, rotating, lifestream), memory constraints (0x8d04 max
unpacked size), and the multi-section archive structure. Related to battle scene rendering
and PSX model formats.
-->

# FF7 Battle Field Format

Battle fields are simple 3D models drawn in 3D space.

They are stored in directories STAGE1 and STAGE2. There are LZS archives that are unpacked and loaded in PSX space `0x801590e4`. Size of unpacked field must be less than `0x8d04`. It consists of a few concatenated files. The first one is settings for the field. The last one is texture. All others are meshes.

## Settings Format

### First File Structure

| Offset | Size    | Value |
|:------:|:-------:|:------|
| 0      | 1 byte  | Type of 3D mesh. There are 6 types of meshes: 0 - mesh with horizontal scrolling parts (field 47 - Corel Train Battle). 1 - normal static mesh. 2 - mesh with vertical scrolling parts (field 12 - Shinra Elevators). 3 - mesh with lifestream (field 4e - Final Battle - Sephiroth). 4 - mesh with rotating parts (field 39 - Safer Battle). 5 - normal static mesh, same as 1 (field 01,44,45 - Bizarro Battles). |
| 1      | 7 bytes | Unknown |

## PSX 3D Battle Scenes Architecture

### PSX 3D Battle Scenes by Micky

Backgrounds are stored in probably the easiest model format used in FF7. I reconstructed this from the code for my background-to-Maya converter, so there could be errors. I haven't seen any other documentation on this, so please excuse any duplication...

The backgrounds are stored in LZS files in the STAGE1 and STAGE2 directories. They are using the FF7-standard LZS compression.

They begin with a directory: The first word is the number of sections, then there is one pointer for each section. Each section contains a mesh for the background, except for the first that contains some unknown data and the last that contains the TIM-format texture and palettes.

Each section starts with vertex data, followed by triangle and quad data.

### Vertex Data Format

```c
// Vertex data structure
// 1 u32    size of vertex data
// 8 bytes per vertex:
//   3 u16  x, y, z
//   1 u16  pad(?)

// Triangle data structure
// 1 u16    number of triangles
// 1 u16    texture page (among other flags)
// 16 bytes per triangle:
//   3 u16  offset into vertex table
//   1 u16  unknown
//   2 u8   u1, v1
//   1 u16  palette (and some other flags)
//   2 u8   u2, v2
//   2 u8   u3, v3
```

### Quad Data Format

- 1 u16 number of quads
- 1 u16 texture page (among other flags)

**20 bytes per quad:**

- 4 u16 offset into vertex table
- 2 u8 u1, v1
- 1 u16 palette
- 2 u8 u2, v2
- 2 u8 u3, v3
- 2 u8 u4, v4
- 1 u16 unknown

### Rendering Notes

> [!NOTE]
> **Modern GPU Compatibility**
> Displaying the backgrounds is a bit tricky on modern graphics boards, as they don't support palettized textures anymore. Which is understandable given the large number of fetches that would be required for displaying a properly filtered texture - but not very helpful. I solved that by a pre-process that stores the palette on each pixel and then looks up the color during export.

## Related Documentation

- [Battle Scenes](FF7_Battle_Battle_Scenes.md) - Scene configuration and enemy data
- [Battle Mechanics](FF7_Battle_Battle_Mechanics.md) - Combat system mechanics
- [PlayStation Battle Model Format](FF7_Playstation_Battle_Model_Format.md) - Character/enemy models
- [LZSS Format](FF7_LZSS_format.md) - LZS compression details
- [PSX TIM Format](PSX_TIM_format.md) - Texture format specification
