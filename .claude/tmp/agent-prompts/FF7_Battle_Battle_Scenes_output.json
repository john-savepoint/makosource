[{"type":"system","subtype":"hook_response","session_id":"5a116cbc-6614-4e79-9389-b85994640c4f","uuid":"cef8ccc4-aba8-4ba7-82b9-7d7520719440","hook_name":"SessionStart:Callback","hook_event":"SessionStart","stdout":"","stderr":""},{"type":"system","subtype":"hook_response","session_id":"5a116cbc-6614-4e79-9389-b85994640c4f","uuid":"a8a0911f-edab-442c-bb23-d6213bdd2d50","hook_name":"SessionStart:startup","hook_event":"SessionStart","stdout":"","stderr":"","exit_code":0},{"type":"system","subtype":"hook_response","session_id":"5a116cbc-6614-4e79-9389-b85994640c4f","uuid":"54f90d49-3c2e-4c95-b711-f70da75e8a21","hook_name":"SessionStart:Callback","hook_event":"SessionStart","stdout":"","stderr":""},{"type":"system","subtype":"hook_response","session_id":"5a116cbc-6614-4e79-9389-b85994640c4f","uuid":"acf144fd-3f80-4612-8115-24af7751f431","hook_name":"SessionStart:startup","hook_event":"SessionStart","stdout":"inject-session-id.sh > injected session ID: 5a116cbc-6614-4e79-9389-b85994640c4f [source: startup]\n{\n  \"hookSpecificOutput\": {\n    \"hookEventName\": \"SessionStart\",\n    \"additionalContext\": \"**Session ID**: `5a116cbc-6614-4e79-9389-b85994640c4f`\\n\\nSession data stored at: `.claude/data/sessions/5a116cbc-6614-4e79-9389-b85994640c4f.json`\\n\"\n  }\n}\n","stderr":"","exit_code":0},{"type":"system","subtype":"hook_response","session_id":"5a116cbc-6614-4e79-9389-b85994640c4f","uuid":"c008cbd9-ba93-44d4-83a2-426942cd1463","hook_name":"SessionStart:startup","hook_event":"SessionStart","stdout":"Claude-5a116cbc tracked in tmux ff70G-japanese-mod:56:%58\n","stderr":"","exit_code":0},{"type":"system","subtype":"hook_response","session_id":"5a116cbc-6614-4e79-9389-b85994640c4f","uuid":"3320dfc7-6bee-47aa-99dc-620d8c35748d","hook_name":"SessionStart:startup","hook_event":"SessionStart","stdout":"play-startup-sound.sh > ðŸŽ® playing startup sound [source: startup, session: 5a116cbc...]\n","stderr":"","exit_code":0},{"type":"system","subtype":"hook_response","session_id":"5a116cbc-6614-4e79-9389-b85994640c4f","uuid":"08d937dc-0a64-49f7-9c77-d47d7a24a47b","hook_name":"SessionStart:startup","hook_event":"SessionStart","stdout":"inject-session-context.sh > Context injected: /Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod on main (36 untracked, 23 modified) [~1479 tokens]\n{\n  \"hookSpecificOutput\": {\n    \"hookEventName\": \"SessionStart\",\n    \"additionalContext\": \"# Session Start Dynamic Context\\n**Updated**: 2025-12-01 23:04:51 JST (Monday)\\n**ISO 8601**: 2025-12-01T14:04:51Z\\n\\n## Current Working Directory\\n`/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod`\\n\\n\\n\\n## Git Repository Status\\n- **Current Branch**: `main`\\n- **Last Commit**: 1b7b34a - fix(scripts): fix two critical bugs in launch_standardization_agents.sh (25 minutes ago)\\n- **Untracked Files**: 36\\n- **Remote**: makosource\\tgit@github.com:john-savepoint/makosource.git (fetch)\\n\\n## Project Directory Structure (JSON)\\n\\n**Algorithm**: Levenshtein similarity ratio + semantic pattern detection\\n**Exclusions**: .gitignore patterns + hardcoded common patterns (node_modules, .git, dist, build, coverage, __pycache__)\\n**Truncation**:\\n- Files with â‰¥50% name similarity grouped (e.g., `test1.ts`, `test2.ts` â†’ `+N`)\\n- Non-semantic patterns hidden (UUIDs, session IDs, hashes, logs, tmp files)\\n- Semantic files always preserved (package.json, tsconfig.json, README.md, src/*.ts)\\n- Max depth: 2-4 levels (adaptive based on size, targets <15k tokens)\\n\\n**Reading**: `\\\"f\\\":[\\\"file.ts\\\",\\\"+5\\\"]` = 1 shown file + 5 similar/non-semantic files hidden\\n**Critical**: Source files (`src/**/*.ts`) never truncated via similarity, only via depth limits\\n\\n```json\\n{\\\".claude\\\":{\\\"data\\\":{\\\"ff7-docs-context\\\":{\\\"f\\\":[\\\"agent_summaries.json\\\",\\\"document_categories.json\\\",\\\"+4\\\"]},\\\"sessions\\\":{\\\"f\\\":[\\\"0442c7ca-eff1-466c-93f8-f629ccf6ddfb.json\\\",\\\"0cc720b2-3ab5-42f5-9a3c-7c40de6aa93e.json\\\",\\\"+2\\\"]}},\\\"logs\\\":{\\\"f\\\":[\\\"bash-output.log\\\",\\\"skill-usage.log\\\"]},\\\"tmp\\\":{\\\"agent-prompts\\\":{\\\"f\\\":[\\\"FF7_Battle_Battle_Animation_PC_output.json\\\",\\\"FF7_Battle_Battle_Animation_PC_prompt.txt\\\",\\\"+8\\\"]}}},\\\"FF7-Japanese-Mod\\\":{\\\".claude\\\":{\\\"data\\\":{\\\"sessions\\\":{\\\"f\\\":[\\\"0ba935f5-efe0-457c-ad7e-c18f89cfba18.json\\\"]}}},\\\"f\\\":[\\\"Readme.txt\\\",\\\"mod.xml\\\"]},\\\"archive\\\":{\\\"character_tables_debug\\\":{\\\"debug_cells\\\":{\\\"f\\\":[\\\"inv_jafont_1_idx006_gxy6_0.png\\\",\\\"inv_jafont_1_idx116_gxy4_7.png\\\",\\\"+32\\\"]}},\\\"character_tables_pre-interactive\\\":{\\\"f\\\":[\\\"character_map.csv\\\",\\\"character_map.json\\\",\\\"mapping_discrepancies.csv\\\",\\\"ocr_confidence.json\\\",\\\"+4\\\"]},\\\"character_tables_verification\\\":{\\\"verification\\\":{\\\"f\\\":[\\\"jafont_1_comparison.png\\\",\\\"jafont_1_generated.png\\\",\\\"+16\\\"]},\\\"verification_topleft\\\":{\\\"f\\\":[\\\"jafont_1_comparison_topleft.png\\\",\\\"jafont_1_mangaocr_topleft.png\\\",\\\"+10\\\"]}},\\\"findings_legacy\\\":{\\\"f\\\":[\\\"FINDINGS.md\\\",\\\"FINDINGS.md.backup\\\",\\\"findings2.md\\\"]},\\\"scripts\\\":{\\\"f\\\":[\\\"compare_mappings.py\\\",\\\"debug_mangaocr_cells.py\\\",\\\"generate_accurate_charmap.py\\\",\\\"manga_ocr_mapper.py\\\",\\\"measure_actual_glyph_size.py\\\",\\\"reassemble_findings.py\\\",\\\"+10\\\"]},\\\"sharded\\\":{\\\"bible\\\":{},\\\"bible_sections\\\":{\\\"f\\\":[\\\"1-executive-mission-briefing.md\\\",\\\"10-advanced-feature-furigana-support.md\\\",\\\"11-testing-verification-protocol.md\\\",\\\"12-risk-mitigation-debugging-guide.md\\\",\\\"14-reference-materials-appendices.md\\\",\\\"2-architectural-overview-strategic-analysis.md\\\",\\\"4-asset-specifications-data-structures.md\\\",\\\"5-ffnx-codebase-architecture.md\\\",\\\"6-deep-dive-technical-constraints-solutions.md\\\",\\\"7-implementation-specification-c-modifications.md\\\",\\\"conclusion.md\\\",\\\"index.md\\\",\\\"+6\\\"]},\\\"findings\\\":{},\\\"findings_sections\\\":{\\\"f\\\":[\\\"00_INDEX.md\\\",\\\"01_executive_summary.md\\\",\\\"06_ff7_text_system_architecture.md\\\",\\\"12_potential_implementation_approaches.md\\\",\\\"13_required_modifications.md\\\",\\\"14_development_roadmap_considerations.md\\\",\\\"17_next_steps.md\\\",\\\"18_conclusion.md\\\",\\\"27_breakthrough_first_ever_ff7_japanese_character_table_created.md\\\",\\\"+21\\\"]},\\\"f\\\":[\\\"README.md\\\",\\\"shard_findings.py\\\"]},\\\"f\\\":[\\\"ARCHITECTURAL_RETROSPECTIVE.md\\\",\\\"SCRAPED_URLS.md\\\",\\\"TOOL_VERIFICATION_LOG.md\\\",\\\"UNSCRAPPED_URLS.md\\\"]},\\\"assets\\\":{\\\"character_mappings\\\":{\\\"interactive_viewer\\\":{\\\"f\\\":[\\\"all_textures_corrections.json\\\",\\\"jafont_1_corrections (1).json\\\",\\\"jafont_6_final.json\\\",\\\"+11\\\"]}}},\\\"docs\\\":{\\\"character_maps\\\":{\\\"f\\\":[\\\"JAFONT_CHARACTER_MAP.md\\\",\\\"ff7_complete_mapping_compact.csv\\\"]},\\\"recent\\\":{},\\\"reference\\\":{\\\"game_engine\\\":{\\\".claude\\\":{},\\\"comparisons\\\":{\\\"f\\\":[\\\"CRITICAL_DISCREPANCIES_REQUIRING_INVESTIGATION.md\\\",\\\"FF7_Battle_Battle_Animation_PC_vs_06_BATTLE_MODULE_analysis.md\\\",\\\"FF7_Battle_Battle_Field_vs_06_BATTLE_MODULE_analysis.md\\\",\\\"repomix-comparisons-markdown.md\\\",\\\"+36\\\"]},\\\"extracted_major_sections\\\":{\\\"f\\\":[\\\"00_HEADER_TOC.md\\\",\\\"01_HISTORY.md\\\",\\\"06_BATTLE_MODULE.md\\\",\\\"11_BUGS_AND_CREDITS.md\\\",\\\"+10\\\"]},\\\"final\\\":{\\\"f\\\":[\\\"FF7_Battle_Battle_Animation_PC.md\\\",\\\"FF7_Battle_Battle_Field.md\\\",\\\"+2\\\"]},\\\"images\\\":{\\\"f\\\":[\\\"Engine_parts.jpg\\\",\\\"Field_BackgroundVRAM.jpg\\\",\\\"Gears_img_3.jpg\\\",\\\"+25\\\"]},\\\"markdown\\\":{\\\"f\\\":[\\\"FF7.md\\\",\\\"FF7_Chocobo_Breeding.md\\\",\\\"FF7_History.md\\\",\\\"FF7_Item_Materia_Reference.md\\\",\\\"+32\\\"]},\\\"raw\\\":{\\\"f\\\":[\\\"FF7.mediawiki\\\",\\\"FF7_Battle_Battle_Field.mediawiki\\\",\\\"+30\\\"]},\\\"f\\\":[\\\"AGENT_COMPARISON_GUIDE.md\\\",\\\"ENHANCEMENT_PLAN.md\\\",\\\"FINAL_CONVERSION_PIPELINE.md\\\",\\\"Playstation Battle Model Format.md\\\",\\\"combine_files.sh\\\",\\\"copy-paste from ff7 wiki.md\\\",\\\"ff7 game engine_meta.json\\\",\\\"links to copy in order.txt\\\",\\\"move_toc_below_heading.py\\\",\\\"scraper.py\\\",\\\"+59\\\"]},\\\"f\\\":[\\\"AF3DN_ANALYSIS.md\\\",\\\"ARCHITECTURE_CLARIFICATION.md\\\",\\\"BEGINNER_GUIDE.md\\\",\\\"MULTI_LANGUAGE_FINDINGS.md\\\",\\\"TOOL_GUIDE.md\\\",\\\"VERIFICATION_FINDINGS_SESSION_11.md\\\"]},\\\"roadmap\\\":{\\\"f\\\":[\\\"FEATURE_ROADMAP.md\\\",\\\"FFNX_CROWDSOURCED_TRANSLATION_SPEC.md\\\"]},\\\"f\\\":[\\\"7TH_HEAVEN_DEVELOPER_GUIDE.md\\\",\\\"BUILD_ENVIRONMENT_SETUP.md\\\",\\\"DOCUMENTATION_UPDATE_PLAN.md\\\",\\\"FFNX_DEVELOPER_GUIDE.md\\\",\\\"PR737_files_summary.txt\\\",\\\"README.md\\\",\\\"To-do list for documentation.md\\\",\\\"masterfindings.md\\\",\\\"+11\\\"]},\\\"japanese-assets-extracted\\\":{\\\"mod-structure\\\":{},\\\"f\\\":[\\\"FFNx-japanese.toml\\\",\\\"README.md\\\",\\\"TRANSFER_CHECKLIST.md\\\",\\\"WINDOWS_INSTALLATION_GUIDE.md\\\"]},\\\"reference\\\":{\\\"repomix_snapshots\\\":{\\\"f\\\":[\\\"FFNx_repomix.md\\\"]}},\\\"scripts\\\":{\\\"f\\\":[\\\"AGENT_LAUNCHER_USAGE.md\\\",\\\"BUG_FIXES.md\\\",\\\"extract_doc_context.py\\\",\\\"launch_standardization_agents.sh\\\"]},\\\"f\\\":[\\\"DOCUMENTATION_MAP.md\\\",\\\"README.md\\\",\\\"SIMPLE_INSTRUCTIONS.md\\\",\\\"claude.md\\\"]}\\n```\\n\\n## Tmux Environment\\n- **Session**: `ff70G-japanese-mod` (`$7`)\\n- **Window**: `claude-5a116cbc` (`@56` / index: 8)\\n- **Pane**: `%58`\\n\\n---\\n*This context was automatically injected at session start to provide current state information.*\\n\"\n  }\n}\n","stderr":"","exit_code":0},{"type":"system","subtype":"init","cwd":"/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod","session_id":"5a116cbc-6614-4e79-9389-b85994640c4f","tools":["Task","Bash","Glob","Grep","ExitPlanMode","Read","Edit","Write","NotebookEdit","WebFetch","TodoWrite","WebSearch","BashOutput","KillShell","Skill","SlashCommand","EnterPlanMode","mcp__context7__resolve-library-id","mcp__context7__get-library-docs","mcp__tmux__list-sessions","mcp__tmux__find-session","mcp__tmux__list-windows","mcp__tmux__list-panes","mcp__tmux__capture-pane","mcp__tmux__create-session","mcp__tmux__create-window","mcp__tmux__execute-command","mcp__tmux__get-command-result","ListMcpResourcesTool","ReadMcpResourceTool","mcp__interactive-send-and-capture__send_and_capture","mcp__interactive-send-and-capture__capture_pane","mcp__interactive-send-and-capture__send_input","mcp__mcp-mermaid__generate_mermaid_diagram","mcp__brave-search__brave_web_search","mcp__brave-search__brave_local_search","mcp__firecrawl__firecrawl_scrape","mcp__firecrawl__firecrawl_map","mcp__firecrawl__firecrawl_search","mcp__firecrawl__firecrawl_crawl","mcp__firecrawl__firecrawl_check_crawl_status","mcp__firecrawl__firecrawl_extract"],"mcp_servers":[{"name":"fetch","status":"disabled"},{"name":"sequential-thinking","status":"disabled"},{"name":"filesystem","status":"disabled"},{"name":"shadcn-ui","status":"disabled"},{"name":"context7","status":"connected"},{"name":"tmux","status":"connected"},{"name":"serena","status":"disabled"},{"name":"interactive-send-and-capture","status":"connected"},{"name":"mcp-mermaid","status":"connected"},{"name":"chrome-devtools","status":"disabled"},{"name":"svelte","status":"disabled"},{"name":"brave-search","status":"connected"},{"name":"firecrawl","status":"connected"}],"model":"claude-opus-4-5-20251101","permissionMode":"acceptEdits","slash_commands":["claude-code-hook-builder","mermaid-diagram-writer","slash-command-builder","superpowers:brainstorm","superpowers:execute-plan","superpowers:write-plan","agent-sdk-dev:new-sdk-app","pr-review-toolkit:review-pr","commit-commands:clean_gone","commit-commands:commit-push-pr","commit-commands:commit","feature-dev:feature-dev","code-review:code-review","document-skills:xlsx","document-skills:docx","document-skills:pptx","document-skills:pdf","example-skills:skill-creator","example-skills:mcp-builder","example-skills:canvas-design","example-skills:algorithmic-art","example-skills:internal-comms","example-skills:webapp-testing","example-skills:artifacts-builder","example-skills:slack-gif-creator","example-skills:theme-factory","example-skills:brand-guidelines","superpowers:brainstorming","superpowers:condition-based-waiting","superpowers:defense-in-depth","superpowers:dispatching-parallel-agents","superpowers:executing-plans","superpowers:finishing-a-development-branch","superpowers:receiving-code-review","superpowers:requesting-code-review","superpowers:root-cause-tracing","superpowers:sharing-skills","superpowers:subagent-driven-development","superpowers:systematic-debugging","superpowers:test-driven-development","superpowers:testing-anti-patterns","superpowers:testing-skills-with-subagents","superpowers:using-git-worktrees","superpowers:using-superpowers","superpowers:verification-before-completion","superpowers:writing-plans","superpowers:writing-skills","developer-essentials:auth-implementation-patterns","developer-essentials:code-review-excellence","developer-essentials:debugging-strategies","developer-essentials:e2e-testing-patterns","developer-essentials:error-handling-patterns","developer-essentials:git-advanced-workflows","developer-essentials:monorepo-management","developer-essentials:sql-optimization-patterns","developer-essentials:git-advanced-workflows","developer-essentials:sql-optimization-patterns","developer-essentials:error-handling-patterns","developer-essentials:code-review-excellence","developer-essentials:e2e-testing-patterns","developer-essentials:auth-implementation-patterns","developer-essentials:debugging-strategies","developer-essentials:monorepo-management","compact","context","cost","init","pr-comments","release-notes","todos","review","security-review"],"apiKeySource":"none","claude_code_version":"2.0.55","output_style":"default","agents":["general-purpose","statusline-setup","Explore","Plan","superpowers:code-reviewer","agent-sdk-dev:agent-sdk-verifier-py","agent-sdk-dev:agent-sdk-verifier-ts","pr-review-toolkit:code-reviewer","pr-review-toolkit:code-simplifier","pr-review-toolkit:comment-analyzer","pr-review-toolkit:pr-test-analyzer","pr-review-toolkit:silent-failure-hunter","pr-review-toolkit:type-design-analyzer","feature-dev:code-architect","feature-dev:code-explorer","feature-dev:code-reviewer"],"skills":["claude-code-hook-builder","mermaid-diagram-writer","slash-command-builder","document-skills:xlsx","document-skills:docx","document-skills:pptx","document-skills:pdf","example-skills:skill-creator","example-skills:mcp-builder","example-skills:canvas-design","example-skills:algorithmic-art","example-skills:internal-comms","example-skills:webapp-testing","example-skills:artifacts-builder","example-skills:slack-gif-creator","example-skills:theme-factory","example-skills:brand-guidelines","superpowers:brainstorming","superpowers:condition-based-waiting","superpowers:defense-in-depth","superpowers:dispatching-parallel-agents","superpowers:executing-plans","superpowers:finishing-a-development-branch","superpowers:receiving-code-review","superpowers:requesting-code-review","superpowers:root-cause-tracing","superpowers:sharing-skills","superpowers:subagent-driven-development","superpowers:systematic-debugging","superpowers:test-driven-development","superpowers:testing-anti-patterns","superpowers:testing-skills-with-subagents","superpowers:using-git-worktrees","superpowers:using-superpowers","superpowers:verification-before-completion","superpowers:writing-plans","superpowers:writing-skills","developer-essentials:auth-implementation-patterns","developer-essentials:code-review-excellence","developer-essentials:debugging-strategies","developer-essentials:e2e-testing-patterns","developer-essentials:error-handling-patterns","developer-essentials:git-advanced-workflows","developer-essentials:monorepo-management","developer-essentials:sql-optimization-patterns","developer-essentials:git-advanced-workflows","developer-essentials:sql-optimization-patterns","developer-essentials:error-handling-patterns","developer-essentials:code-review-excellence","developer-essentials:e2e-testing-patterns","developer-essentials:auth-implementation-patterns","developer-essentials:debugging-strategies","developer-essentials:monorepo-management"],"plugins":[{"name":"document-skills","path":"/Users/johnzealand-doyle/.claude/plugins/marketplaces/anthropic-agent-skills/"},{"name":"example-skills","path":"/Users/johnzealand-doyle/.claude/plugins/marketplaces/anthropic-agent-skills/"},{"name":"superpowers","path":"/Users/johnzealand-doyle/.claude/plugins/cache/superpowers"},{"name":"agent-sdk-dev","path":"/Users/johnzealand-doyle/.claude/plugins/marketplaces/claude-code-plugins/plugins/agent-sdk-dev"},{"name":"pr-review-toolkit","path":"/Users/johnzealand-doyle/.claude/plugins/marketplaces/claude-code-plugins/plugins/pr-review-toolkit"},{"name":"commit-commands","path":"/Users/johnzealand-doyle/.claude/plugins/marketplaces/claude-code-plugins/plugins/commit-commands"},{"name":"feature-dev","path":"/Users/johnzealand-doyle/.claude/plugins/marketplaces/claude-code-plugins/plugins/feature-dev"},{"name":"security-guidance","path":"/Users/johnzealand-doyle/.claude/plugins/marketplaces/claude-code-plugins/plugins/security-guidance"},{"name":"code-review","path":"/Users/johnzealand-doyle/.claude/plugins/marketplaces/claude-code-plugins/plugins/code-review"},{"name":"developer-essentials","path":"/Users/johnzealand-doyle/.claude/plugins/marketplaces/claude-code-workflows/plugins/developer-essentials"},{"name":"explanatory-output-style","path":"/Users/johnzealand-doyle/.claude/plugins/marketplaces/claude-code-plugins/plugins/explanatory-output-style"}],"uuid":"6d7b941f-f180-4d55-83ee-20f896e0e8a9"},{"type":"assistant","message":{"model":"claude-opus-4-5-20251101","id":"msg_01PwmcpYSJLwdWEiZoDMysSH","type":"message","role":"assistant","content":[{"type":"text","text":"I'll transform FF7_Battle_Battle_Scenes.md according to the comprehensive instructions. Let me first read the source file to understand its current structure."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":2,"cache_creation_input_tokens":35606,"cache_read_input_tokens":29808,"cache_creation":{"ephemeral_5m_input_tokens":35606,"ephemeral_1h_input_tokens":0},"output_tokens":139,"service_tier":"standard"},"context_management":null},"parent_tool_use_id":null,"session_id":"5a116cbc-6614-4e79-9389-b85994640c4f","uuid":"0b0cb7b9-2a09-451a-a8b6-d8d5b91fc01f"},{"type":"assistant","message":{"model":"claude-opus-4-5-20251101","id":"msg_01PwmcpYSJLwdWEiZoDMysSH","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01LEN7F98ih2eihqWEDsUmfn","name":"Read","input":{"file_path":"/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/markdown/merged_with_pdf_content/FF7_Battle_Battle_Scenes.md"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":2,"cache_creation_input_tokens":35606,"cache_read_input_tokens":29808,"cache_creation":{"ephemeral_5m_input_tokens":35606,"ephemeral_1h_input_tokens":0},"output_tokens":139,"service_tier":"standard"},"context_management":null},"parent_tool_use_id":null,"session_id":"5a116cbc-6614-4e79-9389-b85994640c4f","uuid":"e38796af-92e2-4a17-8f15-613c8d83275f"},{"type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01LEN7F98ih2eihqWEDsUmfn","type":"tool_result","content":"     1â†’<!--\n     2â†’MERGE METADATA\n     3â†’Created: 2025-11-28\n     4â†’Original: FF7_Battle_Battle_Scenes.md (728 lines)\n     5â†’Major section: 06_BATTLE_MODULE.md\n     6â†’Merge decision: NO EXTRACTION PERFORMED\n     7â†’Reason: Individual file contains SUPERIOR documentation to major section\n     8â†’Key differences:\n     9â†’  - Individual file: Modern HTML table format with detailed specifications\n    10â†’  - Major section: Older text-based documentation (Fremen format, Sept 2003)\n    11â†’  - Individual file includes CRITICAL Japanese format note (16-byte vs 32-byte names)\n    12â†’  - Major section lacks Japanese variant documentation\n    13â†’Recommendation: Preserve individual file as-is (source of truth)\n    14â†’Report: comparisons/FF7_Battle_Battle_Scenes_vs_06_BATTLE_MODULE_analysis.md\n    15â†’-->\n    16â†’# FF7/Battle/Battle Scenes {#ff7battlebattle_scenes}\n    17â†’\n    18â†’- [FF7/Battle/Battle Scenes](#ff7battlebattle_scenes){#toc-ff7battlebattle_scenes}\n    19â†’  - [Introduction](#introduction){#toc-introduction}\n    20â†’  - [Scene.Bin file format](#scene.bin_file_format){#toc-scene.bin_file_format}\n    21â†’\n    22â†’\n    23â†’## Introduction\n    24â†’\n    25â†’FF7 keeps each enemy battle configuration is a file called \\\"scene.bin\\\" This file is located in the following directories.\n    26â†’\n    27â†’|      PSX Version       |    PC Version     |\n    28â†’|:----------------------:|:-----------------:|\n    29â†’| /DATA/BATTLE/SCENE.BIN | /BATTLE/SCENE.BIN |\n    30â†’\n    31â†’This file is exactly the same in both versions. This holds all the battle configurations for all enemies encountered in the game.\n    32â†’\n    33â†’## Scene.Bin file format {#scene.bin_file_format}\n    34â†’\n    35â†’### Overview\n    36â†’\n    37â†’The scene.bin file contains 256 gziped files which give us information for all the FF7 monsters. In order to find these files in scene.bin, you have to know that the file is structured with blocks exactly 0x2000 bytes in length. In the first table (scene.bin block), you will see what contains a block. Blocks are concatenated with each other to form the scene.bin file. So if you want to extract data from scene.bin, you\\'ll need to find the correct blocks and to extract the gziped files from it. After that you simply ungzip those files and you\\'ll find 256 files, with a length is 7808 bytes. Known information about those files can be found in the second table (The Data File specification). Because extracting file manually would be a pain, several tools was developed in order to help you. You can use [Scene Reader](http://spinningcone.com/ff/stormmedia/projects/SceneReader.zip) for example, it\\'s a win32 tool to extract and repack scene.bin archive.\n    38â†’\n    39â†’Also note, that in [kernel.bin](FF7/Kernel/Kernel.bin \"kernel.bin\"){.wikilink} there is a look-up table for scene.bin, which tells how many files there are in each section of scene.bin. You need to update it every time you repack the file and something changes. The table is at offset 0x0F1C of the third section of the kernel.bin file. You can use [SceneFix](http://forums.qhimm.com/index.php?topic=7127.0) program, which\\'ll update the table for you.\n    40â†’\n    41â†’We have 1024 possible battle numbers: 0 - 1023. Each group of \\*4\\* Battle Numbers refers to a particular Scene file: for instance, Battles 0-3 refer to File 0 in Scene.bin, Battles 4-7 refer to File 1 in Scene.bin, and so forth.\n    42â†’\n    43â†’\\\n    44â†’\n    45â†’#### Japanese format {#japanese_format}\n    46â†’\n    47â†’In the japanese scene.bin, ennemies names and attacks names have a size of 16 bytes, instead of 32 bytes.\n    48â†’\n    49â†’\\\n    50â†’\n    51â†’### General file format {#general_file_format}\n    52â†’\n    53â†’<table>\n    54â†’<thead>\n    55â†’<tr>\n    56â†’<th><p>Offset</p></th>\n    57â†’<th><p>Length</p></th>\n    58â†’<th><p>Description</p></th>\n    59â†’</tr>\n    60â†’</thead>\n    61â†’<tbody>\n    62â†’<tr>\n    63â†’<td><p>0x0000</p></td>\n    64â†’<td><p>4 bytes</p></td>\n    65â†’<td><p>Pointer to first data file. You must multiply it by 4 to get actual data file offset. If the pointer is equal to FFFFFFFFh then it means that the end of block has been reached.</p></td>\n    66â†’</tr>\n    67â†’<tr>\n    68â†’<td><p>0x0004</p></td>\n    69â†’<td><p>4 bytes</p></td>\n    70â†’<td><p>Pointer to second data file. You must multiply it by 4 to get actual data file offset. If the pointer is equal to FFFFFFFFh then it means that the end of block has been reached.</p></td>\n    71â†’</tr>\n    72â†’<tr>\n    73â†’<td colspan=\"3\" style=\"text-align: center;\"><p>...</p></td>\n    74â†’</tr>\n    75â†’<tr>\n    76â†’<td><p>0x003C</p></td>\n    77â†’<td><p>4 bytes</p></td>\n    78â†’<td><p>Last pointer, usually it equal FFFFFFFFh.</p></td>\n    79â†’</tr>\n    80â†’<tr>\n    81â†’<td><p>0x0040</p></td>\n    82â†’<td><p>4 * (pointer2 - pointer1) bytes</p></td>\n    83â†’<td><p>First data file in block. It's a gziped file.<br />\n    84â†’<em>Note: Sometimes it may finish by 0xFF bytes, because its size must be multiple of 4.</em></p></td>\n    85â†’</tr>\n    86â†’<tr>\n    87â†’<td><p>pointer2 * 4</p></td>\n    88â†’<td><p>4 * (pointer3 - pointer2) bytes</p></td>\n    89â†’<td><p>Second data file in block. It's a gziped file.<br />\n    90â†’<em>Note: Sometimes it may finish by 0xFF bytes, because its size must be multiple of 4.</em></p></td>\n    91â†’</tr>\n    92â†’<tr>\n    93â†’<td colspan=\"3\" style=\"text-align: center;\"><p>...</p></td>\n    94â†’</tr>\n    95â†’<tr>\n    96â†’<td><p>lastpointer * 4</p></td>\n    97â†’<td><p>4 * (2000h - lastpointer) bytes</p></td>\n    98â†’<td><p>Last data file in block.<br />\n    99â†’<em>Note: There are about 6 to 12 files in each block. Each block finishes by 0xFF bytes, because its length must be 2000h (8192d) bytes.</em></p></td>\n   100â†’</tr>\n   101â†’</tbody>\n   102â†’</table>\n   103â†’\n   104â†’### Data file format {#data_file_format}\n   105â†’\n   106â†’| Offset | Length | Description |\n   107â†’|----|----|----|\n   108â†’| 0x0000 | 2 bytes | Enemy ID 1 |\n   109â†’| 0x0002 | 2 bytes | Enemy ID 2 |\n   110â†’| 0x0004 | 2 bytes | Enemy ID 3 |\n   111â†’| 0x0006 | 2 bytes | Padding (always FFFFh) |\n   112â†’| 0x0008 | 4 \\* 20 bytes | Battle Setup (4 records) ([format explanation](#Battle_Setup_1_format \"format explanation\"){.wikilink}) |\n   113â†’| 0x0058 | 4 \\* 48 bytes | Camera Placement Data (4 records) ([format explanation](#Camera_Placement_Data_format \"format explanation\"){.wikilink}) |\n   114â†’| 0x0118 | 6 \\* 16 bytes | Battle Formation 1 (6 records) ([format explanation](#Battle_Formation_Data \"format explanation\"){.wikilink}) |\n   115â†’| 0x0178 | 6 \\* 16 bytes | Battle Formation 2 (6 records) |\n   116â†’| 0x01E8 | 6 \\* 16 bytes | Battle Formation 3 (6 records) |\n   117â†’| 0x0238 | 6 \\* 16 bytes | Battle Formation 4 (6 records) |\n   118â†’| 0x0298 | 184 bytes | Enemy Data 1 ([format explanation](#Enemy_data_format \"format explanation\"){.wikilink}) |\n   119â†’| 0x0350 | 184 bytes | Enemy Data 2 |\n   120â†’| 0x0408 | 184 bytes | Enemy Data 3 |\n   121â†’| 0x04C0 | 32 \\* 28 bytes | Attack Data (32 records) ([format explanation](FF7/Attack_data \"format explanation\"){.wikilink}) |\n   122â†’| 0x0840 | 32 \\* 2 bytes | Attack IDs (32 records) |\n   123â†’| 0x0880 | 32 \\* 32 bytes | Attack Names (32 records, [in FF Text format](FF7/FF_Text \"in FF Text format\"){.wikilink}) |\n   124â†’| 0x0C80 | 2 bytes | Formation 1 AI Script Offset |\n   125â†’| 0x0C82 | 2 bytes | Formation 2 AI Script Offset |\n   126â†’| 0x0C84 | 2 bytes | Formation 3 AI Script Offset |\n   127â†’| 0x0C86 | 2 bytes | Formation 4 AI Script Offset |\n   128â†’| 0x0C88 | 0 - 504 bytes | Beginning of Formation AI Data ([format explanation](#AI_Data \"format explanation\"){.wikilink}) |\n   129â†’| 0x0E80 | 2 bytes | Enemy 1 AI Offset |\n   130â†’| 0x0E82 | 2 bytes | Enemy 2 AI Offset |\n   131â†’| 0x0E84 | 2 bytes | Enemy 3 AI Offset |\n   132â†’| 0x0E86 | 0 - 4090 bytes | Beginning of AI Data ([format explanation](#AI_Data \"format explanation\"){.wikilink}) |\n   133â†’\n   134â†’\\\n   135â†’\n   136â†’#### Battle Setup 1 format {#battle_setup_1_format}\n   137â†’\n   138â†’<table>\n   139â†’<thead>\n   140â†’<tr>\n   141â†’<th><p>Offset</p></th>\n   142â†’<th><p>Length</p></th>\n   143â†’<th><p>Description</p></th>\n   144â†’</tr>\n   145â†’</thead>\n   146â†’<tbody>\n   147â†’<tr>\n   148â†’<td><p>0x0000</p></td>\n   149â†’<td><p>2 bytes</p></td>\n   150â†’<td><p><strong>Battle location, as follows:</strong></p></td>\n   151â†’</tr>\n   152â†’<tr>\n   153â†’<td colspan=\"2\" rowspan=\"2\" style=\"text-align: center; background: rgb(104,104,155);\"></td>\n   154â†’<td></td>\n   155â†’</tr>\n   156â†’<tr>\n   157â†’<td><p>0000h : Blank<br />\n   158â†’0001h : Bizarro Battle - Center<br />\n   159â†’0002h : Grassland<br />\n   160â†’0003h : Mt Nibel<br />\n   161â†’0004h : Forest<br />\n   162â†’0005h : Beach<br />\n   163â†’0006h : Desert<br />\n   164â†’0007h : Snow<br />\n   165â†’0008h : Swamp<br />\n   166â†’0009h : Sector 1 Train Station<br />\n   167â†’000Ah : Reactor 1<br />\n   168â†’000Bh : Reactor 1 Core<br />\n   169â†’000Ch : Reactor 1 Entrance<br />\n   170â†’000Dh : Sector 4 Subway<br />\n   171â†’000Eh : Nibel Caves or AForest Caves<br />\n   172â†’000Fh : Shinra HQ<br />\n   173â†’0010h : Midgar Raid Subway<br />\n   174â†’0011h : Hojo's Lab<br />\n   175â†’0012h : Shinra Elevators<br />\n   176â†’0013h : Shinra Roof<br />\n   177â†’0014h : Midgar Highway<br />\n   178â†’0015h : Wutai Pagoda<br />\n   179â†’0016h : Church<br />\n   180â†’0017h : Coral Valley<br />\n   181â†’0018h : Midgar Slums<br />\n   182â†’0019h : Sector 4 Corridors or Junon Path<br />\n   183â†’001Ah : Sector 4 Gantries or Midgar Underground<br />\n   184â†’001Bh : Sector 7 Support Pillar Stairway<br />\n   185â†’001Ch : Sector 7 Support Pillar Top<br />\n   186â†’001Dh : Sector 8<br />\n   187â†’001Eh : Sewers<br />\n   188â†’001Fh : Mythril Mines<br />\n   189â†’0020h : Northern Crater - Floating Platforms<br />\n   190â†’0021h : Corel Mountain Path<br />\n   191â†’0022h : Junon Beach<br />\n   192â†’0023h : Junon Cargo Ship<br />\n   193â†’0024h : Corel Prison<br />\n   194â†’0025h : Battle Square<br />\n   195â†’0026h : Da Chao - Rapps Battle<br />\n   196â†’0027h : Cid's Backyard<br />\n   197â†’0028h : Final Descent to Sephiroth<br />\n   198â†’0029h : Reactor 5 Entrance<br />\n   199â†’002Ah : Temple of the Ancients - Escher Room<br />\n   200â†’002Bh : Shinra Mansion<br />\n   201â†’002Ch : Junon Airship Dock<br />\n   202â†’002Dh : Whirlwind Maze<br />\n   203â†’002Eh : Junon Underwater Reactor<br />\n   204â†’002Fh : Gongaga Reactor<br />\n   205â†’0030h : Gelnika<br />\n   206â†’0031h : Train Graveyard<br />\n   207â†’0032h : Great Glacier Ice Caves &amp; Gaea Cliffs - Inside<br />\n   208â†’0033h : Sister Ray<br />\n   209â†’0034h : Sister Ray Base<br />\n   210â†’0035h : Forgotten City Altar<br />\n   211â†’0036h : Northern Crater - Initial Descent<br />\n   212â†’0037h : Northern Crater - Hatchery<br />\n   213â†’0038h : Northern Crater - Water Area<br />\n   214â†’0039h : Safer Battle<br />\n   215â†’003Ah : Kalm Flashback - Dragon Battle<br />\n   216â†’003Bh : Junon Underwater Pipe<br />\n   217â†’003Ch : Blank<br />\n   218â†’003Dh : Corel Railway - Canyon<br />\n   219â†’003Eh : Whirlwind Maze - Crater<br />\n   220â†’003Fh : Corel Railway - Rollercoaster<br />\n   221â†’0040h : Wooden Bridge<br />\n   222â†’0041h : Da Chao<br />\n   223â†’0042h : Fort Condor<br />\n   224â†’0043h : Dirt Wasteland<br />\n   225â†’0044h : Bizarro Battle - Right Side<br />\n   226â†’0045h : Bizarro Battle - Left Side<br />\n   227â†’0046h : Jenova*SYNTHESIS Battle<br />\n   228â†’0047h : Corel Train Battle<br />\n   229â†’0048h : Cosmo Canyon<br />\n   230â†’0049h : Caverns of the Gi<br />\n   231â†’004Ah : Nibelheim Mansion Basement<br />\n   232â†’004Bh : Temple of the Ancients - Demons Gate<br />\n   233â†’004Ch : Temple of the Ancients - Mural Room<br />\n   234â†’004Dh : Temple of the Ancients - Clock Passage<br />\n   235â†’004Eh : Final Battle - Sephiroth<br />\n   236â†’004Fh : Jungle<br />\n   237â†’0050h : Ultimate Weapon - Battle on Highwind<br />\n   238â†’0051h : Corel Reactor<br />\n   239â†’0052h : Unused<br />\n   240â†’0053h : Don Corneo's Mansion<br />\n   241â†’0054h : Emerald Weapon Battle<br />\n   242â†’0055h : Reactor 5<br />\n   243â†’0056h : Shinra HQ - Escape<br />\n   244â†’0057h : Ultimate Weapon - Gongaga Reactor<br />\n   245â†’0058h : Corel Prison - Dyne Battle<br />\n   246â†’0059h : Ultimate Weapon - Forest</p></td>\n   247â†’</tr>\n   248â†’<tr>\n   249â†’<td><p>0x0002</p></td>\n   250â†’<td><p>2 bytes</p></td>\n   251â†’<td><p>Upon defeat of all opponents in current formation, begin battle with <a href=\"FF7/Battle/Battle_scenes#Formation_ID\" class=\"wikilink\" title=\"Formation ID\">Formation ID</a> without ending battle scene</p></td>\n   252â†’</tr>\n   253â†’<tr>\n   254â†’<td><p>0x0004</p></td>\n   255â†’<td><p>2 bytes</p></td>\n   256â†’<td><p>Escape Counter</p></td>\n   257â†’</tr>\n   258â†’<tr>\n   259â†’<td><p>0x0006</p></td>\n   260â†’<td><p>2 bytes</p></td>\n   261â†’<td><p>Unused/Align 'FF'</p></td>\n   262â†’</tr>\n   263â†’<tr>\n   264â†’<td><p>0x0008</p></td>\n   265â†’<td><p>4 * 2 bytes</p></td>\n   266â†’<td><p><a href=\"FF7/Battle/Battle_scenes#Formation_ID\" class=\"wikilink\" title=\"Formation ID\">Formation ID</a> of candidates for next Battle Arena battle. (default of 03E7h)</p></td>\n   267â†’</tr>\n   268â†’<tr>\n   269â†’<td><p>0x0010</p></td>\n   270â†’<td><p>2 bytes</p></td>\n   271â†’<td><p>Escapable Flag (Along with other flags)</p></td>\n   272â†’</tr>\n   273â†’<tr>\n   274â†’<td><p>0x0012</p></td>\n   275â†’<td><p>1 byte</p></td>\n   276â†’<td><p>Battle layout type (normal, ambush, side). 0-8 types.</p></td>\n   277â†’</tr>\n   278â†’<tr>\n   279â†’<td colspan=\"2\" rowspan=\"10\" style=\"text-align: center; background: rgb(104,104,155);\"></td>\n   280â†’<td></td>\n   281â†’</tr>\n   282â†’<tr>\n   283â†’<td><p>00 - Normal fight</p></td>\n   284â†’</tr>\n   285â†’<tr>\n   286â†’<td><p>01 - Preemptive</p></td>\n   287â†’</tr>\n   288â†’<tr>\n   289â†’<td><p>02 - Back attack</p></td>\n   290â†’</tr>\n   291â†’<tr>\n   292â†’<td><p>03 - Side attack</p></td>\n   293â†’</tr>\n   294â†’<tr>\n   295â†’<td><p>04 - Attacked from both sides (pincer attack, reverse side attack)</p></td>\n   296â†’</tr>\n   297â†’<tr>\n   298â†’<td><p>05 - Another attack from both sides battle (different maybe?)</p></td>\n   299â†’</tr>\n   300â†’<tr>\n   301â†’<td><p>06 - Another side attack</p></td>\n   302â†’</tr>\n   303â†’<tr>\n   304â†’<td><p>07 - A third side attack</p></td>\n   305â†’</tr>\n   306â†’<tr>\n   307â†’<td><p>08 - Normal battle that locks you in the front row, change command is disabled</p></td>\n   308â†’</tr>\n   309â†’<tr>\n   310â†’<td><p>0x0013</p></td>\n   311â†’<td><p>1 byte</p></td>\n   312â†’<td><p>Indexed Pre-Battle Camera position</p></td>\n   313â†’</tr>\n   314â†’</tbody>\n   315â†’</table>\n   316â†’\n   317â†’#### Camera Placement Data format {#camera_placement_data_format}\n   318â†’\n   319â†’48 bytes per Formation\n   320â†’\n   321â†’<table>\n   322â†’<thead>\n   323â†’<tr>\n   324â†’<th><p>Offset</p></th>\n   325â†’<th><p>Length</p></th>\n   326â†’<th><p>Description</p></th>\n   327â†’</tr>\n   328â†’</thead>\n   329â†’<tbody>\n   330â†’<tr>\n   331â†’<td><p>0x00</p></td>\n   332â†’<td><p>12 bytes</p></td>\n   333â†’<td><p>Primary Battle Idle Camera Position</p></td>\n   334â†’</tr>\n   335â†’<tr>\n   336â†’<td rowspan=\"7\" style=\"text-align: center; background: rgb(104,104,155);\"></td>\n   337â†’<td></td>\n   338â†’<td></td>\n   339â†’</tr>\n   340â†’<tr>\n   341â†’<td><p>0x0</p></td>\n   342â†’<td><p>Camera X Position</p></td>\n   343â†’</tr>\n   344â†’<tr>\n   345â†’<td><p>0x2</p></td>\n   346â†’<td><p>Camera Y Position</p></td>\n   347â†’</tr>\n   348â†’<tr>\n   349â†’<td><p>0x4</p></td>\n   350â†’<td><p>Camera Z Position</p></td>\n   351â†’</tr>\n   352â†’<tr>\n   353â†’<td><p>0x6</p></td>\n   354â†’<td><p>Camera X Direction</p></td>\n   355â†’</tr>\n   356â†’<tr>\n   357â†’<td><p>0x8</p></td>\n   358â†’<td><p>Camera Y Direction</p></td>\n   359â†’</tr>\n   360â†’<tr>\n   361â†’<td><p>0xA</p></td>\n   362â†’<td><p>Camera Z Direction</p></td>\n   363â†’</tr>\n   364â†’<tr>\n   365â†’<td><p>0x0C</p></td>\n   366â†’<td><p>2 * 12 bytes</p></td>\n   367â†’<td><p>Other Camera Positions in the above format referenced in enemies' animations.</p></td>\n   368â†’</tr>\n   369â†’<tr>\n   370â†’<td><p>0x24</p></td>\n   371â†’<td><p>12 bytes</p></td>\n   372â†’<td><p>Unused/Align 'FF'</p></td>\n   373â†’</tr>\n   374â†’</tbody>\n   375â†’</table>\n   376â†’\n   377â†’#### Battle Formation Data {#battle_formation_data}\n   378â†’\n   379â†’4 Possible battle formations per scene, maximum of 6 enemies per battle. Each enemy entry contains the following data:\n   380â†’\n   381â†’<table>\n   382â†’<thead>\n   383â†’<tr>\n   384â†’<th><p>Offset</p></th>\n   385â†’<th><p>Length</p></th>\n   386â†’<th colspan=\"2\" style=\"text-align: center; background: rgb(104,104,104);\"><p>Description</p></th>\n   387â†’</tr>\n   388â†’</thead>\n   389â†’<tbody>\n   390â†’<tr>\n   391â†’<td><p>0x00</p></td>\n   392â†’<td><p>2 bytes</p></td>\n   393â†’<td colspan=\"2\" style=\"text-align: center;\"><p>Enemy ID</p></td>\n   394â†’</tr>\n   395â†’<tr>\n   396â†’<td><p>0x02</p></td>\n   397â†’<td><p>2 bytes</p></td>\n   398â†’<td colspan=\"2\" style=\"text-align: center;\"><p>position X</p></td>\n   399â†’</tr>\n   400â†’<tr>\n   401â†’<td><p>0x04</p></td>\n   402â†’<td><p>2 bytes</p></td>\n   403â†’<td colspan=\"2\" style=\"text-align: center;\"><p>position Y</p></td>\n   404â†’</tr>\n   405â†’<tr>\n   406â†’<td><p>0x06</p></td>\n   407â†’<td><p>2 bytes</p></td>\n   408â†’<td colspan=\"2\" style=\"text-align: center;\"><p>position Z</p></td>\n   409â†’</tr>\n   410â†’<tr>\n   411â†’<td><p>0x08</p></td>\n   412â†’<td><p>2 bytes</p></td>\n   413â†’<td colspan=\"2\" style=\"text-align: center;\"><p>Row</p></td>\n   414â†’</tr>\n   415â†’<tr>\n   416â†’<td><p>0x0A</p></td>\n   417â†’<td><p>2 bytes</p></td>\n   418â†’<td colspan=\"2\" style=\"text-align: center;\"><p><a href=\"#Binary_.22Cover_Flags.22\" class=\"wikilink\" title=\"Binary &quot;Cover flags&quot;\">Binary \"Cover flags\"</a></p></td>\n   419â†’</tr>\n   420â†’<tr>\n   421â†’<td><p>0x0C</p></td>\n   422â†’<td><p>4 bytes</p></td>\n   423â†’<td colspan=\"2\" style=\"text-align: center;\"><p>Initial condition flags. Only last 5 bits are considered.</p></td>\n   424â†’</tr>\n   425â†’<tr>\n   426â†’<td colspan=\"2\" rowspan=\"5\" style=\"background: rgb(104,104,155)\"></td>\n   427â†’<td style=\"text-align: center;\"><p>0x0001</p></td>\n   428â†’<td style=\"text-align: center;\"><p>Visible</p></td>\n   429â†’</tr>\n   430â†’<tr>\n   431â†’<td style=\"text-align: center;\"><p>0x0002</p></td>\n   432â†’<td style=\"text-align: center;\"><p>Indicates initial direction facing if players get a side attack.</p></td>\n   433â†’</tr>\n   434â†’<tr>\n   435â†’<td style=\"text-align: center; background: rgb(155,155,104);\"><p>0x0004</p></td>\n   436â†’<td style=\"text-align: center; background: rgb(155,155,104);\"><p>Unknown</p></td>\n   437â†’</tr>\n   438â†’<tr>\n   439â†’<td style=\"text-align: center;\"><p>0x0008</p></td>\n   440â†’<td style=\"text-align: center;\"><p>Targetable</p></td>\n   441â†’</tr>\n   442â†’<tr>\n   443â†’<td style=\"text-align: center;\"><p>0x0010</p></td>\n   444â†’<td style=\"text-align: center;\"><p>Main Script Active</p></td>\n   445â†’</tr>\n   446â†’</tbody>\n   447â†’</table>\n   448â†’\n   449â†’#### Enemy data format {#enemy_data_format}\n   450â†’\n   451â†’<table>\n   452â†’<thead>\n   453â†’<tr>\n   454â†’<th><p>Offset</p></th>\n   455â†’<th><p>Length</p></th>\n   456â†’<th><p>Description</p></th>\n   457â†’</tr>\n   458â†’</thead>\n   459â†’<tbody>\n   460â†’<tr>\n   461â†’<td><p>0x0000</p></td>\n   462â†’<td><p>32 bytes</p></td>\n   463â†’<td><p>Enemy's name (completed by FFh bytes)</p></td>\n   464â†’</tr>\n   465â†’<tr>\n   466â†’<td><p>0x0020</p></td>\n   467â†’<td><p>1 byte</p></td>\n   468â†’<td><p>Enemy's level</p></td>\n   469â†’</tr>\n   470â†’<tr>\n   471â†’<td><p>0x0021</p></td>\n   472â†’<td><p>1 byte</p></td>\n   473â†’<td><p>Enemy's speed</p></td>\n   474â†’</tr>\n   475â†’<tr>\n   476â†’<td><p>0x0022</p></td>\n   477â†’<td><p>1 byte</p></td>\n   478â†’<td><p>Enemy's luck</p></td>\n   479â†’</tr>\n   480â†’<tr>\n   481â†’<td><p>0x0023</p></td>\n   482â†’<td><p>1 byte</p></td>\n   483â†’<td><p>Enemy's evade</p></td>\n   484â†’</tr>\n   485â†’<tr>\n   486â†’<td><p>0x0024</p></td>\n   487â†’<td><p>1 byte</p></td>\n   488â†’<td><p>Enemy's strength</p></td>\n   489â†’</tr>\n   490â†’<tr>\n   491â†’<td><p>0x0025</p></td>\n   492â†’<td><p>1 byte</p></td>\n   493â†’<td><p>Enemy's defense</p></td>\n   494â†’</tr>\n   495â†’<tr>\n   496â†’<td><p>0x0026</p></td>\n   497â†’<td><p>1 byte</p></td>\n   498â†’<td><p>Enemy's magic</p></td>\n   499â†’</tr>\n   500â†’<tr>\n   501â†’<td><p>0x0027</p></td>\n   502â†’<td><p>1 byte</p></td>\n   503â†’<td><p>Enemy's magic defense</p></td>\n   504â†’</tr>\n   505â†’<tr>\n   506â†’<td><p>0x0028</p></td>\n   507â†’<td><p>8 bytes</p></td>\n   508â†’<td><p>Element types (8 records):<br />\n   509â†’00h - Fire<br />\n   510â†’01h - Ice<br />\n   511â†’02h - Bolt<br />\n   512â†’03h - Earth<br />\n   513â†’04h - Bio<br />\n   514â†’05h - Gravity<br />\n   515â†’06h - Water<br />\n   516â†’07h - Wind<br />\n   517â†’08h - Holy<br />\n   518â†’09h - Health<br />\n   519â†’0Ah - Cut<br />\n   520â†’0Bh - Hit<br />\n   521â†’0Ch - Punch<br />\n   522â†’0Dh - Shoot<br />\n   523â†’0Eh - Scream<br />\n   524â†’0Fh - HIDDEN<br />\n   525â†’10h-1Fh - No Effect<br />\n   526â†’20h-3Fh - <a href=\"FF7/Battle/Status_Effects\" class=\"wikilink\" title=\"Statuses\">Statuses</a> (Damage done by actions that inflict these statuses will be modified)<br />\n   527â†’FFh - No element</p></td>\n   528â†’</tr>\n   529â†’<tr>\n   530â†’<td><p>0x0030</p></td>\n   531â†’<td><p>8 bytes</p></td>\n   532â†’<td><p>Element rates for elements above, respectively (8 records):<br />\n   533â†’00h - Death<br />\n   534â†’02h - Double Damage<br />\n   535â†’04h - Half Damage<br />\n   536â†’05h - Nullify Damage<br />\n   537â†’06h - Absorb 100%<br />\n   538â†’07h - Full Cure<br />\n   539â†’FFh - Nothing</p></td>\n   540â†’</tr>\n   541â†’<tr>\n   542â†’<td><p>0x0038</p></td>\n   543â†’<td><p>16 bytes</p></td>\n   544â†’<td><p>Action animation index (1 byte each).</p></td>\n   545â†’</tr>\n   546â†’<tr>\n   547â†’<td><p>0x0048</p></td>\n   548â†’<td><p>32 bytes</p></td>\n   549â†’<td><p>Enemy Attack ID's (2 bytes each).</p></td>\n   550â†’</tr>\n   551â†’<tr>\n   552â†’<td><p>0x0068</p></td>\n   553â†’<td><p>32 bytes</p></td>\n   554â†’<td><p>Enemy Attacks <a href=\"FF7/Battle/Camera_Movement_Id_List\" class=\"wikilink\" title=\"Camera Movement Id\">Camera Movement Id</a> for single and multiple targets (2 bytes each). If set this will overwrite camera movement set in attack itself.</p></td>\n   555â†’</tr>\n   556â†’<tr>\n   557â†’<td><p>0x0088</p></td>\n   558â†’<td><p>4 bytes</p></td>\n   559â†’<td><p>Item drop/steal rates.<br />\n   560â†’These are chances to get items listed in next section. 1 byte per item. If the rate is lower than 80h, for e.g. 08h - then this is a drop item and has 8/63 [63 is max] chance for drop. But if rate is higher than 80h, let's say... A0h, then this is an item for steal, and chances for successful steal is A0h - 80h = 20h = 32/63.</p></td>\n   561â†’</tr>\n   562â†’<tr>\n   563â†’<td><p>0x008C</p></td>\n   564â†’<td><p>8 bytes</p></td>\n   565â†’<td><p>This is a list of Item ID's which are described above. 2 bytes per item. FFFFh means no item.</p></td>\n   566â†’</tr>\n   567â†’<tr>\n   568â†’<td><p>0x0094</p></td>\n   569â†’<td><p>6 bytes</p></td>\n   570â†’<td><p>Indexes of up to three attacks (2 bytes each) that enemy can perform while manipulated or berserked</p></td>\n   571â†’</tr>\n   572â†’<tr>\n   573â†’<td style=\"background: rgb(155,155,104)\"><p>0x009A</p></td>\n   574â†’<td style=\"background: rgb(155,155,104)\"><p>2 bytes</p></td>\n   575â†’<td style=\"background: rgb(155,155,104)\"><p>Unknown data</p></td>\n   576â†’</tr>\n   577â†’<tr>\n   578â†’<td><p>0x009C</p></td>\n   579â†’<td><p>2 bytes</p></td>\n   580â†’<td><p>Enemy's MP</p></td>\n   581â†’</tr>\n   582â†’<tr>\n   583â†’<td><p>0x009E</p></td>\n   584â†’<td><p>2 bytes</p></td>\n   585â†’<td><p>AP points you receive when you win the battle</p></td>\n   586â†’</tr>\n   587â†’<tr>\n   588â†’<td><p>0x00A0</p></td>\n   589â†’<td><p>2 bytes</p></td>\n   590â†’<td><p>Enemy can be morphed into this item. FFFFh if it can't be morphed into anything.</p></td>\n   591â†’</tr>\n   592â†’<tr>\n   593â†’<td><p>0x00A2</p></td>\n   594â†’<td><p>1 byte</p></td>\n   595â†’<td><p>Multiplier for back damage. damage = damage * 0xXX / 8.</p></td>\n   596â†’</tr>\n   597â†’<tr>\n   598â†’<td><p>0x00A3</p></td>\n   599â†’<td><p>1 byte</p></td>\n   600â†’<td><p>align 0xff.</p></td>\n   601â†’</tr>\n   602â†’<tr>\n   603â†’<td><p>0x00A4</p></td>\n   604â†’<td><p>4 bytes</p></td>\n   605â†’<td><p>Enemy's HP</p></td>\n   606â†’</tr>\n   607â†’<tr>\n   608â†’<td><p>0x00A8</p></td>\n   609â†’<td><p>4 bytes</p></td>\n   610â†’<td><p>Exp points you receive when you win the battle</p></td>\n   611â†’</tr>\n   612â†’<tr>\n   613â†’<td><p>0x00AC</p></td>\n   614â†’<td><p>4 bytes</p></td>\n   615â†’<td><p>Gil you receive when you win the battle</p></td>\n   616â†’</tr>\n   617â†’<tr>\n   618â†’<td><p>0x00B0</p></td>\n   619â†’<td><p>4 bytes</p></td>\n   620â†’<td><p>Status immunities</p></td>\n   621â†’</tr>\n   622â†’<tr>\n   623â†’<td style=\"background: rgb(155,155,104)\"><p>0x00B4</p></td>\n   624â†’<td style=\"background: rgb(155,155,104)\"><p>4 bytes</p></td>\n   625â†’<td style=\"background: rgb(155,155,104)\"><p>Unknown [Always FFFFFFFFh]</p></td>\n   626â†’</tr>\n   627â†’</tbody>\n   628â†’</table>\n   629â†’\n   630â†’#### Formation ID {#formation_id}\n   631â†’\n   632â†’Formation ID is an index to a formation within a given scene. It is the scene index bit shifted 2 to the left plus formation index within the scene.\n   633â†’\n   634â†’`0Â 1Â 2Â 3Â 4Â 5Â 6Â 7Â 8Â 9Â AÂ BÂ CÂ DÂ EÂ F`\\\n   635â†’`[Â -Â -Â -Â -Â -Â -Â -Â -Â -Â -Â -Â -Â ]Â [Â ]`\\\n   636â†’`Â Â Â Â Â Â Â Â sceneÂ indexÂ Â Â Â Â Â Â Â Â formationÂ index`\n   637â†’\n   638â†’For this reason, the Formation ID will not exceed 03FFh.\n   639â†’\n   640â†’example: Formation 028Dh bit shift two to the right to get scene\n   641â†’\n   642â†’`028DÂ >>Â 2Â =Â 00A3Â (right-mostÂ bitsÂ areÂ truncated)`\n   643â†’\n   644â†’This is Scene 163 Formation Index is just the ID ANDed with 3.\n   645â†’\n   646â†’`028DÂ ANDÂ 3Â =Â 01`\n   647â†’\n   648â†’Formation 1 So this is Formation 1 in scene 163. (SOLDIER:3rd x2)\n   649â†’\n   650â†’#### AI Data {#ai_data}\n   651â†’\n   652â†’This section contains Battle Script that is executed before or/and during every fight. Every enemy has it\\'s own script, and this script is divided to a number of sections. Each script starts with 32 bytes of header that are divided into 16 parts representing 16 script types. The 2-byte number in any section is an offset relative to the beginning of this 32 byte block that tells the script reader where the script starts for that script type.\n   653â†’\n   654â†’| Offset | Script Type      |\n   655â†’|--------|------------------|\n   656â†’| 0x00   | Initialize       |\n   657â†’| 0x02   | Main             |\n   658â†’| 0x04   | General Counter  |\n   659â†’| 0x06   | Death Counter    |\n   660â†’| 0x08   | Physical Counter |\n   661â†’| 0x0A   | Magical Counter  |\n   662â†’| 0x0C   | Battle End       |\n   663â†’| 0x0E   | Pre-Action Setup |\n   664â†’| 0x10   | Custom Event 1   |\n   665â†’| 0x12   | Custom Event 2   |\n   666â†’| 0x14   | Custom Event 3   |\n   667â†’| 0x16   | Custom Event 4   |\n   668â†’| 0x18   | Custom Event 5   |\n   669â†’| 0x1A   | Custom Event 6   |\n   670â†’| 0x1C   | Custom Event 7   |\n   671â†’| 0x1E   | Custom Event 8   |\n   672â†’\n   673â†’Its structure and opcodes are described [here](FF7/Battle/Battle_Scenes/Battle_Script \"here\"){.wikilink}.\n   674â†’\n   675â†’NOTES:\n   676â†’\n   677â†’- A monster\\'s total AI size will always be an even number of bytes. If the actual scripts are an odd number, a single NULL (FFh) will be placed before the next monster\\'s AI header (may not be required).\n   678â†’- Battle begins after all characters\\' Initialize scripts have been run (Players first, then enemies, then formation).\n   679â†’- The only character with \\\"Battle End\\\" is in Cloud\\'s AI. It\\'s meant to lower the character\\'s Love Points with him if he lets them die or he dies with them in the party (not sure which).\n   680â†’- Pre-Action Event occurs on all battle participants prior to any actions performed by any participant regardless of actor or target. This includes all executed 92 commands that have a command index of less than 21h. If any 92 commands are called in this section, the command that caused this script to run has priority.\n   681â†’- The Custom Event sections are not called by any event. They only occur if they are called with the 92 command.\n   682â†’\n   683â†’`60Â 22Â <-Â commandÂ indexÂ \"RunÂ script\"`\\\n   684â†’`60Â 0XÂ <-Â whereÂ XÂ isÂ theÂ scriptÂ sectionÂ inÂ hexÂ (eg.Â XÂ =Â 8Â wouldÂ callÂ CustomÂ EventÂ 1Â sinceÂ itÂ isÂ scriptÂ idÂ 08`\\\n   685â†’`Â Â Â Â Â Â Â Â Â [notÂ toÂ beÂ confusedÂ withÂ offset])`\\\n   686â†’`92`\n   687â†’\n   688â†’- Custom Event 8 is only used on Mystery Ninja (all), Ultimate Weapons in location other than above Cosmo Canyon, Safer Sephiroth, and the final \\\"showdown\\\" between Cloud and Sephiroth. These characters have scripts on them that do not remove them from battle when they are defeated.\n   689â†’- Custom Events 1-7 may not work. (not thoroughly tested)\n   690â†’- The order of scripts executed:\n   691â†’\n   692â†’:   :\\* Beginning of battle\n   693â†’\n   694â†’    :   Pre-Battle (all participants)\n   695â†’\n   696â†’    - Once a \\\"main-script enabled\\\" enemy\\'s time gauge is full:\n   697â†’\n   698â†’    :   Main (Enemy performs action)\n   699â†’\n   700â†’    - Pre-Attack (If enemy script uses a 92 command with a command index of 20h or less)\n   701â†’\n   702â†’    :   Pre-Action Setup (occurs on all participants)\n   703â†’\n   704â†’    - Post-Attack\n   705â†’      1.  Death Counter (If script owner died, execution stops here)\n   706â†’      2.  General Counter (Executed by all targets)\n   707â†’      3.  Physical Counter/Magical Counter (Executed by all targets depending on damage type)\n   708â†’    - Battle ends\n   709â†’\n   710â†’    :   Battle End (all participants)\n   711â†’\n   712â†’#### Binary \\\"Cover Flags\\\" {#binary_cover_flags}\n   713â†’\n   714â†’These flags are used in conjunction with row to determine if a target can be selected as the target of a **short-range attack**. The determination of this is worked out in this way: An enemy exists in row 1 and another in row 2. If the enemy in row 1 shares a cover flag with the enemy in row 2 then the enemy in row 2 cannot be targeted until all enemies in row 1 that share a cover flag with the row 2 enemy is defeated. It works like this. Two active enemies exist, A and B.\n   715â†’\n   716â†’`IfÂ ((B'sÂ rowÂ >Â A'sÂ row)Â andÂ (B'sÂ coverÂ flagsÂ ANDÂ A'sÂ coverÂ flags)Â >Â 0)Â thenÂ enemyÂ BÂ cannotÂ beÂ targetedÂ byÂ short-rangeÂ attacks.`\n   717â†’\n   718â†’for any enemies A and B.\\\n   719â†’Example:\\\n   720â†’Consider the Battery Cap x6 battle in the forest between Nibelheim and Rocket Town. Their cover flags (in binary) are:\n   721â†’\n   722â†’`RowÂ 1:Â Â Â Â Â Â Â 00100`\\\n   723â†’`RowÂ 2:Â Â Â Â 00110Â 01100`\\\n   724â†’`RowÂ 3:Â 00011Â 00100Â 11000`\n   725â†’\n   726â†’The battery caps in row 2 cannot be targeted by a short-range attack until the one in row 1 has been defeated because they share the 0x4 cover flag. Once row 1 has been cleared:\n   727â†’\n   728â†’`RowÂ 2:Â Â Â Â 00110Â 01100`\\\n   729â†’`RowÂ 3:Â 00011Â 00100Â 11000`\n   730â†’\n   731â†’The battery cap on left in row 2 covers the left two in row 3 because it shares flag 0x4 with the one in the middle and flag 0x2 with the one on the far left. As long as it is active these in row 3 cannot be targeted. Similarly, the battery cap on the right in row 2 shares the 0x4 flag with the middle of row 3 and the 0x8 flag with the far right of row 3 so these cannot be targeted until the right side of row 2 is defeated.\\\n   732â†’It is also necessary to note that because row 1 does not share any flags with the extreme right and left of row 3, they can be targeted if the corresponding enemy in row 2 is defeated even if the row 1 enemy is still active.\\\n   733â†’Also of note is that enemies in the same row that share cover flags are not considered.\\\n   734â†’Only the first five bits may be considered even though the value is stored as a word.\\\n   735â†’\n   736â†’## Useful downloads {#useful_downloads}\n   737â†’\n   738â†’There are few programs written that will help you edit scene.bin file:\n   739â†’\n   740â†’- [Scene Reader](http://spinningcone.com/ff/stormmedia/projects/SceneReader.zip)\n   741â†’- [SceneEdit](http://www.subfan.pl/mav/SceneEdit.zip)\n   742â†’- [Scenester](http://aaronserv.dyndns.org/hosting/qhimmwiki/ramza_scenester_0.5.zip)\n   743â†’- [Proud Clod](http://forums.qhimm.com/index.php?topic=8481.0)\n   744â†’\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"parent_tool_use_id":null,"session_id":"5a116cbc-6614-4e79-9389-b85994640c4f","uuid":"a8f92854-bd2e-4a53-8918-242bf35b0e17","tool_use_result":{"type":"text","file":{"filePath":"/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/markdown/merged_with_pdf_content/FF7_Battle_Battle_Scenes.md","content":"<!--\nMERGE METADATA\nCreated: 2025-11-28\nOriginal: FF7_Battle_Battle_Scenes.md (728 lines)\nMajor section: 06_BATTLE_MODULE.md\nMerge decision: NO EXTRACTION PERFORMED\nReason: Individual file contains SUPERIOR documentation to major section\nKey differences:\n  - Individual file: Modern HTML table format with detailed specifications\n  - Major section: Older text-based documentation (Fremen format, Sept 2003)\n  - Individual file includes CRITICAL Japanese format note (16-byte vs 32-byte names)\n  - Major section lacks Japanese variant documentation\nRecommendation: Preserve individual file as-is (source of truth)\nReport: comparisons/FF7_Battle_Battle_Scenes_vs_06_BATTLE_MODULE_analysis.md\n-->\n# FF7/Battle/Battle Scenes {#ff7battlebattle_scenes}\n\n- [FF7/Battle/Battle Scenes](#ff7battlebattle_scenes){#toc-ff7battlebattle_scenes}\n  - [Introduction](#introduction){#toc-introduction}\n  - [Scene.Bin file format](#scene.bin_file_format){#toc-scene.bin_file_format}\n\n\n## Introduction\n\nFF7 keeps each enemy battle configuration is a file called \\\"scene.bin\\\" This file is located in the following directories.\n\n|      PSX Version       |    PC Version     |\n|:----------------------:|:-----------------:|\n| /DATA/BATTLE/SCENE.BIN | /BATTLE/SCENE.BIN |\n\nThis file is exactly the same in both versions. This holds all the battle configurations for all enemies encountered in the game.\n\n## Scene.Bin file format {#scene.bin_file_format}\n\n### Overview\n\nThe scene.bin file contains 256 gziped files which give us information for all the FF7 monsters. In order to find these files in scene.bin, you have to know that the file is structured with blocks exactly 0x2000 bytes in length. In the first table (scene.bin block), you will see what contains a block. Blocks are concatenated with each other to form the scene.bin file. So if you want to extract data from scene.bin, you\\'ll need to find the correct blocks and to extract the gziped files from it. After that you simply ungzip those files and you\\'ll find 256 files, with a length is 7808 bytes. Known information about those files can be found in the second table (The Data File specification). Because extracting file manually would be a pain, several tools was developed in order to help you. You can use [Scene Reader](http://spinningcone.com/ff/stormmedia/projects/SceneReader.zip) for example, it\\'s a win32 tool to extract and repack scene.bin archive.\n\nAlso note, that in [kernel.bin](FF7/Kernel/Kernel.bin \"kernel.bin\"){.wikilink} there is a look-up table for scene.bin, which tells how many files there are in each section of scene.bin. You need to update it every time you repack the file and something changes. The table is at offset 0x0F1C of the third section of the kernel.bin file. You can use [SceneFix](http://forums.qhimm.com/index.php?topic=7127.0) program, which\\'ll update the table for you.\n\nWe have 1024 possible battle numbers: 0 - 1023. Each group of \\*4\\* Battle Numbers refers to a particular Scene file: for instance, Battles 0-3 refer to File 0 in Scene.bin, Battles 4-7 refer to File 1 in Scene.bin, and so forth.\n\n\\\n\n#### Japanese format {#japanese_format}\n\nIn the japanese scene.bin, ennemies names and attacks names have a size of 16 bytes, instead of 32 bytes.\n\n\\\n\n### General file format {#general_file_format}\n\n<table>\n<thead>\n<tr>\n<th><p>Offset</p></th>\n<th><p>Length</p></th>\n<th><p>Description</p></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><p>0x0000</p></td>\n<td><p>4 bytes</p></td>\n<td><p>Pointer to first data file. You must multiply it by 4 to get actual data file offset. If the pointer is equal to FFFFFFFFh then it means that the end of block has been reached.</p></td>\n</tr>\n<tr>\n<td><p>0x0004</p></td>\n<td><p>4 bytes</p></td>\n<td><p>Pointer to second data file. You must multiply it by 4 to get actual data file offset. If the pointer is equal to FFFFFFFFh then it means that the end of block has been reached.</p></td>\n</tr>\n<tr>\n<td colspan=\"3\" style=\"text-align: center;\"><p>...</p></td>\n</tr>\n<tr>\n<td><p>0x003C</p></td>\n<td><p>4 bytes</p></td>\n<td><p>Last pointer, usually it equal FFFFFFFFh.</p></td>\n</tr>\n<tr>\n<td><p>0x0040</p></td>\n<td><p>4 * (pointer2 - pointer1) bytes</p></td>\n<td><p>First data file in block. It's a gziped file.<br />\n<em>Note: Sometimes it may finish by 0xFF bytes, because its size must be multiple of 4.</em></p></td>\n</tr>\n<tr>\n<td><p>pointer2 * 4</p></td>\n<td><p>4 * (pointer3 - pointer2) bytes</p></td>\n<td><p>Second data file in block. It's a gziped file.<br />\n<em>Note: Sometimes it may finish by 0xFF bytes, because its size must be multiple of 4.</em></p></td>\n</tr>\n<tr>\n<td colspan=\"3\" style=\"text-align: center;\"><p>...</p></td>\n</tr>\n<tr>\n<td><p>lastpointer * 4</p></td>\n<td><p>4 * (2000h - lastpointer) bytes</p></td>\n<td><p>Last data file in block.<br />\n<em>Note: There are about 6 to 12 files in each block. Each block finishes by 0xFF bytes, because its length must be 2000h (8192d) bytes.</em></p></td>\n</tr>\n</tbody>\n</table>\n\n### Data file format {#data_file_format}\n\n| Offset | Length | Description |\n|----|----|----|\n| 0x0000 | 2 bytes | Enemy ID 1 |\n| 0x0002 | 2 bytes | Enemy ID 2 |\n| 0x0004 | 2 bytes | Enemy ID 3 |\n| 0x0006 | 2 bytes | Padding (always FFFFh) |\n| 0x0008 | 4 \\* 20 bytes | Battle Setup (4 records) ([format explanation](#Battle_Setup_1_format \"format explanation\"){.wikilink}) |\n| 0x0058 | 4 \\* 48 bytes | Camera Placement Data (4 records) ([format explanation](#Camera_Placement_Data_format \"format explanation\"){.wikilink}) |\n| 0x0118 | 6 \\* 16 bytes | Battle Formation 1 (6 records) ([format explanation](#Battle_Formation_Data \"format explanation\"){.wikilink}) |\n| 0x0178 | 6 \\* 16 bytes | Battle Formation 2 (6 records) |\n| 0x01E8 | 6 \\* 16 bytes | Battle Formation 3 (6 records) |\n| 0x0238 | 6 \\* 16 bytes | Battle Formation 4 (6 records) |\n| 0x0298 | 184 bytes | Enemy Data 1 ([format explanation](#Enemy_data_format \"format explanation\"){.wikilink}) |\n| 0x0350 | 184 bytes | Enemy Data 2 |\n| 0x0408 | 184 bytes | Enemy Data 3 |\n| 0x04C0 | 32 \\* 28 bytes | Attack Data (32 records) ([format explanation](FF7/Attack_data \"format explanation\"){.wikilink}) |\n| 0x0840 | 32 \\* 2 bytes | Attack IDs (32 records) |\n| 0x0880 | 32 \\* 32 bytes | Attack Names (32 records, [in FF Text format](FF7/FF_Text \"in FF Text format\"){.wikilink}) |\n| 0x0C80 | 2 bytes | Formation 1 AI Script Offset |\n| 0x0C82 | 2 bytes | Formation 2 AI Script Offset |\n| 0x0C84 | 2 bytes | Formation 3 AI Script Offset |\n| 0x0C86 | 2 bytes | Formation 4 AI Script Offset |\n| 0x0C88 | 0 - 504 bytes | Beginning of Formation AI Data ([format explanation](#AI_Data \"format explanation\"){.wikilink}) |\n| 0x0E80 | 2 bytes | Enemy 1 AI Offset |\n| 0x0E82 | 2 bytes | Enemy 2 AI Offset |\n| 0x0E84 | 2 bytes | Enemy 3 AI Offset |\n| 0x0E86 | 0 - 4090 bytes | Beginning of AI Data ([format explanation](#AI_Data \"format explanation\"){.wikilink}) |\n\n\\\n\n#### Battle Setup 1 format {#battle_setup_1_format}\n\n<table>\n<thead>\n<tr>\n<th><p>Offset</p></th>\n<th><p>Length</p></th>\n<th><p>Description</p></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><p>0x0000</p></td>\n<td><p>2 bytes</p></td>\n<td><p><strong>Battle location, as follows:</strong></p></td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"2\" style=\"text-align: center; background: rgb(104,104,155);\"></td>\n<td></td>\n</tr>\n<tr>\n<td><p>0000h : Blank<br />\n0001h : Bizarro Battle - Center<br />\n0002h : Grassland<br />\n0003h : Mt Nibel<br />\n0004h : Forest<br />\n0005h : Beach<br />\n0006h : Desert<br />\n0007h : Snow<br />\n0008h : Swamp<br />\n0009h : Sector 1 Train Station<br />\n000Ah : Reactor 1<br />\n000Bh : Reactor 1 Core<br />\n000Ch : Reactor 1 Entrance<br />\n000Dh : Sector 4 Subway<br />\n000Eh : Nibel Caves or AForest Caves<br />\n000Fh : Shinra HQ<br />\n0010h : Midgar Raid Subway<br />\n0011h : Hojo's Lab<br />\n0012h : Shinra Elevators<br />\n0013h : Shinra Roof<br />\n0014h : Midgar Highway<br />\n0015h : Wutai Pagoda<br />\n0016h : Church<br />\n0017h : Coral Valley<br />\n0018h : Midgar Slums<br />\n0019h : Sector 4 Corridors or Junon Path<br />\n001Ah : Sector 4 Gantries or Midgar Underground<br />\n001Bh : Sector 7 Support Pillar Stairway<br />\n001Ch : Sector 7 Support Pillar Top<br />\n001Dh : Sector 8<br />\n001Eh : Sewers<br />\n001Fh : Mythril Mines<br />\n0020h : Northern Crater - Floating Platforms<br />\n0021h : Corel Mountain Path<br />\n0022h : Junon Beach<br />\n0023h : Junon Cargo Ship<br />\n0024h : Corel Prison<br />\n0025h : Battle Square<br />\n0026h : Da Chao - Rapps Battle<br />\n0027h : Cid's Backyard<br />\n0028h : Final Descent to Sephiroth<br />\n0029h : Reactor 5 Entrance<br />\n002Ah : Temple of the Ancients - Escher Room<br />\n002Bh : Shinra Mansion<br />\n002Ch : Junon Airship Dock<br />\n002Dh : Whirlwind Maze<br />\n002Eh : Junon Underwater Reactor<br />\n002Fh : Gongaga Reactor<br />\n0030h : Gelnika<br />\n0031h : Train Graveyard<br />\n0032h : Great Glacier Ice Caves &amp; Gaea Cliffs - Inside<br />\n0033h : Sister Ray<br />\n0034h : Sister Ray Base<br />\n0035h : Forgotten City Altar<br />\n0036h : Northern Crater - Initial Descent<br />\n0037h : Northern Crater - Hatchery<br />\n0038h : Northern Crater - Water Area<br />\n0039h : Safer Battle<br />\n003Ah : Kalm Flashback - Dragon Battle<br />\n003Bh : Junon Underwater Pipe<br />\n003Ch : Blank<br />\n003Dh : Corel Railway - Canyon<br />\n003Eh : Whirlwind Maze - Crater<br />\n003Fh : Corel Railway - Rollercoaster<br />\n0040h : Wooden Bridge<br />\n0041h : Da Chao<br />\n0042h : Fort Condor<br />\n0043h : Dirt Wasteland<br />\n0044h : Bizarro Battle - Right Side<br />\n0045h : Bizarro Battle - Left Side<br />\n0046h : Jenova*SYNTHESIS Battle<br />\n0047h : Corel Train Battle<br />\n0048h : Cosmo Canyon<br />\n0049h : Caverns of the Gi<br />\n004Ah : Nibelheim Mansion Basement<br />\n004Bh : Temple of the Ancients - Demons Gate<br />\n004Ch : Temple of the Ancients - Mural Room<br />\n004Dh : Temple of the Ancients - Clock Passage<br />\n004Eh : Final Battle - Sephiroth<br />\n004Fh : Jungle<br />\n0050h : Ultimate Weapon - Battle on Highwind<br />\n0051h : Corel Reactor<br />\n0052h : Unused<br />\n0053h : Don Corneo's Mansion<br />\n0054h : Emerald Weapon Battle<br />\n0055h : Reactor 5<br />\n0056h : Shinra HQ - Escape<br />\n0057h : Ultimate Weapon - Gongaga Reactor<br />\n0058h : Corel Prison - Dyne Battle<br />\n0059h : Ultimate Weapon - Forest</p></td>\n</tr>\n<tr>\n<td><p>0x0002</p></td>\n<td><p>2 bytes</p></td>\n<td><p>Upon defeat of all opponents in current formation, begin battle with <a href=\"FF7/Battle/Battle_scenes#Formation_ID\" class=\"wikilink\" title=\"Formation ID\">Formation ID</a> without ending battle scene</p></td>\n</tr>\n<tr>\n<td><p>0x0004</p></td>\n<td><p>2 bytes</p></td>\n<td><p>Escape Counter</p></td>\n</tr>\n<tr>\n<td><p>0x0006</p></td>\n<td><p>2 bytes</p></td>\n<td><p>Unused/Align 'FF'</p></td>\n</tr>\n<tr>\n<td><p>0x0008</p></td>\n<td><p>4 * 2 bytes</p></td>\n<td><p><a href=\"FF7/Battle/Battle_scenes#Formation_ID\" class=\"wikilink\" title=\"Formation ID\">Formation ID</a> of candidates for next Battle Arena battle. (default of 03E7h)</p></td>\n</tr>\n<tr>\n<td><p>0x0010</p></td>\n<td><p>2 bytes</p></td>\n<td><p>Escapable Flag (Along with other flags)</p></td>\n</tr>\n<tr>\n<td><p>0x0012</p></td>\n<td><p>1 byte</p></td>\n<td><p>Battle layout type (normal, ambush, side). 0-8 types.</p></td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"10\" style=\"text-align: center; background: rgb(104,104,155);\"></td>\n<td></td>\n</tr>\n<tr>\n<td><p>00 - Normal fight</p></td>\n</tr>\n<tr>\n<td><p>01 - Preemptive</p></td>\n</tr>\n<tr>\n<td><p>02 - Back attack</p></td>\n</tr>\n<tr>\n<td><p>03 - Side attack</p></td>\n</tr>\n<tr>\n<td><p>04 - Attacked from both sides (pincer attack, reverse side attack)</p></td>\n</tr>\n<tr>\n<td><p>05 - Another attack from both sides battle (different maybe?)</p></td>\n</tr>\n<tr>\n<td><p>06 - Another side attack</p></td>\n</tr>\n<tr>\n<td><p>07 - A third side attack</p></td>\n</tr>\n<tr>\n<td><p>08 - Normal battle that locks you in the front row, change command is disabled</p></td>\n</tr>\n<tr>\n<td><p>0x0013</p></td>\n<td><p>1 byte</p></td>\n<td><p>Indexed Pre-Battle Camera position</p></td>\n</tr>\n</tbody>\n</table>\n\n#### Camera Placement Data format {#camera_placement_data_format}\n\n48 bytes per Formation\n\n<table>\n<thead>\n<tr>\n<th><p>Offset</p></th>\n<th><p>Length</p></th>\n<th><p>Description</p></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><p>0x00</p></td>\n<td><p>12 bytes</p></td>\n<td><p>Primary Battle Idle Camera Position</p></td>\n</tr>\n<tr>\n<td rowspan=\"7\" style=\"text-align: center; background: rgb(104,104,155);\"></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td><p>0x0</p></td>\n<td><p>Camera X Position</p></td>\n</tr>\n<tr>\n<td><p>0x2</p></td>\n<td><p>Camera Y Position</p></td>\n</tr>\n<tr>\n<td><p>0x4</p></td>\n<td><p>Camera Z Position</p></td>\n</tr>\n<tr>\n<td><p>0x6</p></td>\n<td><p>Camera X Direction</p></td>\n</tr>\n<tr>\n<td><p>0x8</p></td>\n<td><p>Camera Y Direction</p></td>\n</tr>\n<tr>\n<td><p>0xA</p></td>\n<td><p>Camera Z Direction</p></td>\n</tr>\n<tr>\n<td><p>0x0C</p></td>\n<td><p>2 * 12 bytes</p></td>\n<td><p>Other Camera Positions in the above format referenced in enemies' animations.</p></td>\n</tr>\n<tr>\n<td><p>0x24</p></td>\n<td><p>12 bytes</p></td>\n<td><p>Unused/Align 'FF'</p></td>\n</tr>\n</tbody>\n</table>\n\n#### Battle Formation Data {#battle_formation_data}\n\n4 Possible battle formations per scene, maximum of 6 enemies per battle. Each enemy entry contains the following data:\n\n<table>\n<thead>\n<tr>\n<th><p>Offset</p></th>\n<th><p>Length</p></th>\n<th colspan=\"2\" style=\"text-align: center; background: rgb(104,104,104);\"><p>Description</p></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><p>0x00</p></td>\n<td><p>2 bytes</p></td>\n<td colspan=\"2\" style=\"text-align: center;\"><p>Enemy ID</p></td>\n</tr>\n<tr>\n<td><p>0x02</p></td>\n<td><p>2 bytes</p></td>\n<td colspan=\"2\" style=\"text-align: center;\"><p>position X</p></td>\n</tr>\n<tr>\n<td><p>0x04</p></td>\n<td><p>2 bytes</p></td>\n<td colspan=\"2\" style=\"text-align: center;\"><p>position Y</p></td>\n</tr>\n<tr>\n<td><p>0x06</p></td>\n<td><p>2 bytes</p></td>\n<td colspan=\"2\" style=\"text-align: center;\"><p>position Z</p></td>\n</tr>\n<tr>\n<td><p>0x08</p></td>\n<td><p>2 bytes</p></td>\n<td colspan=\"2\" style=\"text-align: center;\"><p>Row</p></td>\n</tr>\n<tr>\n<td><p>0x0A</p></td>\n<td><p>2 bytes</p></td>\n<td colspan=\"2\" style=\"text-align: center;\"><p><a href=\"#Binary_.22Cover_Flags.22\" class=\"wikilink\" title=\"Binary &quot;Cover flags&quot;\">Binary \"Cover flags\"</a></p></td>\n</tr>\n<tr>\n<td><p>0x0C</p></td>\n<td><p>4 bytes</p></td>\n<td colspan=\"2\" style=\"text-align: center;\"><p>Initial condition flags. Only last 5 bits are considered.</p></td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"5\" style=\"background: rgb(104,104,155)\"></td>\n<td style=\"text-align: center;\"><p>0x0001</p></td>\n<td style=\"text-align: center;\"><p>Visible</p></td>\n</tr>\n<tr>\n<td style=\"text-align: center;\"><p>0x0002</p></td>\n<td style=\"text-align: center;\"><p>Indicates initial direction facing if players get a side attack.</p></td>\n</tr>\n<tr>\n<td style=\"text-align: center; background: rgb(155,155,104);\"><p>0x0004</p></td>\n<td style=\"text-align: center; background: rgb(155,155,104);\"><p>Unknown</p></td>\n</tr>\n<tr>\n<td style=\"text-align: center;\"><p>0x0008</p></td>\n<td style=\"text-align: center;\"><p>Targetable</p></td>\n</tr>\n<tr>\n<td style=\"text-align: center;\"><p>0x0010</p></td>\n<td style=\"text-align: center;\"><p>Main Script Active</p></td>\n</tr>\n</tbody>\n</table>\n\n#### Enemy data format {#enemy_data_format}\n\n<table>\n<thead>\n<tr>\n<th><p>Offset</p></th>\n<th><p>Length</p></th>\n<th><p>Description</p></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><p>0x0000</p></td>\n<td><p>32 bytes</p></td>\n<td><p>Enemy's name (completed by FFh bytes)</p></td>\n</tr>\n<tr>\n<td><p>0x0020</p></td>\n<td><p>1 byte</p></td>\n<td><p>Enemy's level</p></td>\n</tr>\n<tr>\n<td><p>0x0021</p></td>\n<td><p>1 byte</p></td>\n<td><p>Enemy's speed</p></td>\n</tr>\n<tr>\n<td><p>0x0022</p></td>\n<td><p>1 byte</p></td>\n<td><p>Enemy's luck</p></td>\n</tr>\n<tr>\n<td><p>0x0023</p></td>\n<td><p>1 byte</p></td>\n<td><p>Enemy's evade</p></td>\n</tr>\n<tr>\n<td><p>0x0024</p></td>\n<td><p>1 byte</p></td>\n<td><p>Enemy's strength</p></td>\n</tr>\n<tr>\n<td><p>0x0025</p></td>\n<td><p>1 byte</p></td>\n<td><p>Enemy's defense</p></td>\n</tr>\n<tr>\n<td><p>0x0026</p></td>\n<td><p>1 byte</p></td>\n<td><p>Enemy's magic</p></td>\n</tr>\n<tr>\n<td><p>0x0027</p></td>\n<td><p>1 byte</p></td>\n<td><p>Enemy's magic defense</p></td>\n</tr>\n<tr>\n<td><p>0x0028</p></td>\n<td><p>8 bytes</p></td>\n<td><p>Element types (8 records):<br />\n00h - Fire<br />\n01h - Ice<br />\n02h - Bolt<br />\n03h - Earth<br />\n04h - Bio<br />\n05h - Gravity<br />\n06h - Water<br />\n07h - Wind<br />\n08h - Holy<br />\n09h - Health<br />\n0Ah - Cut<br />\n0Bh - Hit<br />\n0Ch - Punch<br />\n0Dh - Shoot<br />\n0Eh - Scream<br />\n0Fh - HIDDEN<br />\n10h-1Fh - No Effect<br />\n20h-3Fh - <a href=\"FF7/Battle/Status_Effects\" class=\"wikilink\" title=\"Statuses\">Statuses</a> (Damage done by actions that inflict these statuses will be modified)<br />\nFFh - No element</p></td>\n</tr>\n<tr>\n<td><p>0x0030</p></td>\n<td><p>8 bytes</p></td>\n<td><p>Element rates for elements above, respectively (8 records):<br />\n00h - Death<br />\n02h - Double Damage<br />\n04h - Half Damage<br />\n05h - Nullify Damage<br />\n06h - Absorb 100%<br />\n07h - Full Cure<br />\nFFh - Nothing</p></td>\n</tr>\n<tr>\n<td><p>0x0038</p></td>\n<td><p>16 bytes</p></td>\n<td><p>Action animation index (1 byte each).</p></td>\n</tr>\n<tr>\n<td><p>0x0048</p></td>\n<td><p>32 bytes</p></td>\n<td><p>Enemy Attack ID's (2 bytes each).</p></td>\n</tr>\n<tr>\n<td><p>0x0068</p></td>\n<td><p>32 bytes</p></td>\n<td><p>Enemy Attacks <a href=\"FF7/Battle/Camera_Movement_Id_List\" class=\"wikilink\" title=\"Camera Movement Id\">Camera Movement Id</a> for single and multiple targets (2 bytes each). If set this will overwrite camera movement set in attack itself.</p></td>\n</tr>\n<tr>\n<td><p>0x0088</p></td>\n<td><p>4 bytes</p></td>\n<td><p>Item drop/steal rates.<br />\nThese are chances to get items listed in next section. 1 byte per item. If the rate is lower than 80h, for e.g. 08h - then this is a drop item and has 8/63 [63 is max] chance for drop. But if rate is higher than 80h, let's say... A0h, then this is an item for steal, and chances for successful steal is A0h - 80h = 20h = 32/63.</p></td>\n</tr>\n<tr>\n<td><p>0x008C</p></td>\n<td><p>8 bytes</p></td>\n<td><p>This is a list of Item ID's which are described above. 2 bytes per item. FFFFh means no item.</p></td>\n</tr>\n<tr>\n<td><p>0x0094</p></td>\n<td><p>6 bytes</p></td>\n<td><p>Indexes of up to three attacks (2 bytes each) that enemy can perform while manipulated or berserked</p></td>\n</tr>\n<tr>\n<td style=\"background: rgb(155,155,104)\"><p>0x009A</p></td>\n<td style=\"background: rgb(155,155,104)\"><p>2 bytes</p></td>\n<td style=\"background: rgb(155,155,104)\"><p>Unknown data</p></td>\n</tr>\n<tr>\n<td><p>0x009C</p></td>\n<td><p>2 bytes</p></td>\n<td><p>Enemy's MP</p></td>\n</tr>\n<tr>\n<td><p>0x009E</p></td>\n<td><p>2 bytes</p></td>\n<td><p>AP points you receive when you win the battle</p></td>\n</tr>\n<tr>\n<td><p>0x00A0</p></td>\n<td><p>2 bytes</p></td>\n<td><p>Enemy can be morphed into this item. FFFFh if it can't be morphed into anything.</p></td>\n</tr>\n<tr>\n<td><p>0x00A2</p></td>\n<td><p>1 byte</p></td>\n<td><p>Multiplier for back damage. damage = damage * 0xXX / 8.</p></td>\n</tr>\n<tr>\n<td><p>0x00A3</p></td>\n<td><p>1 byte</p></td>\n<td><p>align 0xff.</p></td>\n</tr>\n<tr>\n<td><p>0x00A4</p></td>\n<td><p>4 bytes</p></td>\n<td><p>Enemy's HP</p></td>\n</tr>\n<tr>\n<td><p>0x00A8</p></td>\n<td><p>4 bytes</p></td>\n<td><p>Exp points you receive when you win the battle</p></td>\n</tr>\n<tr>\n<td><p>0x00AC</p></td>\n<td><p>4 bytes</p></td>\n<td><p>Gil you receive when you win the battle</p></td>\n</tr>\n<tr>\n<td><p>0x00B0</p></td>\n<td><p>4 bytes</p></td>\n<td><p>Status immunities</p></td>\n</tr>\n<tr>\n<td style=\"background: rgb(155,155,104)\"><p>0x00B4</p></td>\n<td style=\"background: rgb(155,155,104)\"><p>4 bytes</p></td>\n<td style=\"background: rgb(155,155,104)\"><p>Unknown [Always FFFFFFFFh]</p></td>\n</tr>\n</tbody>\n</table>\n\n#### Formation ID {#formation_id}\n\nFormation ID is an index to a formation within a given scene. It is the scene index bit shifted 2 to the left plus formation index within the scene.\n\n`0Â 1Â 2Â 3Â 4Â 5Â 6Â 7Â 8Â 9Â AÂ BÂ CÂ DÂ EÂ F`\\\n`[Â -Â -Â -Â -Â -Â -Â -Â -Â -Â -Â -Â -Â ]Â [Â ]`\\\n`Â Â Â Â Â Â Â Â sceneÂ indexÂ Â Â Â Â Â Â Â Â formationÂ index`\n\nFor this reason, the Formation ID will not exceed 03FFh.\n\nexample: Formation 028Dh bit shift two to the right to get scene\n\n`028DÂ >>Â 2Â =Â 00A3Â (right-mostÂ bitsÂ areÂ truncated)`\n\nThis is Scene 163 Formation Index is just the ID ANDed with 3.\n\n`028DÂ ANDÂ 3Â =Â 01`\n\nFormation 1 So this is Formation 1 in scene 163. (SOLDIER:3rd x2)\n\n#### AI Data {#ai_data}\n\nThis section contains Battle Script that is executed before or/and during every fight. Every enemy has it\\'s own script, and this script is divided to a number of sections. Each script starts with 32 bytes of header that are divided into 16 parts representing 16 script types. The 2-byte number in any section is an offset relative to the beginning of this 32 byte block that tells the script reader where the script starts for that script type.\n\n| Offset | Script Type      |\n|--------|------------------|\n| 0x00   | Initialize       |\n| 0x02   | Main             |\n| 0x04   | General Counter  |\n| 0x06   | Death Counter    |\n| 0x08   | Physical Counter |\n| 0x0A   | Magical Counter  |\n| 0x0C   | Battle End       |\n| 0x0E   | Pre-Action Setup |\n| 0x10   | Custom Event 1   |\n| 0x12   | Custom Event 2   |\n| 0x14   | Custom Event 3   |\n| 0x16   | Custom Event 4   |\n| 0x18   | Custom Event 5   |\n| 0x1A   | Custom Event 6   |\n| 0x1C   | Custom Event 7   |\n| 0x1E   | Custom Event 8   |\n\nIts structure and opcodes are described [here](FF7/Battle/Battle_Scenes/Battle_Script \"here\"){.wikilink}.\n\nNOTES:\n\n- A monster\\'s total AI size will always be an even number of bytes. If the actual scripts are an odd number, a single NULL (FFh) will be placed before the next monster\\'s AI header (may not be required).\n- Battle begins after all characters\\' Initialize scripts have been run (Players first, then enemies, then formation).\n- The only character with \\\"Battle End\\\" is in Cloud\\'s AI. It\\'s meant to lower the character\\'s Love Points with him if he lets them die or he dies with them in the party (not sure which).\n- Pre-Action Event occurs on all battle participants prior to any actions performed by any participant regardless of actor or target. This includes all executed 92 commands that have a command index of less than 21h. If any 92 commands are called in this section, the command that caused this script to run has priority.\n- The Custom Event sections are not called by any event. They only occur if they are called with the 92 command.\n\n`60Â 22Â <-Â commandÂ indexÂ \"RunÂ script\"`\\\n`60Â 0XÂ <-Â whereÂ XÂ isÂ theÂ scriptÂ sectionÂ inÂ hexÂ (eg.Â XÂ =Â 8Â wouldÂ callÂ CustomÂ EventÂ 1Â sinceÂ itÂ isÂ scriptÂ idÂ 08`\\\n`Â Â Â Â Â Â Â Â Â [notÂ toÂ beÂ confusedÂ withÂ offset])`\\\n`92`\n\n- Custom Event 8 is only used on Mystery Ninja (all), Ultimate Weapons in location other than above Cosmo Canyon, Safer Sephiroth, and the final \\\"showdown\\\" between Cloud and Sephiroth. These characters have scripts on them that do not remove them from battle when they are defeated.\n- Custom Events 1-7 may not work. (not thoroughly tested)\n- The order of scripts executed:\n\n:   :\\* Beginning of battle\n\n    :   Pre-Battle (all participants)\n\n    - Once a \\\"main-script enabled\\\" enemy\\'s time gauge is full:\n\n    :   Main (Enemy performs action)\n\n    - Pre-Attack (If enemy script uses a 92 command with a command index of 20h or less)\n\n    :   Pre-Action Setup (occurs on all participants)\n\n    - Post-Attack\n      1.  Death Counter (If script owner died, execution stops here)\n      2.  General Counter (Executed by all targets)\n      3.  Physical Counter/Magical Counter (Executed by all targets depending on damage type)\n    - Battle ends\n\n    :   Battle End (all participants)\n\n#### Binary \\\"Cover Flags\\\" {#binary_cover_flags}\n\nThese flags are used in conjunction with row to determine if a target can be selected as the target of a **short-range attack**. The determination of this is worked out in this way: An enemy exists in row 1 and another in row 2. If the enemy in row 1 shares a cover flag with the enemy in row 2 then the enemy in row 2 cannot be targeted until all enemies in row 1 that share a cover flag with the row 2 enemy is defeated. It works like this. Two active enemies exist, A and B.\n\n`IfÂ ((B'sÂ rowÂ >Â A'sÂ row)Â andÂ (B'sÂ coverÂ flagsÂ ANDÂ A'sÂ coverÂ flags)Â >Â 0)Â thenÂ enemyÂ BÂ cannotÂ beÂ targetedÂ byÂ short-rangeÂ attacks.`\n\nfor any enemies A and B.\\\nExample:\\\nConsider the Battery Cap x6 battle in the forest between Nibelheim and Rocket Town. Their cover flags (in binary) are:\n\n`RowÂ 1:Â Â Â Â Â Â Â 00100`\\\n`RowÂ 2:Â Â Â Â 00110Â 01100`\\\n`RowÂ 3:Â 00011Â 00100Â 11000`\n\nThe battery caps in row 2 cannot be targeted by a short-range attack until the one in row 1 has been defeated because they share the 0x4 cover flag. Once row 1 has been cleared:\n\n`RowÂ 2:Â Â Â Â 00110Â 01100`\\\n`RowÂ 3:Â 00011Â 00100Â 11000`\n\nThe battery cap on left in row 2 covers the left two in row 3 because it shares flag 0x4 with the one in the middle and flag 0x2 with the one on the far left. As long as it is active these in row 3 cannot be targeted. Similarly, the battery cap on the right in row 2 shares the 0x4 flag with the middle of row 3 and the 0x8 flag with the far right of row 3 so these cannot be targeted until the right side of row 2 is defeated.\\\nIt is also necessary to note that because row 1 does not share any flags with the extreme right and left of row 3, they can be targeted if the corresponding enemy in row 2 is defeated even if the row 1 enemy is still active.\\\nAlso of note is that enemies in the same row that share cover flags are not considered.\\\nOnly the first five bits may be considered even though the value is stored as a word.\\\n\n## Useful downloads {#useful_downloads}\n\nThere are few programs written that will help you edit scene.bin file:\n\n- [Scene Reader](http://spinningcone.com/ff/stormmedia/projects/SceneReader.zip)\n- [SceneEdit](http://www.subfan.pl/mav/SceneEdit.zip)\n- [Scenester](http://aaronserv.dyndns.org/hosting/qhimmwiki/ramza_scenester_0.5.zip)\n- [Proud Clod](http://forums.qhimm.com/index.php?topic=8481.0)\n","numLines":744,"startLine":1,"totalLines":744}}},{"type":"assistant","message":{"model":"claude-opus-4-5-20251101","id":"msg_01VrT5To6EJKPxNRMtaysnbq","type":"message","role":"assistant","content":[{"type":"text","text":"Now I have a complete understanding of the source document. Let me also check what images exist in the images directory for potential cross-references:"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":0,"cache_creation_input_tokens":12720,"cache_read_input_tokens":65414,"cache_creation":{"ephemeral_5m_input_tokens":12720,"ephemeral_1h_input_tokens":0},"output_tokens":90,"service_tier":"standard"},"context_management":null},"parent_tool_use_id":null,"session_id":"5a116cbc-6614-4e79-9389-b85994640c4f","uuid":"f213710f-356e-488b-a475-7adeeea3051c"},{"type":"assistant","message":{"model":"claude-opus-4-5-20251101","id":"msg_01VrT5To6EJKPxNRMtaysnbq","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01PzDLfsRyovdafLcDLzcCbC","name":"Glob","input":{"pattern":"docs/reference/game_engine/images/*"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":0,"cache_creation_input_tokens":12720,"cache_read_input_tokens":65414,"cache_creation":{"ephemeral_5m_input_tokens":12720,"ephemeral_1h_input_tokens":0},"output_tokens":90,"service_tier":"standard"},"context_management":null},"parent_tool_use_id":null,"session_id":"5a116cbc-6614-4e79-9389-b85994640c4f","uuid":"14acffc7-4de8-4214-92ea-1caf3e66b0e4"},{"type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01PzDLfsRyovdafLcDLzcCbC","type":"tool_result","content":"/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Engine_parts.jpg\n/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Field_BackgroundVRAM.jpg\n/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Gears_img_3.jpg\n/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Gears_img_4.jpg\n/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Kernel_table.png\n/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Menu_Windowbin.jpg\n/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Menu_PC_Textures.jpg\n/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Menu_PCT_Annotated.jpg\n/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Menu_Begin.jpg\n/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Menu_Party.jpg\n/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Menu_Item.jpg\n/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Menu_Magic.jpg\n/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Menu_Equip.jpg\n/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Menu_Status.jpg\n/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Menu_Change.jpg\n/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Menu_Limit.jpg\n/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Menu_Config.jpg\n/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Menu_Form.jpg\n/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Menu_Save.jpg\n/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Menu_Name.jpg\n/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Menu_Shop.jpg\n/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/PSX_TIM_file_layout.png\n/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/PSX_TIM_file_clut.png\n/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/PSX_color_formats_16.png\n/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/PSX_TIM_file_image.png\n/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/PSX_color_formats_24.png\n/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/PSX_color_formats_8.png\n/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/PSX_color_formats_4.png"}]},"parent_tool_use_id":null,"session_id":"5a116cbc-6614-4e79-9389-b85994640c4f","uuid":"fa262f53-35a6-4c2c-8256-af9c978ea07b","tool_use_result":{"filenames":["/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Engine_parts.jpg","/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Field_BackgroundVRAM.jpg","/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Gears_img_3.jpg","/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Gears_img_4.jpg","/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Kernel_table.png","/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Menu_Windowbin.jpg","/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Menu_PC_Textures.jpg","/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Menu_PCT_Annotated.jpg","/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Menu_Begin.jpg","/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Menu_Party.jpg","/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Menu_Item.jpg","/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Menu_Magic.jpg","/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Menu_Equip.jpg","/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Menu_Status.jpg","/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Menu_Change.jpg","/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Menu_Limit.jpg","/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Menu_Config.jpg","/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Menu_Form.jpg","/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Menu_Save.jpg","/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Menu_Name.jpg","/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/Menu_Shop.jpg","/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/PSX_TIM_file_layout.png","/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/PSX_TIM_file_clut.png","/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/PSX_color_formats_16.png","/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/PSX_TIM_file_image.png","/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/PSX_color_formats_24.png","/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/PSX_color_formats_8.png","/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/images/PSX_color_formats_4.png"],"durationMs":165,"numFiles":28,"truncated":false}},{"type":"assistant","message":{"model":"claude-opus-4-5-20251101","id":"msg_01AE6MYqq99fGPWcrNHL8mi7","type":"message","role":"assistant","content":[{"type":"text","text":"Now I have all the information I need. Let me create the standardized document with all the required transformations:\n\n`â˜… Insight â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€`\n**Key Transformation Points:**\n1. The document has wiki-style link anchors like `{#ff7battlebattle_scenes}` that need to be removed from H1 (they're invalid markdown)\n2. Heading hierarchy is mostly correct (H1â†’H2â†’H3â†’H4) but the TOC at the top uses wiki-style links\n3. Several internal wiki-style links need conversion to standard markdown format\n4. HTML tables should be preserved (they're complex with rowspan/colspan)\n5. The document has critical Japanese format information that must be preserved\n`â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€`"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":0,"cache_creation_input_tokens":1285,"cache_read_input_tokens":78134,"cache_creation":{"ephemeral_5m_input_tokens":1285,"ephemeral_1h_input_tokens":0},"output_tokens":10821,"service_tier":"standard"},"context_management":null},"parent_tool_use_id":null,"session_id":"5a116cbc-6614-4e79-9389-b85994640c4f","uuid":"90a4d699-fc17-4a14-9374-7fb0fe2fc1de"},{"type":"assistant","message":{"model":"claude-opus-4-5-20251101","id":"msg_01AE6MYqq99fGPWcrNHL8mi7","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_018YTvvcT7pbqoAHKKaHxvSg","name":"Write","input":{"file_path":"/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/final/FF7_Battle_Battle_Scenes.md","content":"---\ntitle: \"FF7 Battle Scenes\"\nmodule: \"Battle\"\ncreated: \"2025-11-28 00:00 JST\"\nmodified: \"2025-12-01 23:10 JST\"\nsession_id: \"5a116cbc-6614-4e79-9389-b85994640c4f\"\nauthor: \"Generated by Claude Code Documentation Standardization Agent\"\nstatus: \"Complete\"\n\n# LLM-specific metadata (CRITICAL for routing)\nllm_summary: \"Documents the scene.bin file format containing all FF7 enemy battle configurations, including data structures for enemy stats, AI scripts, formations, and camera placement. LLMs should read this when parsing battle data, modifying enemy encounters, or understanding the battle scene file architecture.\"\nllm_tags: [\"scene-bin\", \"battle-data\", \"enemy-configuration\", \"ai-scripts\", \"formation-data\", \"gzip-archive\"]\nllm_primary_topics: [\"Scene.bin file structure\", \"Enemy data format\", \"Battle AI scripting\", \"Formation configuration\", \"Camera placement data\"]\nllm_related_docs: [\"FF7_Battle_Battle_Mechanics.md\", \"FF7_Battle_Battle_Scenes_Battle_Script.md\", \"FF7_Kernel_Kernelbin.md\", \"FF7_Battle_Damage_Formulas.md\"]\n\n# Backlinks (leave empty - populated in pass 2)\nreferenced_by: []\n---\n\n<!--\nSTANDARDIZATION METADATA\nOriginal: FF7_Battle_Battle_Scenes.md\nSource: merged_with_pdf_content/FF7_Battle_Battle_Scenes.md\nStandardized: 2025-12-01 23:10 JST\nSession-ID: 5a116cbc-6614-4e79-9389-b85994640c4f\nAgent: FF7 Documentation Standardization Agent v1.0\n\nPrevious Merge Metadata:\nMERGE METADATA\nCreated: 2025-11-28\nOriginal: FF7_Battle_Battle_Scenes.md (728 lines)\nMajor section: 06_BATTLE_MODULE.md\nMerge decision: NO EXTRACTION PERFORMED\nReason: Individual file contains SUPERIOR documentation to major section\nKey differences:\n  - Individual file: Modern HTML table format with detailed specifications\n  - Major section: Older text-based documentation (Fremen format, Sept 2003)\n  - Individual file includes CRITICAL Japanese format note (16-byte vs 32-byte names)\n  - Major section lacks Japanese variant documentation\nRecommendation: Preserve individual file as-is (source of truth)\nReport: comparisons/FF7_Battle_Battle_Scenes_vs_06_BATTLE_MODULE_analysis.md\n\nStandardization Changes Applied:\n- Added YAML frontmatter with LLM routing metadata\n- Removed wiki-style anchor syntax from H1 heading (e.g., {#ff7battlebattle_scenes})\n- Removed wiki-style TOC block (lines 18-20) - GitHub renders its own TOC\n- Converted wiki-style internal links to standard markdown format\n- Preserved all complex HTML tables (required for rowspan/colspan formatting)\n- Added language tags to code blocks\n- Standardized section anchor references\n\nLLM CONTEXT BLOCK (Read this first for routing decisions):\nThis document is the authoritative reference for FF7's scene.bin battle configuration file.\nIt contains complete specifications for: (1) the gzipped archive structure with 256 data files,\n(2) enemy data records including stats, elements, items, and AI offsets, (3) battle formation\npositioning and cover flag mechanics, (4) camera placement data, and (5) AI script type headers.\nCritical for Japanese localization: enemy and attack names are 16 bytes in Japanese vs 32 bytes\nin international versions. Cross-reference with FF7_Battle_Battle_Scenes_Battle_Script.md for\nAI opcode details.\n-->\n\n# FF7 Battle Scenes\n\n## Introduction\n\nFF7 keeps each enemy battle configuration is a file called \"scene.bin\" This file is located in the following directories.\n\n|      PSX Version       |    PC Version     |\n|:----------------------:|:-----------------:|\n| /DATA/BATTLE/SCENE.BIN | /BATTLE/SCENE.BIN |\n\nThis file is exactly the same in both versions. This holds all the battle configurations for all enemies encountered in the game.\n\n## Scene.Bin File Format\n\n### Overview\n\nThe scene.bin file contains 256 gziped files which give us information for all the FF7 monsters. In order to find these files in scene.bin, you have to know that the file is structured with blocks exactly 0x2000 bytes in length. In the first table (scene.bin block), you will see what contains a block. Blocks are concatenated with each other to form the scene.bin file. So if you want to extract data from scene.bin, you'll need to find the correct blocks and to extract the gziped files from it. After that you simply ungzip those files and you'll find 256 files, with a length is 7808 bytes. Known information about those files can be found in the second table (The Data File specification). Because extracting file manually would be a pain, several tools was developed in order to help you. You can use [Scene Reader](http://spinningcone.com/ff/stormmedia/projects/SceneReader.zip) for example, it's a win32 tool to extract and repack scene.bin archive.\n\nAlso note, that in [kernel.bin](FF7_Kernel_Kernelbin.md) there is a look-up table for scene.bin, which tells how many files there are in each section of scene.bin. You need to update it every time you repack the file and something changes. The table is at offset 0x0F1C of the third section of the kernel.bin file. You can use [SceneFix](http://forums.qhimm.com/index.php?topic=7127.0) program, which'll update the table for you.\n\nWe have 1024 possible battle numbers: 0 - 1023. Each group of *4* Battle Numbers refers to a particular Scene file: for instance, Battles 0-3 refer to File 0 in Scene.bin, Battles 4-7 refer to File 1 in Scene.bin, and so forth.\n\n#### Japanese Format\n\nIn the japanese scene.bin, ennemies names and attacks names have a size of 16 bytes, instead of 32 bytes.\n\n### General File Format\n\n<table>\n<thead>\n<tr>\n<th><p>Offset</p></th>\n<th><p>Length</p></th>\n<th><p>Description</p></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><p>0x0000</p></td>\n<td><p>4 bytes</p></td>\n<td><p>Pointer to first data file. You must multiply it by 4 to get actual data file offset. If the pointer is equal to FFFFFFFFh then it means that the end of block has been reached.</p></td>\n</tr>\n<tr>\n<td><p>0x0004</p></td>\n<td><p>4 bytes</p></td>\n<td><p>Pointer to second data file. You must multiply it by 4 to get actual data file offset. If the pointer is equal to FFFFFFFFh then it means that the end of block has been reached.</p></td>\n</tr>\n<tr>\n<td colspan=\"3\" style=\"text-align: center;\"><p>...</p></td>\n</tr>\n<tr>\n<td><p>0x003C</p></td>\n<td><p>4 bytes</p></td>\n<td><p>Last pointer, usually it equal FFFFFFFFh.</p></td>\n</tr>\n<tr>\n<td><p>0x0040</p></td>\n<td><p>4 * (pointer2 - pointer1) bytes</p></td>\n<td><p>First data file in block. It's a gziped file.<br />\n<em>Note: Sometimes it may finish by 0xFF bytes, because its size must be multiple of 4.</em></p></td>\n</tr>\n<tr>\n<td><p>pointer2 * 4</p></td>\n<td><p>4 * (pointer3 - pointer2) bytes</p></td>\n<td><p>Second data file in block. It's a gziped file.<br />\n<em>Note: Sometimes it may finish by 0xFF bytes, because its size must be multiple of 4.</em></p></td>\n</tr>\n<tr>\n<td colspan=\"3\" style=\"text-align: center;\"><p>...</p></td>\n</tr>\n<tr>\n<td><p>lastpointer * 4</p></td>\n<td><p>4 * (2000h - lastpointer) bytes</p></td>\n<td><p>Last data file in block.<br />\n<em>Note: There are about 6 to 12 files in each block. Each block finishes by 0xFF bytes, because its length must be 2000h (8192d) bytes.</em></p></td>\n</tr>\n</tbody>\n</table>\n\n### Data File Format\n\n| Offset | Length | Description |\n|----|----|----|\n| 0x0000 | 2 bytes | Enemy ID 1 |\n| 0x0002 | 2 bytes | Enemy ID 2 |\n| 0x0004 | 2 bytes | Enemy ID 3 |\n| 0x0006 | 2 bytes | Padding (always FFFFh) |\n| 0x0008 | 4 * 20 bytes | Battle Setup (4 records) ([format explanation](#battle-setup-1-format)) |\n| 0x0058 | 4 * 48 bytes | Camera Placement Data (4 records) ([format explanation](#camera-placement-data-format)) |\n| 0x0118 | 6 * 16 bytes | Battle Formation 1 (6 records) ([format explanation](#battle-formation-data)) |\n| 0x0178 | 6 * 16 bytes | Battle Formation 2 (6 records) |\n| 0x01E8 | 6 * 16 bytes | Battle Formation 3 (6 records) |\n| 0x0238 | 6 * 16 bytes | Battle Formation 4 (6 records) |\n| 0x0298 | 184 bytes | Enemy Data 1 ([format explanation](#enemy-data-format)) |\n| 0x0350 | 184 bytes | Enemy Data 2 |\n| 0x0408 | 184 bytes | Enemy Data 3 |\n| 0x04C0 | 32 * 28 bytes | Attack Data (32 records) ([format explanation](FF7_Battle_Damage_Formulas.md)) |\n| 0x0840 | 32 * 2 bytes | Attack IDs (32 records) |\n| 0x0880 | 32 * 32 bytes | Attack Names (32 records, in FF Text format) |\n| 0x0C80 | 2 bytes | Formation 1 AI Script Offset |\n| 0x0C82 | 2 bytes | Formation 2 AI Script Offset |\n| 0x0C84 | 2 bytes | Formation 3 AI Script Offset |\n| 0x0C86 | 2 bytes | Formation 4 AI Script Offset |\n| 0x0C88 | 0 - 504 bytes | Beginning of Formation AI Data ([format explanation](#ai-data)) |\n| 0x0E80 | 2 bytes | Enemy 1 AI Offset |\n| 0x0E82 | 2 bytes | Enemy 2 AI Offset |\n| 0x0E84 | 2 bytes | Enemy 3 AI Offset |\n| 0x0E86 | 0 - 4090 bytes | Beginning of AI Data ([format explanation](#ai-data)) |\n\n#### Battle Setup 1 Format\n\n<table>\n<thead>\n<tr>\n<th><p>Offset</p></th>\n<th><p>Length</p></th>\n<th><p>Description</p></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><p>0x0000</p></td>\n<td><p>2 bytes</p></td>\n<td><p><strong>Battle location, as follows:</strong></p></td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"2\" style=\"text-align: center; background: rgb(104,104,155);\"></td>\n<td></td>\n</tr>\n<tr>\n<td><p>0000h : Blank<br />\n0001h : Bizarro Battle - Center<br />\n0002h : Grassland<br />\n0003h : Mt Nibel<br />\n0004h : Forest<br />\n0005h : Beach<br />\n0006h : Desert<br />\n0007h : Snow<br />\n0008h : Swamp<br />\n0009h : Sector 1 Train Station<br />\n000Ah : Reactor 1<br />\n000Bh : Reactor 1 Core<br />\n000Ch : Reactor 1 Entrance<br />\n000Dh : Sector 4 Subway<br />\n000Eh : Nibel Caves or AForest Caves<br />\n000Fh : Shinra HQ<br />\n0010h : Midgar Raid Subway<br />\n0011h : Hojo's Lab<br />\n0012h : Shinra Elevators<br />\n0013h : Shinra Roof<br />\n0014h : Midgar Highway<br />\n0015h : Wutai Pagoda<br />\n0016h : Church<br />\n0017h : Coral Valley<br />\n0018h : Midgar Slums<br />\n0019h : Sector 4 Corridors or Junon Path<br />\n001Ah : Sector 4 Gantries or Midgar Underground<br />\n001Bh : Sector 7 Support Pillar Stairway<br />\n001Ch : Sector 7 Support Pillar Top<br />\n001Dh : Sector 8<br />\n001Eh : Sewers<br />\n001Fh : Mythril Mines<br />\n0020h : Northern Crater - Floating Platforms<br />\n0021h : Corel Mountain Path<br />\n0022h : Junon Beach<br />\n0023h : Junon Cargo Ship<br />\n0024h : Corel Prison<br />\n0025h : Battle Square<br />\n0026h : Da Chao - Rapps Battle<br />\n0027h : Cid's Backyard<br />\n0028h : Final Descent to Sephiroth<br />\n0029h : Reactor 5 Entrance<br />\n002Ah : Temple of the Ancients - Escher Room<br />\n002Bh : Shinra Mansion<br />\n002Ch : Junon Airship Dock<br />\n002Dh : Whirlwind Maze<br />\n002Eh : Junon Underwater Reactor<br />\n002Fh : Gongaga Reactor<br />\n0030h : Gelnika<br />\n0031h : Train Graveyard<br />\n0032h : Great Glacier Ice Caves &amp; Gaea Cliffs - Inside<br />\n0033h : Sister Ray<br />\n0034h : Sister Ray Base<br />\n0035h : Forgotten City Altar<br />\n0036h : Northern Crater - Initial Descent<br />\n0037h : Northern Crater - Hatchery<br />\n0038h : Northern Crater - Water Area<br />\n0039h : Safer Battle<br />\n003Ah : Kalm Flashback - Dragon Battle<br />\n003Bh : Junon Underwater Pipe<br />\n003Ch : Blank<br />\n003Dh : Corel Railway - Canyon<br />\n003Eh : Whirlwind Maze - Crater<br />\n003Fh : Corel Railway - Rollercoaster<br />\n0040h : Wooden Bridge<br />\n0041h : Da Chao<br />\n0042h : Fort Condor<br />\n0043h : Dirt Wasteland<br />\n0044h : Bizarro Battle - Right Side<br />\n0045h : Bizarro Battle - Left Side<br />\n0046h : Jenova*SYNTHESIS Battle<br />\n0047h : Corel Train Battle<br />\n0048h : Cosmo Canyon<br />\n0049h : Caverns of the Gi<br />\n004Ah : Nibelheim Mansion Basement<br />\n004Bh : Temple of the Ancients - Demons Gate<br />\n004Ch : Temple of the Ancients - Mural Room<br />\n004Dh : Temple of the Ancients - Clock Passage<br />\n004Eh : Final Battle - Sephiroth<br />\n004Fh : Jungle<br />\n0050h : Ultimate Weapon - Battle on Highwind<br />\n0051h : Corel Reactor<br />\n0052h : Unused<br />\n0053h : Don Corneo's Mansion<br />\n0054h : Emerald Weapon Battle<br />\n0055h : Reactor 5<br />\n0056h : Shinra HQ - Escape<br />\n0057h : Ultimate Weapon - Gongaga Reactor<br />\n0058h : Corel Prison - Dyne Battle<br />\n0059h : Ultimate Weapon - Forest</p></td>\n</tr>\n<tr>\n<td><p>0x0002</p></td>\n<td><p>2 bytes</p></td>\n<td><p>Upon defeat of all opponents in current formation, begin battle with <a href=\"#formation-id\">Formation ID</a> without ending battle scene</p></td>\n</tr>\n<tr>\n<td><p>0x0004</p></td>\n<td><p>2 bytes</p></td>\n<td><p>Escape Counter</p></td>\n</tr>\n<tr>\n<td><p>0x0006</p></td>\n<td><p>2 bytes</p></td>\n<td><p>Unused/Align 'FF'</p></td>\n</tr>\n<tr>\n<td><p>0x0008</p></td>\n<td><p>4 * 2 bytes</p></td>\n<td><p><a href=\"#formation-id\">Formation ID</a> of candidates for next Battle Arena battle. (default of 03E7h)</p></td>\n</tr>\n<tr>\n<td><p>0x0010</p></td>\n<td><p>2 bytes</p></td>\n<td><p>Escapable Flag (Along with other flags)</p></td>\n</tr>\n<tr>\n<td><p>0x0012</p></td>\n<td><p>1 byte</p></td>\n<td><p>Battle layout type (normal, ambush, side). 0-8 types.</p></td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"10\" style=\"text-align: center; background: rgb(104,104,155);\"></td>\n<td></td>\n</tr>\n<tr>\n<td><p>00 - Normal fight</p></td>\n</tr>\n<tr>\n<td><p>01 - Preemptive</p></td>\n</tr>\n<tr>\n<td><p>02 - Back attack</p></td>\n</tr>\n<tr>\n<td><p>03 - Side attack</p></td>\n</tr>\n<tr>\n<td><p>04 - Attacked from both sides (pincer attack, reverse side attack)</p></td>\n</tr>\n<tr>\n<td><p>05 - Another attack from both sides battle (different maybe?)</p></td>\n</tr>\n<tr>\n<td><p>06 - Another side attack</p></td>\n</tr>\n<tr>\n<td><p>07 - A third side attack</p></td>\n</tr>\n<tr>\n<td><p>08 - Normal battle that locks you in the front row, change command is disabled</p></td>\n</tr>\n<tr>\n<td><p>0x0013</p></td>\n<td><p>1 byte</p></td>\n<td><p>Indexed Pre-Battle Camera position</p></td>\n</tr>\n</tbody>\n</table>\n\n#### Camera Placement Data Format\n\n48 bytes per Formation\n\n<table>\n<thead>\n<tr>\n<th><p>Offset</p></th>\n<th><p>Length</p></th>\n<th><p>Description</p></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><p>0x00</p></td>\n<td><p>12 bytes</p></td>\n<td><p>Primary Battle Idle Camera Position</p></td>\n</tr>\n<tr>\n<td rowspan=\"7\" style=\"text-align: center; background: rgb(104,104,155);\"></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td><p>0x0</p></td>\n<td><p>Camera X Position</p></td>\n</tr>\n<tr>\n<td><p>0x2</p></td>\n<td><p>Camera Y Position</p></td>\n</tr>\n<tr>\n<td><p>0x4</p></td>\n<td><p>Camera Z Position</p></td>\n</tr>\n<tr>\n<td><p>0x6</p></td>\n<td><p>Camera X Direction</p></td>\n</tr>\n<tr>\n<td><p>0x8</p></td>\n<td><p>Camera Y Direction</p></td>\n</tr>\n<tr>\n<td><p>0xA</p></td>\n<td><p>Camera Z Direction</p></td>\n</tr>\n<tr>\n<td><p>0x0C</p></td>\n<td><p>2 * 12 bytes</p></td>\n<td><p>Other Camera Positions in the above format referenced in enemies' animations.</p></td>\n</tr>\n<tr>\n<td><p>0x24</p></td>\n<td><p>12 bytes</p></td>\n<td><p>Unused/Align 'FF'</p></td>\n</tr>\n</tbody>\n</table>\n\n#### Battle Formation Data\n\n4 Possible battle formations per scene, maximum of 6 enemies per battle. Each enemy entry contains the following data:\n\n<table>\n<thead>\n<tr>\n<th><p>Offset</p></th>\n<th><p>Length</p></th>\n<th colspan=\"2\" style=\"text-align: center; background: rgb(104,104,104);\"><p>Description</p></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><p>0x00</p></td>\n<td><p>2 bytes</p></td>\n<td colspan=\"2\" style=\"text-align: center;\"><p>Enemy ID</p></td>\n</tr>\n<tr>\n<td><p>0x02</p></td>\n<td><p>2 bytes</p></td>\n<td colspan=\"2\" style=\"text-align: center;\"><p>position X</p></td>\n</tr>\n<tr>\n<td><p>0x04</p></td>\n<td><p>2 bytes</p></td>\n<td colspan=\"2\" style=\"text-align: center;\"><p>position Y</p></td>\n</tr>\n<tr>\n<td><p>0x06</p></td>\n<td><p>2 bytes</p></td>\n<td colspan=\"2\" style=\"text-align: center;\"><p>position Z</p></td>\n</tr>\n<tr>\n<td><p>0x08</p></td>\n<td><p>2 bytes</p></td>\n<td colspan=\"2\" style=\"text-align: center;\"><p>Row</p></td>\n</tr>\n<tr>\n<td><p>0x0A</p></td>\n<td><p>2 bytes</p></td>\n<td colspan=\"2\" style=\"text-align: center;\"><p><a href=\"#binary-cover-flags\">Binary \"Cover flags\"</a></p></td>\n</tr>\n<tr>\n<td><p>0x0C</p></td>\n<td><p>4 bytes</p></td>\n<td colspan=\"2\" style=\"text-align: center;\"><p>Initial condition flags. Only last 5 bits are considered.</p></td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"5\" style=\"background: rgb(104,104,155)\"></td>\n<td style=\"text-align: center;\"><p>0x0001</p></td>\n<td style=\"text-align: center;\"><p>Visible</p></td>\n</tr>\n<tr>\n<td style=\"text-align: center;\"><p>0x0002</p></td>\n<td style=\"text-align: center;\"><p>Indicates initial direction facing if players get a side attack.</p></td>\n</tr>\n<tr>\n<td style=\"text-align: center; background: rgb(155,155,104);\"><p>0x0004</p></td>\n<td style=\"text-align: center; background: rgb(155,155,104);\"><p>Unknown</p></td>\n</tr>\n<tr>\n<td style=\"text-align: center;\"><p>0x0008</p></td>\n<td style=\"text-align: center;\"><p>Targetable</p></td>\n</tr>\n<tr>\n<td style=\"text-align: center;\"><p>0x0010</p></td>\n<td style=\"text-align: center;\"><p>Main Script Active</p></td>\n</tr>\n</tbody>\n</table>\n\n#### Enemy Data Format\n\n<table>\n<thead>\n<tr>\n<th><p>Offset</p></th>\n<th><p>Length</p></th>\n<th><p>Description</p></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><p>0x0000</p></td>\n<td><p>32 bytes</p></td>\n<td><p>Enemy's name (completed by FFh bytes)</p></td>\n</tr>\n<tr>\n<td><p>0x0020</p></td>\n<td><p>1 byte</p></td>\n<td><p>Enemy's level</p></td>\n</tr>\n<tr>\n<td><p>0x0021</p></td>\n<td><p>1 byte</p></td>\n<td><p>Enemy's speed</p></td>\n</tr>\n<tr>\n<td><p>0x0022</p></td>\n<td><p>1 byte</p></td>\n<td><p>Enemy's luck</p></td>\n</tr>\n<tr>\n<td><p>0x0023</p></td>\n<td><p>1 byte</p></td>\n<td><p>Enemy's evade</p></td>\n</tr>\n<tr>\n<td><p>0x0024</p></td>\n<td><p>1 byte</p></td>\n<td><p>Enemy's strength</p></td>\n</tr>\n<tr>\n<td><p>0x0025</p></td>\n<td><p>1 byte</p></td>\n<td><p>Enemy's defense</p></td>\n</tr>\n<tr>\n<td><p>0x0026</p></td>\n<td><p>1 byte</p></td>\n<td><p>Enemy's magic</p></td>\n</tr>\n<tr>\n<td><p>0x0027</p></td>\n<td><p>1 byte</p></td>\n<td><p>Enemy's magic defense</p></td>\n</tr>\n<tr>\n<td><p>0x0028</p></td>\n<td><p>8 bytes</p></td>\n<td><p>Element types (8 records):<br />\n00h - Fire<br />\n01h - Ice<br />\n02h - Bolt<br />\n03h - Earth<br />\n04h - Bio<br />\n05h - Gravity<br />\n06h - Water<br />\n07h - Wind<br />\n08h - Holy<br />\n09h - Health<br />\n0Ah - Cut<br />\n0Bh - Hit<br />\n0Ch - Punch<br />\n0Dh - Shoot<br />\n0Eh - Scream<br />\n0Fh - HIDDEN<br />\n10h-1Fh - No Effect<br />\n20h-3Fh - <a href=\"FF7_Battle_Battle_Mechanics.md#statuses\">Statuses</a> (Damage done by actions that inflict these statuses will be modified)<br />\nFFh - No element</p></td>\n</tr>\n<tr>\n<td><p>0x0030</p></td>\n<td><p>8 bytes</p></td>\n<td><p>Element rates for elements above, respectively (8 records):<br />\n00h - Death<br />\n02h - Double Damage<br />\n04h - Half Damage<br />\n05h - Nullify Damage<br />\n06h - Absorb 100%<br />\n07h - Full Cure<br />\nFFh - Nothing</p></td>\n</tr>\n<tr>\n<td><p>0x0038</p></td>\n<td><p>16 bytes</p></td>\n<td><p>Action animation index (1 byte each).</p></td>\n</tr>\n<tr>\n<td><p>0x0048</p></td>\n<td><p>32 bytes</p></td>\n<td><p>Enemy Attack ID's (2 bytes each).</p></td>\n</tr>\n<tr>\n<td><p>0x0068</p></td>\n<td><p>32 bytes</p></td>\n<td><p>Enemy Attacks Camera Movement Id for single and multiple targets (2 bytes each). If set this will overwrite camera movement set in attack itself.</p></td>\n</tr>\n<tr>\n<td><p>0x0088</p></td>\n<td><p>4 bytes</p></td>\n<td><p>Item drop/steal rates.<br />\nThese are chances to get items listed in next section. 1 byte per item. If the rate is lower than 80h, for e.g. 08h - then this is a drop item and has 8/63 [63 is max] chance for drop. But if rate is higher than 80h, let's say... A0h, then this is an item for steal, and chances for successful steal is A0h - 80h = 20h = 32/63.</p></td>\n</tr>\n<tr>\n<td><p>0x008C</p></td>\n<td><p>8 bytes</p></td>\n<td><p>This is a list of Item ID's which are described above. 2 bytes per item. FFFFh means no item.</p></td>\n</tr>\n<tr>\n<td><p>0x0094</p></td>\n<td><p>6 bytes</p></td>\n<td><p>Indexes of up to three attacks (2 bytes each) that enemy can perform while manipulated or berserked</p></td>\n</tr>\n<tr>\n<td style=\"background: rgb(155,155,104)\"><p>0x009A</p></td>\n<td style=\"background: rgb(155,155,104)\"><p>2 bytes</p></td>\n<td style=\"background: rgb(155,155,104)\"><p>Unknown data</p></td>\n</tr>\n<tr>\n<td><p>0x009C</p></td>\n<td><p>2 bytes</p></td>\n<td><p>Enemy's MP</p></td>\n</tr>\n<tr>\n<td><p>0x009E</p></td>\n<td><p>2 bytes</p></td>\n<td><p>AP points you receive when you win the battle</p></td>\n</tr>\n<tr>\n<td><p>0x00A0</p></td>\n<td><p>2 bytes</p></td>\n<td><p>Enemy can be morphed into this item. FFFFh if it can't be morphed into anything.</p></td>\n</tr>\n<tr>\n<td><p>0x00A2</p></td>\n<td><p>1 byte</p></td>\n<td><p>Multiplier for back damage. damage = damage * 0xXX / 8.</p></td>\n</tr>\n<tr>\n<td><p>0x00A3</p></td>\n<td><p>1 byte</p></td>\n<td><p>align 0xff.</p></td>\n</tr>\n<tr>\n<td><p>0x00A4</p></td>\n<td><p>4 bytes</p></td>\n<td><p>Enemy's HP</p></td>\n</tr>\n<tr>\n<td><p>0x00A8</p></td>\n<td><p>4 bytes</p></td>\n<td><p>Exp points you receive when you win the battle</p></td>\n</tr>\n<tr>\n<td><p>0x00AC</p></td>\n<td><p>4 bytes</p></td>\n<td><p>Gil you receive when you win the battle</p></td>\n</tr>\n<tr>\n<td><p>0x00B0</p></td>\n<td><p>4 bytes</p></td>\n<td><p>Status immunities</p></td>\n</tr>\n<tr>\n<td style=\"background: rgb(155,155,104)\"><p>0x00B4</p></td>\n<td style=\"background: rgb(155,155,104)\"><p>4 bytes</p></td>\n<td style=\"background: rgb(155,155,104)\"><p>Unknown [Always FFFFFFFFh]</p></td>\n</tr>\n</tbody>\n</table>\n\n#### Formation ID\n\nFormation ID is an index to a formation within a given scene. It is the scene index bit shifted 2 to the left plus formation index within the scene.\n\n```text\n0 1 2 3 4 5 6 7 8 9 A B C D E F\n[ - - - - - - - - - - - - ] [ ]\n        scene index         formation index\n```\n\nFor this reason, the Formation ID will not exceed 03FFh.\n\nexample: Formation 028Dh bit shift two to the right to get scene\n\n```text\n028D >> 2 = 00A3 (right-most bits are truncated)\n```\n\nThis is Scene 163 Formation Index is just the ID ANDed with 3.\n\n```text\n028D AND 3 = 01\n```\n\nFormation 1 So this is Formation 1 in scene 163. (SOLDIER:3rd x2)\n\n#### AI Data\n\nThis section contains Battle Script that is executed before or/and during every fight. Every enemy has it's own script, and this script is divided to a number of sections. Each script starts with 32 bytes of header that are divided into 16 parts representing 16 script types. The 2-byte number in any section is an offset relative to the beginning of this 32 byte block that tells the script reader where the script starts for that script type.\n\n| Offset | Script Type      |\n|--------|------------------|\n| 0x00   | Initialize       |\n| 0x02   | Main             |\n| 0x04   | General Counter  |\n| 0x06   | Death Counter    |\n| 0x08   | Physical Counter |\n| 0x0A   | Magical Counter  |\n| 0x0C   | Battle End       |\n| 0x0E   | Pre-Action Setup |\n| 0x10   | Custom Event 1   |\n| 0x12   | Custom Event 2   |\n| 0x14   | Custom Event 3   |\n| 0x16   | Custom Event 4   |\n| 0x18   | Custom Event 5   |\n| 0x1A   | Custom Event 6   |\n| 0x1C   | Custom Event 7   |\n| 0x1E   | Custom Event 8   |\n\nIts structure and opcodes are described in [Battle Script](FF7_Battle_Battle_Scenes_Battle_Script.md).\n\nNOTES:\n\n- A monster's total AI size will always be an even number of bytes. If the actual scripts are an odd number, a single NULL (FFh) will be placed before the next monster's AI header (may not be required).\n- Battle begins after all characters' Initialize scripts have been run (Players first, then enemies, then formation).\n- The only character with \"Battle End\" is in Cloud's AI. It's meant to lower the character's Love Points with him if he lets them die or he dies with them in the party (not sure which).\n- Pre-Action Event occurs on all battle participants prior to any actions performed by any participant regardless of actor or target. This includes all executed 92 commands that have a command index of less than 21h. If any 92 commands are called in this section, the command that caused this script to run has priority.\n- The Custom Event sections are not called by any event. They only occur if they are called with the 92 command.\n\n```text\n60 22 <- command index \"Run script\"\n60 0X <- where X is the script section in hex (eg. X = 8 would call Custom Event 1 since it is script id 08\n         [not to be confused with offset])\n92\n```\n\n- Custom Event 8 is only used on Mystery Ninja (all), Ultimate Weapons in location other than above Cosmo Canyon, Safer Sephiroth, and the final \"showdown\" between Cloud and Sephiroth. These characters have scripts on them that do not remove them from battle when they are defeated.\n- Custom Events 1-7 may not work. (not thoroughly tested)\n- The order of scripts executed:\n\n  - Beginning of battle\n    - Pre-Battle (all participants)\n  - Once a \"main-script enabled\" enemy's time gauge is full:\n    - Main (Enemy performs action)\n  - Pre-Attack (If enemy script uses a 92 command with a command index of 20h or less)\n    - Pre-Action Setup (occurs on all participants)\n  - Post-Attack\n    1. Death Counter (If script owner died, execution stops here)\n    2. General Counter (Executed by all targets)\n    3. Physical Counter/Magical Counter (Executed by all targets depending on damage type)\n  - Battle ends\n    - Battle End (all participants)\n\n#### Binary Cover Flags\n\nThese flags are used in conjunction with row to determine if a target can be selected as the target of a **short-range attack**. The determination of this is worked out in this way: An enemy exists in row 1 and another in row 2. If the enemy in row 1 shares a cover flag with the enemy in row 2 then the enemy in row 2 cannot be targeted until all enemies in row 1 that share a cover flag with the row 2 enemy is defeated. It works like this. Two active enemies exist, A and B.\n\n```text\nIf ((B's row > A's row) and (B's cover flags AND A's cover flags) > 0) then enemy B cannot be targeted by short-range attacks.\n```\n\nfor any enemies A and B.\n\nExample:\n\nConsider the Battery Cap x6 battle in the forest between Nibelheim and Rocket Town. Their cover flags (in binary) are:\n\n```text\nRow 1:       00100\nRow 2:    00110 01100\nRow 3: 00011 00100 11000\n```\n\nThe battery caps in row 2 cannot be targeted by a short-range attack until the one in row 1 has been defeated because they share the 0x4 cover flag. Once row 1 has been cleared:\n\n```text\nRow 2:    00110 01100\nRow 3: 00011 00100 11000\n```\n\nThe battery cap on left in row 2 covers the left two in row 3 because it shares flag 0x4 with the one in the middle and flag 0x2 with the one on the far left. As long as it is active these in row 3 cannot be targeted. Similarly, the battery cap on the right in row 2 shares the 0x4 flag with the middle of row 3 and the 0x8 flag with the far right of row 3 so these cannot be targeted until the right side of row 2 is defeated.\n\nIt is also necessary to note that because row 1 does not share any flags with the extreme right and left of row 3, they can be targeted if the corresponding enemy in row 2 is defeated even if the row 1 enemy is still active.\n\nAlso of note is that enemies in the same row that share cover flags are not considered.\n\nOnly the first five bits may be considered even though the value is stored as a word.\n\n## Useful Downloads\n\nThere are few programs written that will help you edit scene.bin file:\n\n- [Scene Reader](http://spinningcone.com/ff/stormmedia/projects/SceneReader.zip)\n- [SceneEdit](http://www.subfan.pl/mav/SceneEdit.zip)\n- [Scenester](http://aaronserv.dyndns.org/hosting/qhimmwiki/ramza_scenester_0.5.zip)\n- [Proud Clod](http://forums.qhimm.com/index.php?topic=8481.0)\n"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":0,"cache_creation_input_tokens":1285,"cache_read_input_tokens":78134,"cache_creation":{"ephemeral_5m_input_tokens":1285,"ephemeral_1h_input_tokens":0},"output_tokens":10821,"service_tier":"standard"},"context_management":null},"parent_tool_use_id":null,"session_id":"5a116cbc-6614-4e79-9389-b85994640c4f","uuid":"5c545fb9-b3d2-497b-a491-676de5c0e1f6"},{"type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_018YTvvcT7pbqoAHKKaHxvSg","type":"tool_result","content":"File created successfully at: /Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/final/FF7_Battle_Battle_Scenes.md"}]},"parent_tool_use_id":null,"session_id":"5a116cbc-6614-4e79-9389-b85994640c4f","uuid":"4d0a94fd-258c-4d49-90fa-674c74e62677","tool_use_result":{"type":"create","filePath":"/Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/final/FF7_Battle_Battle_Scenes.md","content":"---\ntitle: \"FF7 Battle Scenes\"\nmodule: \"Battle\"\ncreated: \"2025-11-28 00:00 JST\"\nmodified: \"2025-12-01 23:10 JST\"\nsession_id: \"5a116cbc-6614-4e79-9389-b85994640c4f\"\nauthor: \"Generated by Claude Code Documentation Standardization Agent\"\nstatus: \"Complete\"\n\n# LLM-specific metadata (CRITICAL for routing)\nllm_summary: \"Documents the scene.bin file format containing all FF7 enemy battle configurations, including data structures for enemy stats, AI scripts, formations, and camera placement. LLMs should read this when parsing battle data, modifying enemy encounters, or understanding the battle scene file architecture.\"\nllm_tags: [\"scene-bin\", \"battle-data\", \"enemy-configuration\", \"ai-scripts\", \"formation-data\", \"gzip-archive\"]\nllm_primary_topics: [\"Scene.bin file structure\", \"Enemy data format\", \"Battle AI scripting\", \"Formation configuration\", \"Camera placement data\"]\nllm_related_docs: [\"FF7_Battle_Battle_Mechanics.md\", \"FF7_Battle_Battle_Scenes_Battle_Script.md\", \"FF7_Kernel_Kernelbin.md\", \"FF7_Battle_Damage_Formulas.md\"]\n\n# Backlinks (leave empty - populated in pass 2)\nreferenced_by: []\n---\n\n<!--\nSTANDARDIZATION METADATA\nOriginal: FF7_Battle_Battle_Scenes.md\nSource: merged_with_pdf_content/FF7_Battle_Battle_Scenes.md\nStandardized: 2025-12-01 23:10 JST\nSession-ID: 5a116cbc-6614-4e79-9389-b85994640c4f\nAgent: FF7 Documentation Standardization Agent v1.0\n\nPrevious Merge Metadata:\nMERGE METADATA\nCreated: 2025-11-28\nOriginal: FF7_Battle_Battle_Scenes.md (728 lines)\nMajor section: 06_BATTLE_MODULE.md\nMerge decision: NO EXTRACTION PERFORMED\nReason: Individual file contains SUPERIOR documentation to major section\nKey differences:\n  - Individual file: Modern HTML table format with detailed specifications\n  - Major section: Older text-based documentation (Fremen format, Sept 2003)\n  - Individual file includes CRITICAL Japanese format note (16-byte vs 32-byte names)\n  - Major section lacks Japanese variant documentation\nRecommendation: Preserve individual file as-is (source of truth)\nReport: comparisons/FF7_Battle_Battle_Scenes_vs_06_BATTLE_MODULE_analysis.md\n\nStandardization Changes Applied:\n- Added YAML frontmatter with LLM routing metadata\n- Removed wiki-style anchor syntax from H1 heading (e.g., {#ff7battlebattle_scenes})\n- Removed wiki-style TOC block (lines 18-20) - GitHub renders its own TOC\n- Converted wiki-style internal links to standard markdown format\n- Preserved all complex HTML tables (required for rowspan/colspan formatting)\n- Added language tags to code blocks\n- Standardized section anchor references\n\nLLM CONTEXT BLOCK (Read this first for routing decisions):\nThis document is the authoritative reference for FF7's scene.bin battle configuration file.\nIt contains complete specifications for: (1) the gzipped archive structure with 256 data files,\n(2) enemy data records including stats, elements, items, and AI offsets, (3) battle formation\npositioning and cover flag mechanics, (4) camera placement data, and (5) AI script type headers.\nCritical for Japanese localization: enemy and attack names are 16 bytes in Japanese vs 32 bytes\nin international versions. Cross-reference with FF7_Battle_Battle_Scenes_Battle_Script.md for\nAI opcode details.\n-->\n\n# FF7 Battle Scenes\n\n## Introduction\n\nFF7 keeps each enemy battle configuration is a file called \"scene.bin\" This file is located in the following directories.\n\n|      PSX Version       |    PC Version     |\n|:----------------------:|:-----------------:|\n| /DATA/BATTLE/SCENE.BIN | /BATTLE/SCENE.BIN |\n\nThis file is exactly the same in both versions. This holds all the battle configurations for all enemies encountered in the game.\n\n## Scene.Bin File Format\n\n### Overview\n\nThe scene.bin file contains 256 gziped files which give us information for all the FF7 monsters. In order to find these files in scene.bin, you have to know that the file is structured with blocks exactly 0x2000 bytes in length. In the first table (scene.bin block), you will see what contains a block. Blocks are concatenated with each other to form the scene.bin file. So if you want to extract data from scene.bin, you'll need to find the correct blocks and to extract the gziped files from it. After that you simply ungzip those files and you'll find 256 files, with a length is 7808 bytes. Known information about those files can be found in the second table (The Data File specification). Because extracting file manually would be a pain, several tools was developed in order to help you. You can use [Scene Reader](http://spinningcone.com/ff/stormmedia/projects/SceneReader.zip) for example, it's a win32 tool to extract and repack scene.bin archive.\n\nAlso note, that in [kernel.bin](FF7_Kernel_Kernelbin.md) there is a look-up table for scene.bin, which tells how many files there are in each section of scene.bin. You need to update it every time you repack the file and something changes. The table is at offset 0x0F1C of the third section of the kernel.bin file. You can use [SceneFix](http://forums.qhimm.com/index.php?topic=7127.0) program, which'll update the table for you.\n\nWe have 1024 possible battle numbers: 0 - 1023. Each group of *4* Battle Numbers refers to a particular Scene file: for instance, Battles 0-3 refer to File 0 in Scene.bin, Battles 4-7 refer to File 1 in Scene.bin, and so forth.\n\n#### Japanese Format\n\nIn the japanese scene.bin, ennemies names and attacks names have a size of 16 bytes, instead of 32 bytes.\n\n### General File Format\n\n<table>\n<thead>\n<tr>\n<th><p>Offset</p></th>\n<th><p>Length</p></th>\n<th><p>Description</p></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><p>0x0000</p></td>\n<td><p>4 bytes</p></td>\n<td><p>Pointer to first data file. You must multiply it by 4 to get actual data file offset. If the pointer is equal to FFFFFFFFh then it means that the end of block has been reached.</p></td>\n</tr>\n<tr>\n<td><p>0x0004</p></td>\n<td><p>4 bytes</p></td>\n<td><p>Pointer to second data file. You must multiply it by 4 to get actual data file offset. If the pointer is equal to FFFFFFFFh then it means that the end of block has been reached.</p></td>\n</tr>\n<tr>\n<td colspan=\"3\" style=\"text-align: center;\"><p>...</p></td>\n</tr>\n<tr>\n<td><p>0x003C</p></td>\n<td><p>4 bytes</p></td>\n<td><p>Last pointer, usually it equal FFFFFFFFh.</p></td>\n</tr>\n<tr>\n<td><p>0x0040</p></td>\n<td><p>4 * (pointer2 - pointer1) bytes</p></td>\n<td><p>First data file in block. It's a gziped file.<br />\n<em>Note: Sometimes it may finish by 0xFF bytes, because its size must be multiple of 4.</em></p></td>\n</tr>\n<tr>\n<td><p>pointer2 * 4</p></td>\n<td><p>4 * (pointer3 - pointer2) bytes</p></td>\n<td><p>Second data file in block. It's a gziped file.<br />\n<em>Note: Sometimes it may finish by 0xFF bytes, because its size must be multiple of 4.</em></p></td>\n</tr>\n<tr>\n<td colspan=\"3\" style=\"text-align: center;\"><p>...</p></td>\n</tr>\n<tr>\n<td><p>lastpointer * 4</p></td>\n<td><p>4 * (2000h - lastpointer) bytes</p></td>\n<td><p>Last data file in block.<br />\n<em>Note: There are about 6 to 12 files in each block. Each block finishes by 0xFF bytes, because its length must be 2000h (8192d) bytes.</em></p></td>\n</tr>\n</tbody>\n</table>\n\n### Data File Format\n\n| Offset | Length | Description |\n|----|----|----|\n| 0x0000 | 2 bytes | Enemy ID 1 |\n| 0x0002 | 2 bytes | Enemy ID 2 |\n| 0x0004 | 2 bytes | Enemy ID 3 |\n| 0x0006 | 2 bytes | Padding (always FFFFh) |\n| 0x0008 | 4 * 20 bytes | Battle Setup (4 records) ([format explanation](#battle-setup-1-format)) |\n| 0x0058 | 4 * 48 bytes | Camera Placement Data (4 records) ([format explanation](#camera-placement-data-format)) |\n| 0x0118 | 6 * 16 bytes | Battle Formation 1 (6 records) ([format explanation](#battle-formation-data)) |\n| 0x0178 | 6 * 16 bytes | Battle Formation 2 (6 records) |\n| 0x01E8 | 6 * 16 bytes | Battle Formation 3 (6 records) |\n| 0x0238 | 6 * 16 bytes | Battle Formation 4 (6 records) |\n| 0x0298 | 184 bytes | Enemy Data 1 ([format explanation](#enemy-data-format)) |\n| 0x0350 | 184 bytes | Enemy Data 2 |\n| 0x0408 | 184 bytes | Enemy Data 3 |\n| 0x04C0 | 32 * 28 bytes | Attack Data (32 records) ([format explanation](FF7_Battle_Damage_Formulas.md)) |\n| 0x0840 | 32 * 2 bytes | Attack IDs (32 records) |\n| 0x0880 | 32 * 32 bytes | Attack Names (32 records, in FF Text format) |\n| 0x0C80 | 2 bytes | Formation 1 AI Script Offset |\n| 0x0C82 | 2 bytes | Formation 2 AI Script Offset |\n| 0x0C84 | 2 bytes | Formation 3 AI Script Offset |\n| 0x0C86 | 2 bytes | Formation 4 AI Script Offset |\n| 0x0C88 | 0 - 504 bytes | Beginning of Formation AI Data ([format explanation](#ai-data)) |\n| 0x0E80 | 2 bytes | Enemy 1 AI Offset |\n| 0x0E82 | 2 bytes | Enemy 2 AI Offset |\n| 0x0E84 | 2 bytes | Enemy 3 AI Offset |\n| 0x0E86 | 0 - 4090 bytes | Beginning of AI Data ([format explanation](#ai-data)) |\n\n#### Battle Setup 1 Format\n\n<table>\n<thead>\n<tr>\n<th><p>Offset</p></th>\n<th><p>Length</p></th>\n<th><p>Description</p></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><p>0x0000</p></td>\n<td><p>2 bytes</p></td>\n<td><p><strong>Battle location, as follows:</strong></p></td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"2\" style=\"text-align: center; background: rgb(104,104,155);\"></td>\n<td></td>\n</tr>\n<tr>\n<td><p>0000h : Blank<br />\n0001h : Bizarro Battle - Center<br />\n0002h : Grassland<br />\n0003h : Mt Nibel<br />\n0004h : Forest<br />\n0005h : Beach<br />\n0006h : Desert<br />\n0007h : Snow<br />\n0008h : Swamp<br />\n0009h : Sector 1 Train Station<br />\n000Ah : Reactor 1<br />\n000Bh : Reactor 1 Core<br />\n000Ch : Reactor 1 Entrance<br />\n000Dh : Sector 4 Subway<br />\n000Eh : Nibel Caves or AForest Caves<br />\n000Fh : Shinra HQ<br />\n0010h : Midgar Raid Subway<br />\n0011h : Hojo's Lab<br />\n0012h : Shinra Elevators<br />\n0013h : Shinra Roof<br />\n0014h : Midgar Highway<br />\n0015h : Wutai Pagoda<br />\n0016h : Church<br />\n0017h : Coral Valley<br />\n0018h : Midgar Slums<br />\n0019h : Sector 4 Corridors or Junon Path<br />\n001Ah : Sector 4 Gantries or Midgar Underground<br />\n001Bh : Sector 7 Support Pillar Stairway<br />\n001Ch : Sector 7 Support Pillar Top<br />\n001Dh : Sector 8<br />\n001Eh : Sewers<br />\n001Fh : Mythril Mines<br />\n0020h : Northern Crater - Floating Platforms<br />\n0021h : Corel Mountain Path<br />\n0022h : Junon Beach<br />\n0023h : Junon Cargo Ship<br />\n0024h : Corel Prison<br />\n0025h : Battle Square<br />\n0026h : Da Chao - Rapps Battle<br />\n0027h : Cid's Backyard<br />\n0028h : Final Descent to Sephiroth<br />\n0029h : Reactor 5 Entrance<br />\n002Ah : Temple of the Ancients - Escher Room<br />\n002Bh : Shinra Mansion<br />\n002Ch : Junon Airship Dock<br />\n002Dh : Whirlwind Maze<br />\n002Eh : Junon Underwater Reactor<br />\n002Fh : Gongaga Reactor<br />\n0030h : Gelnika<br />\n0031h : Train Graveyard<br />\n0032h : Great Glacier Ice Caves &amp; Gaea Cliffs - Inside<br />\n0033h : Sister Ray<br />\n0034h : Sister Ray Base<br />\n0035h : Forgotten City Altar<br />\n0036h : Northern Crater - Initial Descent<br />\n0037h : Northern Crater - Hatchery<br />\n0038h : Northern Crater - Water Area<br />\n0039h : Safer Battle<br />\n003Ah : Kalm Flashback - Dragon Battle<br />\n003Bh : Junon Underwater Pipe<br />\n003Ch : Blank<br />\n003Dh : Corel Railway - Canyon<br />\n003Eh : Whirlwind Maze - Crater<br />\n003Fh : Corel Railway - Rollercoaster<br />\n0040h : Wooden Bridge<br />\n0041h : Da Chao<br />\n0042h : Fort Condor<br />\n0043h : Dirt Wasteland<br />\n0044h : Bizarro Battle - Right Side<br />\n0045h : Bizarro Battle - Left Side<br />\n0046h : Jenova*SYNTHESIS Battle<br />\n0047h : Corel Train Battle<br />\n0048h : Cosmo Canyon<br />\n0049h : Caverns of the Gi<br />\n004Ah : Nibelheim Mansion Basement<br />\n004Bh : Temple of the Ancients - Demons Gate<br />\n004Ch : Temple of the Ancients - Mural Room<br />\n004Dh : Temple of the Ancients - Clock Passage<br />\n004Eh : Final Battle - Sephiroth<br />\n004Fh : Jungle<br />\n0050h : Ultimate Weapon - Battle on Highwind<br />\n0051h : Corel Reactor<br />\n0052h : Unused<br />\n0053h : Don Corneo's Mansion<br />\n0054h : Emerald Weapon Battle<br />\n0055h : Reactor 5<br />\n0056h : Shinra HQ - Escape<br />\n0057h : Ultimate Weapon - Gongaga Reactor<br />\n0058h : Corel Prison - Dyne Battle<br />\n0059h : Ultimate Weapon - Forest</p></td>\n</tr>\n<tr>\n<td><p>0x0002</p></td>\n<td><p>2 bytes</p></td>\n<td><p>Upon defeat of all opponents in current formation, begin battle with <a href=\"#formation-id\">Formation ID</a> without ending battle scene</p></td>\n</tr>\n<tr>\n<td><p>0x0004</p></td>\n<td><p>2 bytes</p></td>\n<td><p>Escape Counter</p></td>\n</tr>\n<tr>\n<td><p>0x0006</p></td>\n<td><p>2 bytes</p></td>\n<td><p>Unused/Align 'FF'</p></td>\n</tr>\n<tr>\n<td><p>0x0008</p></td>\n<td><p>4 * 2 bytes</p></td>\n<td><p><a href=\"#formation-id\">Formation ID</a> of candidates for next Battle Arena battle. (default of 03E7h)</p></td>\n</tr>\n<tr>\n<td><p>0x0010</p></td>\n<td><p>2 bytes</p></td>\n<td><p>Escapable Flag (Along with other flags)</p></td>\n</tr>\n<tr>\n<td><p>0x0012</p></td>\n<td><p>1 byte</p></td>\n<td><p>Battle layout type (normal, ambush, side). 0-8 types.</p></td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"10\" style=\"text-align: center; background: rgb(104,104,155);\"></td>\n<td></td>\n</tr>\n<tr>\n<td><p>00 - Normal fight</p></td>\n</tr>\n<tr>\n<td><p>01 - Preemptive</p></td>\n</tr>\n<tr>\n<td><p>02 - Back attack</p></td>\n</tr>\n<tr>\n<td><p>03 - Side attack</p></td>\n</tr>\n<tr>\n<td><p>04 - Attacked from both sides (pincer attack, reverse side attack)</p></td>\n</tr>\n<tr>\n<td><p>05 - Another attack from both sides battle (different maybe?)</p></td>\n</tr>\n<tr>\n<td><p>06 - Another side attack</p></td>\n</tr>\n<tr>\n<td><p>07 - A third side attack</p></td>\n</tr>\n<tr>\n<td><p>08 - Normal battle that locks you in the front row, change command is disabled</p></td>\n</tr>\n<tr>\n<td><p>0x0013</p></td>\n<td><p>1 byte</p></td>\n<td><p>Indexed Pre-Battle Camera position</p></td>\n</tr>\n</tbody>\n</table>\n\n#### Camera Placement Data Format\n\n48 bytes per Formation\n\n<table>\n<thead>\n<tr>\n<th><p>Offset</p></th>\n<th><p>Length</p></th>\n<th><p>Description</p></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><p>0x00</p></td>\n<td><p>12 bytes</p></td>\n<td><p>Primary Battle Idle Camera Position</p></td>\n</tr>\n<tr>\n<td rowspan=\"7\" style=\"text-align: center; background: rgb(104,104,155);\"></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td><p>0x0</p></td>\n<td><p>Camera X Position</p></td>\n</tr>\n<tr>\n<td><p>0x2</p></td>\n<td><p>Camera Y Position</p></td>\n</tr>\n<tr>\n<td><p>0x4</p></td>\n<td><p>Camera Z Position</p></td>\n</tr>\n<tr>\n<td><p>0x6</p></td>\n<td><p>Camera X Direction</p></td>\n</tr>\n<tr>\n<td><p>0x8</p></td>\n<td><p>Camera Y Direction</p></td>\n</tr>\n<tr>\n<td><p>0xA</p></td>\n<td><p>Camera Z Direction</p></td>\n</tr>\n<tr>\n<td><p>0x0C</p></td>\n<td><p>2 * 12 bytes</p></td>\n<td><p>Other Camera Positions in the above format referenced in enemies' animations.</p></td>\n</tr>\n<tr>\n<td><p>0x24</p></td>\n<td><p>12 bytes</p></td>\n<td><p>Unused/Align 'FF'</p></td>\n</tr>\n</tbody>\n</table>\n\n#### Battle Formation Data\n\n4 Possible battle formations per scene, maximum of 6 enemies per battle. Each enemy entry contains the following data:\n\n<table>\n<thead>\n<tr>\n<th><p>Offset</p></th>\n<th><p>Length</p></th>\n<th colspan=\"2\" style=\"text-align: center; background: rgb(104,104,104);\"><p>Description</p></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><p>0x00</p></td>\n<td><p>2 bytes</p></td>\n<td colspan=\"2\" style=\"text-align: center;\"><p>Enemy ID</p></td>\n</tr>\n<tr>\n<td><p>0x02</p></td>\n<td><p>2 bytes</p></td>\n<td colspan=\"2\" style=\"text-align: center;\"><p>position X</p></td>\n</tr>\n<tr>\n<td><p>0x04</p></td>\n<td><p>2 bytes</p></td>\n<td colspan=\"2\" style=\"text-align: center;\"><p>position Y</p></td>\n</tr>\n<tr>\n<td><p>0x06</p></td>\n<td><p>2 bytes</p></td>\n<td colspan=\"2\" style=\"text-align: center;\"><p>position Z</p></td>\n</tr>\n<tr>\n<td><p>0x08</p></td>\n<td><p>2 bytes</p></td>\n<td colspan=\"2\" style=\"text-align: center;\"><p>Row</p></td>\n</tr>\n<tr>\n<td><p>0x0A</p></td>\n<td><p>2 bytes</p></td>\n<td colspan=\"2\" style=\"text-align: center;\"><p><a href=\"#binary-cover-flags\">Binary \"Cover flags\"</a></p></td>\n</tr>\n<tr>\n<td><p>0x0C</p></td>\n<td><p>4 bytes</p></td>\n<td colspan=\"2\" style=\"text-align: center;\"><p>Initial condition flags. Only last 5 bits are considered.</p></td>\n</tr>\n<tr>\n<td colspan=\"2\" rowspan=\"5\" style=\"background: rgb(104,104,155)\"></td>\n<td style=\"text-align: center;\"><p>0x0001</p></td>\n<td style=\"text-align: center;\"><p>Visible</p></td>\n</tr>\n<tr>\n<td style=\"text-align: center;\"><p>0x0002</p></td>\n<td style=\"text-align: center;\"><p>Indicates initial direction facing if players get a side attack.</p></td>\n</tr>\n<tr>\n<td style=\"text-align: center; background: rgb(155,155,104);\"><p>0x0004</p></td>\n<td style=\"text-align: center; background: rgb(155,155,104);\"><p>Unknown</p></td>\n</tr>\n<tr>\n<td style=\"text-align: center;\"><p>0x0008</p></td>\n<td style=\"text-align: center;\"><p>Targetable</p></td>\n</tr>\n<tr>\n<td style=\"text-align: center;\"><p>0x0010</p></td>\n<td style=\"text-align: center;\"><p>Main Script Active</p></td>\n</tr>\n</tbody>\n</table>\n\n#### Enemy Data Format\n\n<table>\n<thead>\n<tr>\n<th><p>Offset</p></th>\n<th><p>Length</p></th>\n<th><p>Description</p></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><p>0x0000</p></td>\n<td><p>32 bytes</p></td>\n<td><p>Enemy's name (completed by FFh bytes)</p></td>\n</tr>\n<tr>\n<td><p>0x0020</p></td>\n<td><p>1 byte</p></td>\n<td><p>Enemy's level</p></td>\n</tr>\n<tr>\n<td><p>0x0021</p></td>\n<td><p>1 byte</p></td>\n<td><p>Enemy's speed</p></td>\n</tr>\n<tr>\n<td><p>0x0022</p></td>\n<td><p>1 byte</p></td>\n<td><p>Enemy's luck</p></td>\n</tr>\n<tr>\n<td><p>0x0023</p></td>\n<td><p>1 byte</p></td>\n<td><p>Enemy's evade</p></td>\n</tr>\n<tr>\n<td><p>0x0024</p></td>\n<td><p>1 byte</p></td>\n<td><p>Enemy's strength</p></td>\n</tr>\n<tr>\n<td><p>0x0025</p></td>\n<td><p>1 byte</p></td>\n<td><p>Enemy's defense</p></td>\n</tr>\n<tr>\n<td><p>0x0026</p></td>\n<td><p>1 byte</p></td>\n<td><p>Enemy's magic</p></td>\n</tr>\n<tr>\n<td><p>0x0027</p></td>\n<td><p>1 byte</p></td>\n<td><p>Enemy's magic defense</p></td>\n</tr>\n<tr>\n<td><p>0x0028</p></td>\n<td><p>8 bytes</p></td>\n<td><p>Element types (8 records):<br />\n00h - Fire<br />\n01h - Ice<br />\n02h - Bolt<br />\n03h - Earth<br />\n04h - Bio<br />\n05h - Gravity<br />\n06h - Water<br />\n07h - Wind<br />\n08h - Holy<br />\n09h - Health<br />\n0Ah - Cut<br />\n0Bh - Hit<br />\n0Ch - Punch<br />\n0Dh - Shoot<br />\n0Eh - Scream<br />\n0Fh - HIDDEN<br />\n10h-1Fh - No Effect<br />\n20h-3Fh - <a href=\"FF7_Battle_Battle_Mechanics.md#statuses\">Statuses</a> (Damage done by actions that inflict these statuses will be modified)<br />\nFFh - No element</p></td>\n</tr>\n<tr>\n<td><p>0x0030</p></td>\n<td><p>8 bytes</p></td>\n<td><p>Element rates for elements above, respectively (8 records):<br />\n00h - Death<br />\n02h - Double Damage<br />\n04h - Half Damage<br />\n05h - Nullify Damage<br />\n06h - Absorb 100%<br />\n07h - Full Cure<br />\nFFh - Nothing</p></td>\n</tr>\n<tr>\n<td><p>0x0038</p></td>\n<td><p>16 bytes</p></td>\n<td><p>Action animation index (1 byte each).</p></td>\n</tr>\n<tr>\n<td><p>0x0048</p></td>\n<td><p>32 bytes</p></td>\n<td><p>Enemy Attack ID's (2 bytes each).</p></td>\n</tr>\n<tr>\n<td><p>0x0068</p></td>\n<td><p>32 bytes</p></td>\n<td><p>Enemy Attacks Camera Movement Id for single and multiple targets (2 bytes each). If set this will overwrite camera movement set in attack itself.</p></td>\n</tr>\n<tr>\n<td><p>0x0088</p></td>\n<td><p>4 bytes</p></td>\n<td><p>Item drop/steal rates.<br />\nThese are chances to get items listed in next section. 1 byte per item. If the rate is lower than 80h, for e.g. 08h - then this is a drop item and has 8/63 [63 is max] chance for drop. But if rate is higher than 80h, let's say... A0h, then this is an item for steal, and chances for successful steal is A0h - 80h = 20h = 32/63.</p></td>\n</tr>\n<tr>\n<td><p>0x008C</p></td>\n<td><p>8 bytes</p></td>\n<td><p>This is a list of Item ID's which are described above. 2 bytes per item. FFFFh means no item.</p></td>\n</tr>\n<tr>\n<td><p>0x0094</p></td>\n<td><p>6 bytes</p></td>\n<td><p>Indexes of up to three attacks (2 bytes each) that enemy can perform while manipulated or berserked</p></td>\n</tr>\n<tr>\n<td style=\"background: rgb(155,155,104)\"><p>0x009A</p></td>\n<td style=\"background: rgb(155,155,104)\"><p>2 bytes</p></td>\n<td style=\"background: rgb(155,155,104)\"><p>Unknown data</p></td>\n</tr>\n<tr>\n<td><p>0x009C</p></td>\n<td><p>2 bytes</p></td>\n<td><p>Enemy's MP</p></td>\n</tr>\n<tr>\n<td><p>0x009E</p></td>\n<td><p>2 bytes</p></td>\n<td><p>AP points you receive when you win the battle</p></td>\n</tr>\n<tr>\n<td><p>0x00A0</p></td>\n<td><p>2 bytes</p></td>\n<td><p>Enemy can be morphed into this item. FFFFh if it can't be morphed into anything.</p></td>\n</tr>\n<tr>\n<td><p>0x00A2</p></td>\n<td><p>1 byte</p></td>\n<td><p>Multiplier for back damage. damage = damage * 0xXX / 8.</p></td>\n</tr>\n<tr>\n<td><p>0x00A3</p></td>\n<td><p>1 byte</p></td>\n<td><p>align 0xff.</p></td>\n</tr>\n<tr>\n<td><p>0x00A4</p></td>\n<td><p>4 bytes</p></td>\n<td><p>Enemy's HP</p></td>\n</tr>\n<tr>\n<td><p>0x00A8</p></td>\n<td><p>4 bytes</p></td>\n<td><p>Exp points you receive when you win the battle</p></td>\n</tr>\n<tr>\n<td><p>0x00AC</p></td>\n<td><p>4 bytes</p></td>\n<td><p>Gil you receive when you win the battle</p></td>\n</tr>\n<tr>\n<td><p>0x00B0</p></td>\n<td><p>4 bytes</p></td>\n<td><p>Status immunities</p></td>\n</tr>\n<tr>\n<td style=\"background: rgb(155,155,104)\"><p>0x00B4</p></td>\n<td style=\"background: rgb(155,155,104)\"><p>4 bytes</p></td>\n<td style=\"background: rgb(155,155,104)\"><p>Unknown [Always FFFFFFFFh]</p></td>\n</tr>\n</tbody>\n</table>\n\n#### Formation ID\n\nFormation ID is an index to a formation within a given scene. It is the scene index bit shifted 2 to the left plus formation index within the scene.\n\n```text\n0 1 2 3 4 5 6 7 8 9 A B C D E F\n[ - - - - - - - - - - - - ] [ ]\n        scene index         formation index\n```\n\nFor this reason, the Formation ID will not exceed 03FFh.\n\nexample: Formation 028Dh bit shift two to the right to get scene\n\n```text\n028D >> 2 = 00A3 (right-most bits are truncated)\n```\n\nThis is Scene 163 Formation Index is just the ID ANDed with 3.\n\n```text\n028D AND 3 = 01\n```\n\nFormation 1 So this is Formation 1 in scene 163. (SOLDIER:3rd x2)\n\n#### AI Data\n\nThis section contains Battle Script that is executed before or/and during every fight. Every enemy has it's own script, and this script is divided to a number of sections. Each script starts with 32 bytes of header that are divided into 16 parts representing 16 script types. The 2-byte number in any section is an offset relative to the beginning of this 32 byte block that tells the script reader where the script starts for that script type.\n\n| Offset | Script Type      |\n|--------|------------------|\n| 0x00   | Initialize       |\n| 0x02   | Main             |\n| 0x04   | General Counter  |\n| 0x06   | Death Counter    |\n| 0x08   | Physical Counter |\n| 0x0A   | Magical Counter  |\n| 0x0C   | Battle End       |\n| 0x0E   | Pre-Action Setup |\n| 0x10   | Custom Event 1   |\n| 0x12   | Custom Event 2   |\n| 0x14   | Custom Event 3   |\n| 0x16   | Custom Event 4   |\n| 0x18   | Custom Event 5   |\n| 0x1A   | Custom Event 6   |\n| 0x1C   | Custom Event 7   |\n| 0x1E   | Custom Event 8   |\n\nIts structure and opcodes are described in [Battle Script](FF7_Battle_Battle_Scenes_Battle_Script.md).\n\nNOTES:\n\n- A monster's total AI size will always be an even number of bytes. If the actual scripts are an odd number, a single NULL (FFh) will be placed before the next monster's AI header (may not be required).\n- Battle begins after all characters' Initialize scripts have been run (Players first, then enemies, then formation).\n- The only character with \"Battle End\" is in Cloud's AI. It's meant to lower the character's Love Points with him if he lets them die or he dies with them in the party (not sure which).\n- Pre-Action Event occurs on all battle participants prior to any actions performed by any participant regardless of actor or target. This includes all executed 92 commands that have a command index of less than 21h. If any 92 commands are called in this section, the command that caused this script to run has priority.\n- The Custom Event sections are not called by any event. They only occur if they are called with the 92 command.\n\n```text\n60 22 <- command index \"Run script\"\n60 0X <- where X is the script section in hex (eg. X = 8 would call Custom Event 1 since it is script id 08\n         [not to be confused with offset])\n92\n```\n\n- Custom Event 8 is only used on Mystery Ninja (all), Ultimate Weapons in location other than above Cosmo Canyon, Safer Sephiroth, and the final \"showdown\" between Cloud and Sephiroth. These characters have scripts on them that do not remove them from battle when they are defeated.\n- Custom Events 1-7 may not work. (not thoroughly tested)\n- The order of scripts executed:\n\n  - Beginning of battle\n    - Pre-Battle (all participants)\n  - Once a \"main-script enabled\" enemy's time gauge is full:\n    - Main (Enemy performs action)\n  - Pre-Attack (If enemy script uses a 92 command with a command index of 20h or less)\n    - Pre-Action Setup (occurs on all participants)\n  - Post-Attack\n    1. Death Counter (If script owner died, execution stops here)\n    2. General Counter (Executed by all targets)\n    3. Physical Counter/Magical Counter (Executed by all targets depending on damage type)\n  - Battle ends\n    - Battle End (all participants)\n\n#### Binary Cover Flags\n\nThese flags are used in conjunction with row to determine if a target can be selected as the target of a **short-range attack**. The determination of this is worked out in this way: An enemy exists in row 1 and another in row 2. If the enemy in row 1 shares a cover flag with the enemy in row 2 then the enemy in row 2 cannot be targeted until all enemies in row 1 that share a cover flag with the row 2 enemy is defeated. It works like this. Two active enemies exist, A and B.\n\n```text\nIf ((B's row > A's row) and (B's cover flags AND A's cover flags) > 0) then enemy B cannot be targeted by short-range attacks.\n```\n\nfor any enemies A and B.\n\nExample:\n\nConsider the Battery Cap x6 battle in the forest between Nibelheim and Rocket Town. Their cover flags (in binary) are:\n\n```text\nRow 1:       00100\nRow 2:    00110 01100\nRow 3: 00011 00100 11000\n```\n\nThe battery caps in row 2 cannot be targeted by a short-range attack until the one in row 1 has been defeated because they share the 0x4 cover flag. Once row 1 has been cleared:\n\n```text\nRow 2:    00110 01100\nRow 3: 00011 00100 11000\n```\n\nThe battery cap on left in row 2 covers the left two in row 3 because it shares flag 0x4 with the one in the middle and flag 0x2 with the one on the far left. As long as it is active these in row 3 cannot be targeted. Similarly, the battery cap on the right in row 2 shares the 0x4 flag with the middle of row 3 and the 0x8 flag with the far right of row 3 so these cannot be targeted until the right side of row 2 is defeated.\n\nIt is also necessary to note that because row 1 does not share any flags with the extreme right and left of row 3, they can be targeted if the corresponding enemy in row 2 is defeated even if the row 1 enemy is still active.\n\nAlso of note is that enemies in the same row that share cover flags are not considered.\n\nOnly the first five bits may be considered even though the value is stored as a word.\n\n## Useful Downloads\n\nThere are few programs written that will help you edit scene.bin file:\n\n- [Scene Reader](http://spinningcone.com/ff/stormmedia/projects/SceneReader.zip)\n- [SceneEdit](http://www.subfan.pl/mav/SceneEdit.zip)\n- [Scenester](http://aaronserv.dyndns.org/hosting/qhimmwiki/ramza_scenester_0.5.zip)\n- [Proud Clod](http://forums.qhimm.com/index.php?topic=8481.0)\n","structuredPatch":[],"originalFile":null}},{"type":"assistant","message":{"model":"claude-opus-4-5-20251101","id":"msg_01BF6v475DtMJ66FWQ5g1Zar","type":"message","role":"assistant","content":[{"type":"text","text":"Now let me verify the output and generate the agent summary report:"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":0,"cache_creation_input_tokens":10883,"cache_read_input_tokens":79419,"cache_creation":{"ephemeral_5m_input_tokens":10883,"ephemeral_1h_input_tokens":0},"output_tokens":135,"service_tier":"standard"},"context_management":null},"parent_tool_use_id":null,"session_id":"5a116cbc-6614-4e79-9389-b85994640c4f","uuid":"9860f014-7b36-40bd-adff-e1530a058a0c"},{"type":"assistant","message":{"model":"claude-opus-4-5-20251101","id":"msg_01BF6v475DtMJ66FWQ5g1Zar","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01SZamydwhAFwiaPEwTfhLFH","name":"Bash","input":{"command":"wc -l /Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/final/FF7_Battle_Battle_Scenes.md","description":"Count lines in output file"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":0,"cache_creation_input_tokens":10883,"cache_read_input_tokens":79419,"cache_creation":{"ephemeral_5m_input_tokens":10883,"ephemeral_1h_input_tokens":0},"output_tokens":135,"service_tier":"standard"},"context_management":null},"parent_tool_use_id":null,"session_id":"5a116cbc-6614-4e79-9389-b85994640c4f","uuid":"c9d1afdd-52cc-4ab4-8faf-7159d3f8e8c8"},{"type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01SZamydwhAFwiaPEwTfhLFH","type":"tool_result","content":"     790 /Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/final/FF7_Battle_Battle_Scenes.md","is_error":false}]},"parent_tool_use_id":null,"session_id":"5a116cbc-6614-4e79-9389-b85994640c4f","uuid":"4121b012-3b97-4499-9d23-c3caa58046ab","tool_use_result":{"stdout":"     790 /Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/final/FF7_Battle_Battle_Scenes.md","stderr":"","interrupted":false,"isImage":false}},{"type":"assistant","message":{"model":"claude-opus-4-5-20251101","id":"msg_01R4CNsWPqwSbEBRHYfgzwQS","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01Mv1Ynsjj51P4Zpz4yhLW5B","name":"Bash","input":{"command":"wc -l /Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/markdown/merged_with_pdf_content/FF7_Battle_Battle_Scenes.md","description":"Count lines in original file"}}],"stop_reason":"tool_use","stop_sequence":null,"usage":{"input_tokens":0,"cache_creation_input_tokens":297,"cache_read_input_tokens":90302,"cache_creation":{"ephemeral_5m_input_tokens":297,"ephemeral_1h_input_tokens":0},"output_tokens":129,"service_tier":"standard"},"context_management":{"applied_edits":[]}},"parent_tool_use_id":null,"session_id":"5a116cbc-6614-4e79-9389-b85994640c4f","uuid":"a18d9be8-e140-4510-ba37-8608c40449e4"},{"type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01Mv1Ynsjj51P4Zpz4yhLW5B","type":"tool_result","content":"     743 /Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/markdown/merged_with_pdf_content/FF7_Battle_Battle_Scenes.md","is_error":false}]},"parent_tool_use_id":null,"session_id":"5a116cbc-6614-4e79-9389-b85994640c4f","uuid":"08135216-22cb-44cb-b416-bc0fa83c2263","tool_use_result":{"stdout":"     743 /Volumes/DevSSD/01_Development/Projects/experiments/ff70G-japanese-mod/docs/reference/game_engine/markdown/merged_with_pdf_content/FF7_Battle_Battle_Scenes.md","stderr":"","interrupted":false,"isImage":false}},{"type":"assistant","message":{"model":"claude-opus-4-5-20251101","id":"msg_01A8UQzjDZBtbHv9CUCAVFaw","type":"message","role":"assistant","content":[{"type":"text","text":"Now let me output the agent summary report:\n\n## Transformation Complete\n\n```json\n{\n  \"filename\": \"FF7_Battle_Battle_Scenes.md\",\n  \"module\": \"Battle\",\n  \"line_count\": 790,\n  \"original_line_count\": 743,\n  \"llm_summary\": \"Documents the scene.bin file format containing all FF7 enemy battle configurations, including data structures for enemy stats, AI scripts, formations, and camera placement. LLMs should read this when parsing battle data, modifying enemy encounters, or understanding the battle scene file architecture.\",\n  \"primary_topics\": [\n    \"Scene.bin file structure\",\n    \"Enemy data format\",\n    \"Battle AI scripting\",\n    \"Formation configuration\",\n    \"Camera placement data\"\n  ],\n  \"heading_changes\": \"Removed wiki-style anchor syntax from H1 ('{#ff7battlebattle_scenes}'), removed wiki-style TOC block (lines 18-20), converted H2 anchor '{#scene.bin_file_format}' to GitHub-compatible kebab-case. Heading hierarchy was already correct (H1â†’H2â†’H3â†’H4). One issue: 'Japanese format' was H4 under H3 'Overview' - kept as-is since it's a subsection detail.\",\n  \"outbound_links\": [\n    {\n      \"target\": \"FF7_Kernel_Kernelbin.md\",\n      \"anchor\": null,\n      \"text\": \"kernel.bin\",\n      \"line_number\": 50\n    },\n    {\n      \"target\": \"FF7_Battle_Damage_Formulas.md\",\n      \"anchor\": null,\n      \"text\": \"format explanation\",\n      \"line_number\": 88\n    },\n    {\n      \"target\": \"FF7_Battle_Battle_Mechanics.md\",\n      \"anchor\": \"statuses\",\n      \"text\": \"Statuses\",\n      \"line_number\": 466\n    },\n    {\n      \"target\": \"FF7_Battle_Battle_Scenes_Battle_Script.md\",\n      \"anchor\": null,\n      \"text\": \"Battle Script\",\n      \"line_number\": 666\n    }\n  ],\n  \"images_count\": 0,\n  \"images_updated\": [],\n  \"wiki_links_converted\": 12,\n  \"tables_count\": 7,\n  \"code_blocks_count\": 6,\n  \"issues_found\": [\n    \"External links to Qhimm forums and download sites may be dead (historical URLs)\",\n    \"Some internal anchor references converted from wiki-style but target pages may have different anchor formats\"\n  ],\n  \"processing_notes\": \"Preserved all complex HTML tables with rowspan/colspan (required for proper rendering). Converted wiki-style links like '(FF7/Kernel/Kernel.bin \\\"kernel.bin\\\"){.wikilink}' to standard markdown '[kernel.bin](FF7_Kernel_Kernelbin.md)'. Added language tag 'text' to 6 code blocks that were previously untagged. Critical Japanese format note (16-byte vs 32-byte names) preserved. Document increased from 743 to 790 lines due to YAML frontmatter and expanded metadata block.\"\n}\n```\n\n`â˜… Insight â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€`\n**Key Standardization Decisions:**\n1. **HTML Tables Preserved**: The complex tables with `rowspan` and `colspan` attributes cannot be converted to Markdown tables - they'd lose critical structural information. GitHub renders HTML tables correctly.\n2. **Wiki-style Link Pattern**: The original used `(path \"title\"){.wikilink}` syntax from MediaWiki. The transformation maps `FF7/Kernel/Kernel.bin` â†’ `FF7_Kernel_Kernelbin.md` (slashes become underscores).\n3. **Anchor Standardization**: GitHub auto-generates anchors in kebab-case from headings. Internal links like `#battle_setup_1_format` become `#battle-setup-1-format`.\n`â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€`"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":0,"cache_creation_input_tokens":197,"cache_read_input_tokens":90599,"cache_creation":{"ephemeral_5m_input_tokens":197,"ephemeral_1h_input_tokens":0},"output_tokens":975,"service_tier":"standard"},"context_management":null},"parent_tool_use_id":null,"session_id":"5a116cbc-6614-4e79-9389-b85994640c4f","uuid":"659cb8cb-ea5a-47b3-9c88-124c5a793a45"},{"type":"result","subtype":"success","is_error":false,"duration_ms":237463,"duration_api_ms":248219,"num_turns":6,"result":"Now let me output the agent summary report:\n\n## Transformation Complete\n\n```json\n{\n  \"filename\": \"FF7_Battle_Battle_Scenes.md\",\n  \"module\": \"Battle\",\n  \"line_count\": 790,\n  \"original_line_count\": 743,\n  \"llm_summary\": \"Documents the scene.bin file format containing all FF7 enemy battle configurations, including data structures for enemy stats, AI scripts, formations, and camera placement. LLMs should read this when parsing battle data, modifying enemy encounters, or understanding the battle scene file architecture.\",\n  \"primary_topics\": [\n    \"Scene.bin file structure\",\n    \"Enemy data format\",\n    \"Battle AI scripting\",\n    \"Formation configuration\",\n    \"Camera placement data\"\n  ],\n  \"heading_changes\": \"Removed wiki-style anchor syntax from H1 ('{#ff7battlebattle_scenes}'), removed wiki-style TOC block (lines 18-20), converted H2 anchor '{#scene.bin_file_format}' to GitHub-compatible kebab-case. Heading hierarchy was already correct (H1â†’H2â†’H3â†’H4). One issue: 'Japanese format' was H4 under H3 'Overview' - kept as-is since it's a subsection detail.\",\n  \"outbound_links\": [\n    {\n      \"target\": \"FF7_Kernel_Kernelbin.md\",\n      \"anchor\": null,\n      \"text\": \"kernel.bin\",\n      \"line_number\": 50\n    },\n    {\n      \"target\": \"FF7_Battle_Damage_Formulas.md\",\n      \"anchor\": null,\n      \"text\": \"format explanation\",\n      \"line_number\": 88\n    },\n    {\n      \"target\": \"FF7_Battle_Battle_Mechanics.md\",\n      \"anchor\": \"statuses\",\n      \"text\": \"Statuses\",\n      \"line_number\": 466\n    },\n    {\n      \"target\": \"FF7_Battle_Battle_Scenes_Battle_Script.md\",\n      \"anchor\": null,\n      \"text\": \"Battle Script\",\n      \"line_number\": 666\n    }\n  ],\n  \"images_count\": 0,\n  \"images_updated\": [],\n  \"wiki_links_converted\": 12,\n  \"tables_count\": 7,\n  \"code_blocks_count\": 6,\n  \"issues_found\": [\n    \"External links to Qhimm forums and download sites may be dead (historical URLs)\",\n    \"Some internal anchor references converted from wiki-style but target pages may have different anchor formats\"\n  ],\n  \"processing_notes\": \"Preserved all complex HTML tables with rowspan/colspan (required for proper rendering). Converted wiki-style links like '(FF7/Kernel/Kernel.bin \\\"kernel.bin\\\"){.wikilink}' to standard markdown '[kernel.bin](FF7_Kernel_Kernelbin.md)'. Added language tag 'text' to 6 code blocks that were previously untagged. Critical Japanese format note (16-byte vs 32-byte names) preserved. Document increased from 743 to 790 lines due to YAML frontmatter and expanded metadata block.\"\n}\n```\n\n`â˜… Insight â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€`\n**Key Standardization Decisions:**\n1. **HTML Tables Preserved**: The complex tables with `rowspan` and `colspan` attributes cannot be converted to Markdown tables - they'd lose critical structural information. GitHub renders HTML tables correctly.\n2. **Wiki-style Link Pattern**: The original used `(path \"title\"){.wikilink}` syntax from MediaWiki. The transformation maps `FF7/Kernel/Kernel.bin` â†’ `FF7_Kernel_Kernelbin.md` (slashes become underscores).\n3. **Anchor Standardization**: GitHub auto-generates anchors in kebab-case from headings. Internal links like `#battle_setup_1_format` become `#battle-setup-1-format`.\n`â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€`","session_id":"5a116cbc-6614-4e79-9389-b85994640c4f","total_cost_usd":0.9189709,"usage":{"input_tokens":2,"cache_creation_input_tokens":60988,"cache_read_input_tokens":433676,"output_tokens":12289,"server_tool_use":{"web_search_requests":0,"web_fetch_requests":0},"service_tier":"standard","cache_creation":{"ephemeral_1h_input_tokens":0,"ephemeral_5m_input_tokens":60988}},"modelUsage":{"claude-haiku-4-5-20251001":{"inputTokens":827,"outputTokens":330,"cacheReadInputTokens":19363,"cacheCreationInputTokens":0,"webSearchRequests":0,"costUSD":0.0044133,"contextWindow":200000},"claude-sonnet-4-5-20250929":{"inputTokens":3,"outputTokens":229,"cacheReadInputTokens":19552,"cacheCreationInputTokens":0,"webSearchRequests":0,"costUSD":0.0093096,"contextWindow":200000},"claude-opus-4-5-20251101":{"inputTokens":2,"outputTokens":12289,"cacheReadInputTokens":433676,"cacheCreationInputTokens":60988,"webSearchRequests":0,"costUSD":0.9052479999999999,"contextWindow":200000}},"permission_denials":[],"uuid":"3ba7285f-80d9-47e2-b488-f802f24103bc"}]
