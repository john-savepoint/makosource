# FFNx Japanese Implementation Master Bible

## Table of Contents

- [FFNx Japanese Implementation Master Bible](#table-of-contents)
  - [TABLE OF CONTENTS](./table-of-contents.md)
  - [1. EXECUTIVE MISSION BRIEFING](./1-executive-mission-briefing.md)
    - [1.1 The Objective](./1-executive-mission-briefing.md#11-the-objective)
    - [1.2 Success Criteria](./1-executive-mission-briefing.md#12-success-criteria)
  - [2. ARCHITECTURAL OVERVIEW & STRATEGIC ANALYSIS](./2-architectural-overview-strategic-analysis.md)
    - [2.1 The Core Technical Deficit](./2-architectural-overview-strategic-analysis.md#21-the-core-technical-deficit)
    - [2.2 The AF3DN.P Solution (Reference Architecture)](./2-architectural-overview-strategic-analysis.md#22-the-af3dnp-solution-reference-architecture)
    - [2.3 The FFNx Implementation Strategy (Path C - Hybrid Extension)](./2-architectural-overview-strategic-analysis.md#23-the-ffnx-implementation-strategy-path-c-hybrid-extension)
  - [3. CRITICAL TERMINOLOGY & CONCEPTS](./3-critical-terminology-concepts.md)
    - [3.1 Core Technologies](./3-critical-terminology-concepts.md#31-core-technologies)
    - [3.2 File Formats](./3-critical-terminology-concepts.md#32-file-formats)
    - [3.3 Encoding Systems](./3-critical-terminology-concepts.md#33-encoding-systems)
    - [3.4 Memory Structures](./3-critical-terminology-concepts.md#34-memory-structures)
  - [4. ASSET SPECIFICATIONS & DATA STRUCTURES](./4-asset-specifications-data-structures.md)
    - [4.1 Font Texture Manifest](./4-asset-specifications-data-structures.md#41-font-texture-manifest)
    - [4.2 Character Mapping Data](./4-asset-specifications-data-structures.md#42-character-mapping-data)
    - [4.3 Japanese File Structure (Critical Differences)](./4-asset-specifications-data-structures.md#43-japanese-file-structure-critical-differences)
  - [5. FFNX CODEBASE ARCHITECTURE](./5-ffnx-codebase-architecture.md)
    - [5.1 Repository Structure](./5-ffnx-codebase-architecture.md#51-repository-structure)
    - [5.2 Key Subsystems](./5-ffnx-codebase-architecture.md#52-key-subsystems)
    - [5.3 Critical Memory Addresses & Structures](./5-ffnx-codebase-architecture.md#53-critical-memory-addresses-structures)
  - [6. DEEP DIVE: TECHNICAL CONSTRAINTS & SOLUTIONS](./6-deep-dive-technical-constraints-solutions.md)
    - [6.1 Constraint #1: The Geometry vs. Texture Problem ("Squashed Kanji")](./6-deep-dive-technical-constraints-solutions.md#61-constraint-1-the-geometry-vs-texture-problem-squashed-kanji)
    - [6.2 Constraint #2: The Texture Allocation & Palette System](./6-deep-dive-technical-constraints-solutions.md#62-constraint-2-the-texture-allocation-palette-system)
    - [6.3 Constraint #3: Registry Virtualization & File Pathing](./6-deep-dive-technical-constraints-solutions.md#63-constraint-3-registry-virtualization-file-pathing)
    - [6.4 Constraint #4: The "JFLEVE" Typo & File Redirection](./6-deep-dive-technical-constraints-solutions.md#64-constraint-4-the-jfleve-typo-file-redirection)
  - [7. IMPLEMENTATION SPECIFICATION: C++ MODIFICATIONS](./7-implementation-specification-c-modifications.md)
    - [7.1 Configuration Extension (src/cfg.h, src/cfg.cpp)](./7-implementation-specification-c-modifications.md#71-configuration-extension-srccfgh-srccfgcpp)
    - [7.2 Runtime Executable Detection & Registry Hooks (src/common.cpp)](./7-implementation-specification-c-modifications.md#72-runtime-executable-detection-registry-hooks-srccommoncpp)
    - [7.3 Texture Allocation Override (src/common.cpp)](./7-implementation-specification-c-modifications.md#73-texture-allocation-override-srccommoncpp)
    - [7.4 Multi-Page Texture Loader (src/saveload.cpp)](./7-implementation-specification-c-modifications.md#74-multi-page-texture-loader-srcsaveloadcpp)
    - [7.5 File Redirection for Japanese Variants (src/redirect.cpp)](./7-implementation-specification-c-modifications.md#75-file-redirection-for-japanese-variants-srcredirectcpp)
    - [7.6 Character Width Table Patch (src/ff7/font.cpp, src/ff7/font.h)](./7-implementation-specification-c-modifications.md#76-character-width-table-patch-srcff7fontcpp-srcff7fonth)
  - [8. IMPLEMENTATION SPECIFICATION: ASSEMBLY HOOKS](./8-implementation-specification-assembly-hooks.md)
    - [8.1 The Text Parser Hook Concept](./8-implementation-specification-assembly-hooks.md#81-the-text-parser-hook-concept)
    - [8.2 Finding the Injection Point](./8-implementation-specification-assembly-hooks.md#82-finding-the-injection-point)
    - [8.3 The Hext Patch Implementation](./8-implementation-specification-assembly-hooks.md#83-the-hext-patch-implementation)
    - [8.4 Global Variable Allocation for g_currentFontPage](./8-implementation-specification-assembly-hooks.md#84-global-variable-allocation-for-gcurrentfontpage)
  - [9. IMPLEMENTATION SPECIFICATION: RENDERER INTEGRATION](./9-implementation-specification-renderer-integration.md)
    - [9.1 Reading the Font Page Variable (src/gl/gl.cpp)](./9-implementation-specification-renderer-integration.md#91-reading-the-font-page-variable-srcglglcpp)
    - [9.2 Handling Palette Change Events (src/common.cpp)](./9-implementation-specification-renderer-integration.md#92-handling-palette-change-events-srccommoncpp)
    - [9.3 Rendering Pipeline Integration (src/gl/gl.cpp)](./9-implementation-specification-renderer-integration.md#93-rendering-pipeline-integration-srcglglcpp)
  - [10. ADVANCED FEATURE: FURIGANA SUPPORT](./10-advanced-feature-furigana-support.md)
    - [10.1 The Furigana Challenge](./10-advanced-feature-furigana-support.md#101-the-furigana-challenge)
    - [10.2 Solution Strategy: The "Half-Height" Renderer](./10-advanced-feature-furigana-support.md#102-solution-strategy-the-half-height-renderer)
    - [10.3 Assembly Hook Extension (Hext Patch)](./10-advanced-feature-furigana-support.md#103-assembly-hook-extension-hext-patch)
    - [10.4 Renderer Modification (src/gl/gl.cpp)](./10-advanced-feature-furigana-support.md#104-renderer-modification-srcglglcpp)
    - [10.5 Line Height Patch (The Hard Part)](./10-advanced-feature-furigana-support.md#105-line-height-patch-the-hard-part)
  - [11. TESTING & VERIFICATION PROTOCOL](./11-testing-verification-protocol.md)
    - [11.1 Unit Test 1: The "Red W" Test (Texture Override Sanity Check)](./11-testing-verification-protocol.md#111-unit-test-1-the-red-w-test-texture-override-sanity-check)
    - [11.2 Unit Test 2: Width Table Patch Verification](./11-testing-verification-protocol.md#112-unit-test-2-width-table-patch-verification)
    - [11.3 Integration Test 1: Multi-Texture Loading](./11-testing-verification-protocol.md#113-integration-test-1-multi-texture-loading)
    - [11.4 Integration Test 2: Page Switching (Assembly Hook Verification)](./11-testing-verification-protocol.md#114-integration-test-2-page-switching-assembly-hook-verification)
    - [11.5 Full System Test: Real Japanese Dialogue](./11-testing-verification-protocol.md#115-full-system-test-real-japanese-dialogue)
    - [11.6 Regression Testing](./11-testing-verification-protocol.md#116-regression-testing)
  - [12. RISK MITIGATION & DEBUGGING GUIDE](./12-risk-mitigation-debugging-guide.md)
    - [12.1 Common Failure Modes & Solutions](./12-risk-mitigation-debugging-guide.md#121-common-failure-modes-solutions)
      - [Failure Mode #1: Crash on Startup](./12-risk-mitigation-debugging-guide.md#failure-mode-1-crash-on-startup)
      - [Failure Mode #2: Crash on Menu Open](./12-risk-mitigation-debugging-guide.md#failure-mode-2-crash-on-menu-open)
      - [Failure Mode #3: Squashed / Corrupted Text](./12-risk-mitigation-debugging-guide.md#failure-mode-3-squashed-corrupted-text)
      - [Failure Mode #4: Wrong Texture Displayed](./12-risk-mitigation-debugging-guide.md#failure-mode-4-wrong-texture-displayed)
    - [12.2 Memory Debugging Tools](./12-risk-mitigation-debugging-guide.md#122-memory-debugging-tools)
    - [12.3 Debugging Checklist](./12-risk-mitigation-debugging-guide.md#123-debugging-checklist)
    - [12.4 Performance Profiling](./12-risk-mitigation-debugging-guide.md#124-performance-profiling)
  - [13. DEPLOYMENT CHECKLIST](./13-deployment-checklist.md)
    - [13.1 Pre-Release Validation](./13-deployment-checklist.md#131-pre-release-validation)
    - [13.2 User Installation Guide Template](./13-deployment-checklist.md#132-user-installation-guide-template)
    - [13.3 7th Heaven .iro Package Creation](./13-deployment-checklist.md#133-7th-heaven-iro-package-creation)
  - [14. REFERENCE MATERIALS & APPENDICES](./14-reference-materials-appendices.md)
    - [14.1 Complete Memory Map (US 1.02)](./14-reference-materials-appendices.md#141-complete-memory-map-us-102)
    - [14.2 Character Encoding Reference](./14-reference-materials-appendices.md#142-character-encoding-reference)
    - [14.3 FFNx Configuration Reference](./14-reference-materials-appendices.md#143-ffnx-configuration-reference)
    - [14.4 File Format Specifications](./14-reference-materials-appendices.md#144-file-format-specifications)
    - [14.5 Glossary](./14-reference-materials-appendices.md#145-glossary)
    - [14.6 External Resources](./14-reference-materials-appendices.md#146-external-resources)
    - [14.7 Version History](./14-reference-materials-appendices.md#147-version-history)
  - [FINAL IMPLEMENTATION CHECKLIST](./final-implementation-checklist.md)
    - [Phase 1: Foundation (Core C++)](./final-implementation-checklist.md#phase-1-foundation-core-c)
    - [Phase 2: Assembly & Renderer](./final-implementation-checklist.md#phase-2-assembly-renderer)
    - [Phase 3: Assets & Testing](./final-implementation-checklist.md#phase-3-assets-testing)
    - [Phase 4: Advanced Features (Optional)](./final-implementation-checklist.md#phase-4-advanced-features-optional)
    - [Phase 5: Deployment](./final-implementation-checklist.md#phase-5-deployment)
  - [CONCLUSION](./conclusion.md)
